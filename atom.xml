<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>西山夜雨</title>
  
  <subtitle>只争朝夕 不负韶华</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.iamzmj.top/"/>
  <updated>2020-01-01T16:36:12.489Z</updated>
  <id>https://www.iamzmj.top/</id>
  
  <author>
    <name>Martin Zhan</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>家常菜谱汇总</title>
    <link href="https://www.iamzmj.top/posts/cf8a8166.html"/>
    <id>https://www.iamzmj.top/posts/cf8a8166.html</id>
    <published>2020-01-01T06:00:12.000Z</published>
    <updated>2020-01-01T16:36:12.489Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><p>做饭永远是一件让人头痛的事情啊！做一道美味的家常菜犒劳自己和家人那真是一件非常的棒的事情。</p><p>在此持续搜集一些比较火的博主的家常菜的制作视频以备不时之需。</p><p>🍆🥔🥕🌽🌶️🥒🥦🍄🥜🌰   🍖🍗🥓🍦~~🥰🥰🥰🥰</p>    <div id="aplayer-ctpjcROH" class="aplayer aplayer-tag-marker meting-tag-marker" data-id="711377" data-server="netease" data-type="song" data-mode="circulation" data-autoplay="false" data-mutex="true" data-listmaxheight="340px" data-preload="auto" data-theme="#FF4081"></div><hr><h2 id="美食家王刚"><a href="#美食家王刚" class="headerlink" title="美食家王刚"></a>美食家王刚</h2><table><thead><tr><th>家常美食</th><th></th><th></th><th></th></tr></thead><tbody><tr><td><a href="https://pan.baidu.com/s/1KFSr6npF3YwU9NfchLXu2Q" rel="external nofollow noopener noreferrer" target="_blank">醋大蒜制作</a></td><td></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1SuONhqpyat2NdfVDfJLpiA" rel="external nofollow noopener noreferrer" target="_blank">盐水毛豆</a></td><td></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/15WjvLQ7kwUjDgK4k9EnaKQ" rel="external nofollow noopener noreferrer" target="_blank">小葱煎蛋</a></td><td><a href="https://pan.baidu.com/s/1-nIM8JpLHgP_eHPTbAY3yQ" rel="external nofollow noopener noreferrer" target="_blank">鸡蛋炒米粉</a></td><td><a href="https://pan.baidu.com/s/1NKhWNjRBEJiWCwDwsYi0Fw" rel="external nofollow noopener noreferrer" target="_blank">豆腐煎鸡蛋</a></td><td><a href="https://pan.baidu.com/s/1rgiLgxB6yWaafYplss3YZQ" rel="external nofollow noopener noreferrer" target="_blank">韭菜炒鸡蛋</a></td></tr><tr><td><a href="https://pan.baidu.com/s/14O27QcbvdAb6Y3ZoGqZLiA" rel="external nofollow noopener noreferrer" target="_blank">醋溜大白菜</a></td><td><a href="https://pan.baidu.com/s/1FKs_HnE8AyZqOxUkQG2EVQ" rel="external nofollow noopener noreferrer" target="_blank">酸辣大白菜</a></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1O4ITPr53lEEfHIYPKU7qog" rel="external nofollow noopener noreferrer" target="_blank">炝炒土豆丝</a></td><td></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1lnVGDZfFkoOXCQA9qrVydQ" rel="external nofollow noopener noreferrer" target="_blank">肉末烧茄子</a></td><td><a href="https://pan.baidu.com/s/1mUD-tNKu_MR3ABpuk3VIBg" rel="external nofollow noopener noreferrer" target="_blank">鱼香茄子</a></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/14obcC4VFiZo_jFkCiQyH7A" rel="external nofollow noopener noreferrer" target="_blank">麻婆豆腐</a></td><td></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1czWobDkECm0Hx2asHz2Nmw" rel="external nofollow noopener noreferrer" target="_blank">手工番茄鸡蛋面</a></td><td><a href="https://pan.baidu.com/s/1pr4dYdGsc3yqxMxwgtis6Q" rel="external nofollow noopener noreferrer" target="_blank">川味牛肉面</a></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/19DmRhdFPj1VS3XMclfsXIw" rel="external nofollow noopener noreferrer" target="_blank">脆青瓜炒肉</a></td><td><a href="https://pan.baidu.com/s/1O3yhi5zDM97gW1ZTOMNmNQ" rel="external nofollow noopener noreferrer" target="_blank">青椒牛肉丝</a></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/13an4vDGnkkG5oXdm9heG9g" rel="external nofollow noopener noreferrer" target="_blank">汆水丸子</a></td><td></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1G37ylhJUSmOx64N4MZ_-zg" rel="external nofollow noopener noreferrer" target="_blank">糖醋排骨</a></td><td></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1OQPiqMZ0RLFTyPxkT2QP6A" rel="external nofollow noopener noreferrer" target="_blank">口味猪肝</a></td><td><a href="https://pan.baidu.com/s/1428dx5W3V7nP58G1DbSRIA" rel="external nofollow noopener noreferrer" target="_blank">回锅肉</a></td><td><a href="https://pan.baidu.com/s/1dq4uQEdQsqWO8FfXBdnKkw" rel="external nofollow noopener noreferrer" target="_blank">椒香腰片</a></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/13KEHcgc2tLzn3dCfH1lXOw" rel="external nofollow noopener noreferrer" target="_blank">口水鸡</a></td><td><a href="https://pan.baidu.com/s/1JHF3o1jYQPAz37HWJtc74w" rel="external nofollow noopener noreferrer" target="_blank">可乐鸡翅</a></td><td><a href="https://pan.baidu.com/s/1ZfqVR_HRc2rDIAOUj-8CkQ" rel="external nofollow noopener noreferrer" target="_blank">辣炒鸡爪</a></td><td><a href="https://pan.baidu.com/s/1vhi_-_ZPL_U0YgpwXj0H5g" rel="external nofollow noopener noreferrer" target="_blank">青椒炒鸡丁</a></td></tr><tr><td><a href="https://pan.baidu.com/s/146LTuYeRAOZqwMXnXcQicg" rel="external nofollow noopener noreferrer" target="_blank">啤酒鸭</a></td><td><a href="https://pan.baidu.com/s/15PI-cBwNco0BSM9-Z6Mr2A" rel="external nofollow noopener noreferrer" target="_blank">干锅鸭脚</a></td><td><a href="https://pan.baidu.com/s/1_52hZ1c1_YIcHD6Z3I43tw" rel="external nofollow noopener noreferrer" target="_blank">老鸭萝卜汤</a></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1CVo2KFMIQGX2lipeODONqA" rel="external nofollow noopener noreferrer" target="_blank">碎炒羊肉</a></td><td><a href="https://pan.baidu.com/s/1v-17i0xrUwVsBkZXc2xmXg" rel="external nofollow noopener noreferrer" target="_blank">羊肉汤</a></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1Nsjtwa7g_NpgKKQwVtFM9A" rel="external nofollow noopener noreferrer" target="_blank">干煎带鱼</a></td><td><a href="https://pan.baidu.com/s/19km-_i7vJ291e5bs_tWeMw" rel="external nofollow noopener noreferrer" target="_blank">藿香鳝鱼</a></td><td><a href="https://pan.baidu.com/s/1bpypZ0rnVWQRt_bVHk-5BA" rel="external nofollow noopener noreferrer" target="_blank">番茄鲈鱼</a></td><td><a href="https://pan.baidu.com/s/1iWAiz0d-SThgOoiQURjGTQ" rel="external nofollow noopener noreferrer" target="_blank">盐烧鲈鱼</a></td></tr><tr><td><a href="https://pan.baidu.com/s/1lqQRug3T2mX7Y-6uZznhCA" rel="external nofollow noopener noreferrer" target="_blank">椒香鲤鱼</a></td><td><a href="https://pan.baidu.com/s/1jSkppg3LwJtT79MKe2Rk9A" rel="external nofollow noopener noreferrer" target="_blank">葱香鲫鱼</a></td><td><a href="https://pan.baidu.com/s/1SDHbZlL_wsJA4iL1M6rBqw" rel="external nofollow noopener noreferrer" target="_blank">生焖鱼头</a></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1qS3bSTIo_56ZI3-Sjc-Bfg" rel="external nofollow noopener noreferrer" target="_blank">甲鱼汤</a></td><td><a href="https://pan.baidu.com/s/1EDMwz9Bcm55C1rHiOIYS8w" rel="external nofollow noopener noreferrer" target="_blank">青椒爆甲鱼</a></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1Eg-Z7deLtzWt1KsNG_cdaA" rel="external nofollow noopener noreferrer" target="_blank">清蒸小龙虾</a></td><td><a href="https://pan.baidu.com/s/1qjYnf2VU-0O-KJt-pO6V6Q" rel="external nofollow noopener noreferrer" target="_blank">蒜蓉小龙虾</a></td><td><a href="https://pan.baidu.com/s/1J3hrPZbnzcQfN_5Z6CwpIg" rel="external nofollow noopener noreferrer" target="_blank">蒜蓉粉丝蒸花甲</a></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1V1JotSViXXT53nGkWrx72g" rel="external nofollow noopener noreferrer" target="_blank">鱼丸火锅</a></td><td><a href="https://pan.baidu.com/s/1cGfW-RzT5e-j2IjiFPbcHA" rel="external nofollow noopener noreferrer" target="_blank">香煎螃蟹</a></td><td><a href="https://pan.baidu.com/s/1pAyGQSTaEFpQUw-vOYWiRQ" rel="external nofollow noopener noreferrer" target="_blank">盐焗海鲜</a></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1h3E30QUxfeFUXGxvQIQN2Q" rel="external nofollow noopener noreferrer" target="_blank">鲜椒小蛙</a></td><td><a href="https://pan.baidu.com/s/1gbktlZHwQqTtG9pqIyD7Bw" rel="external nofollow noopener noreferrer" target="_blank">辣炒田螺</a></td><td></td><td></td></tr></tbody></table><table><thead><tr><th>技巧</th><th></th><th></th><th></th></tr></thead><tbody><tr><td><a href="https://pan.baidu.com/s/192SEZ2GSmKUcBltPK_dvHA" rel="external nofollow noopener noreferrer" target="_blank">切土豆丝</a></td><td><a href="https://pan.baidu.com/s/1zmKWiCJxKkbI-XdN_oQ3FQ" rel="external nofollow noopener noreferrer" target="_blank">去鱼腥味</a></td><td><a href="https://pan.baidu.com/s/1N8e1KeCRPtUnH6I_iKD8zA" rel="external nofollow noopener noreferrer" target="_blank">家猪分解</a></td><td><a href="https://pan.baidu.com/s/1Rn9viqbtp-sXcWjlLkqEiA" rel="external nofollow noopener noreferrer" target="_blank">挑选猪腿</a></td></tr><tr><td><a href="https://pan.baidu.com/s/1bE2ISXLIk4A1OnwPjdDRyA" rel="external nofollow noopener noreferrer" target="_blank">查注水肉</a></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td></tr></tbody></table><h2 id="日食记"><a href="#日食记" class="headerlink" title="日食记"></a>日食记</h2><table><thead><tr><th>家常美食</th><th></th><th></th><th></th></tr></thead><tbody><tr><td><a href="https://pan.baidu.com/s/1hCOzRNOtCGmN_DSX3uvMng" rel="external nofollow noopener noreferrer" target="_blank">自制棒冰</a></td><td></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1qNp7d0zFrGvL7dBlkKELlA" rel="external nofollow noopener noreferrer" target="_blank">无敌炒饭</a></td><td></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1ko5xHpU_PmPU-y86uSTEYQ" rel="external nofollow noopener noreferrer" target="_blank">葱油拌面</a></td><td><a href="https://pan.baidu.com/s/1lqGMFxKbV5o2HhrVYBWAbA" rel="external nofollow noopener noreferrer" target="_blank">豚骨拉面</a></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1W4kzifh_sw3byvHDGMAvzA" rel="external nofollow noopener noreferrer" target="_blank">南乳猪手</a></td><td><a href="https://pan.baidu.com/s/1QR2DCZ5Fa3w8rK1kRatfjA" rel="external nofollow noopener noreferrer" target="_blank">红烧肉</a></td><td><a href="https://pan.baidu.com/s/1Ydtek4fbM7AFeVPYu_6yRA" rel="external nofollow noopener noreferrer" target="_blank">土豆牛腩</a></td><td><a href="https://pan.baidu.com/s/1mkZpAfS_hyt9G2gwSiJ6zg" rel="external nofollow noopener noreferrer" target="_blank">家庭鸡公煲</a></td></tr><tr><td><a href="https://pan.baidu.com/s/1dDnLyzZvmxtPZQs3Xf461w" rel="external nofollow noopener noreferrer" target="_blank">清蒸大闸蟹</a></td><td></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1Aq3eEluHfmoc_nTlBLgz6w" rel="external nofollow noopener noreferrer" target="_blank">手工便当</a></td><td><a href="https://pan.baidu.com/s/1Bb4vZ8YNgjNGij2yjZDGew" rel="external nofollow noopener noreferrer" target="_blank">鹌鹑蛋虾球</a></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1owCB8KHby53e_AYrTjmvHg" rel="external nofollow noopener noreferrer" target="_blank">酸菜鱼火锅</a></td><td><a href="https://pan.baidu.com/s/12EIc9t6hWLj65vpgZD2aXg" rel="external nofollow noopener noreferrer" target="_blank">珍珠丸子</a></td><td><a href="https://pan.baidu.com/s/1xhzfZTmaLoNQSe3zf_tKLA" rel="external nofollow noopener noreferrer" target="_blank">灵魂花甲</a></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/1NhYlcWcZ4lTJ5jnxtDegMA" rel="external nofollow noopener noreferrer" target="_blank">可乐鸡翅</a></td><td></td><td></td><td></td></tr><tr><td><a href="https://pan.baidu.com/s/19lusbXphos3wzUR1ZTEBQw" rel="external nofollow noopener noreferrer" target="_blank">炸串美味</a></td><td></td><td></td><td></td></tr></tbody></table><h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><table><thead><tr><th>家常美食</th><th></th><th></th><th></th></tr></thead><tbody><tr><td><a href="https://pan.baidu.com/s/10tyJnZ3ixwX2-CsmFfjxhA" rel="external nofollow noopener noreferrer" target="_blank">番茄炸蛋面</a></td><td><a href="https://pan.baidu.com/s/1-RUIf5soppHhEBqgd-pAPw" rel="external nofollow noopener noreferrer" target="_blank">湖州羊肉面</a></td><td><a href="https://pan.baidu.com/s/1CmYH4HIEqkmnJOQNwp7qAQ" rel="external nofollow noopener noreferrer" target="_blank">牛肉蛋盖饭</a></td><td><a href="https://pan.baidu.com/s/1qvA9edS06KThNiXcz9S-4w" rel="external nofollow noopener noreferrer" target="_blank">蒜泥白肉</a></td></tr><tr><td><a href="https://pan.baidu.com/s/1k9ZSjI-3kdGy-JiloUAwcw" rel="external nofollow noopener noreferrer" target="_blank">油爆虾</a></td><td></td><td></td><td></td></tr></tbody></table>  <img src="http://111.229.17.211:3389/imgs/2020/01/ce7e4c75c9b89a53.jpg" width="800">  ]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="菜谱" scheme="https://www.iamzmj.top/categories/%E8%8F%9C%E8%B0%B1/"/>
    
    
      <category term="家常菜" scheme="https://www.iamzmj.top/tags/%E5%AE%B6%E5%B8%B8%E8%8F%9C/"/>
    
  </entry>
  
  <entry>
    <title>Nginx服务重启失败原因分析</title>
    <link href="https://www.iamzmj.top/posts/5e4c50a4.html"/>
    <id>https://www.iamzmj.top/posts/5e4c50a4.html</id>
    <published>2019-12-27T10:12:34.000Z</published>
    <updated>2019-12-30T02:44:00.130Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><h1 id="Nginx服务重启失败原因汇总"><a href="#Nginx服务重启失败原因汇总" class="headerlink" title="Nginx服务重启失败原因汇总"></a><strong>Nginx服务重启失败</strong>原因汇总</h1><p>Nginx是一个高性能的HTTP和反向代理web服务器，同时也提供了IMAP/POP3/SMTP服务。由于意外重启腾讯云服务器，造成<strong>Nginx服务无法重启</strong>，云服务器上部署的一些应用瞬间无法访问了。。。于是进行原因排查。</p><h2 id="无效的pid号"><a href="#无效的pid号" class="headerlink" title="无效的pid号"></a>无效的pid号</h2><p>远程登陆云服务器，重载Nginx</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nginx -s reload</span></span><br></pre></td></tr></table></figure><p>提示：无效的pid号。</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@jupyter</span> ~]<span class="meta"># </span></span><br><span class="line">nginx: [error] invalid PID <span class="built_in">number</span> <span class="string">""</span> <span class="keyword">in</span> <span class="string">"/www/server/nginx/logs/nginx.pid"</span></span><br><span class="line">[root<span class="symbol">@jupyter</span> ~]<span class="meta">#</span></span><br></pre></td></tr></table></figure><p><strong>解决方法</strong></p><p>查看配置文件，显示无问题。</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jupyter ~]# nginx -t</span><br><span class="line">nginx: the configuration <span class="keyword">file</span> /www/server/nginx/<span class="keyword">conf</span>/nginx.<span class="keyword">conf</span> <span class="keyword">syntax</span> <span class="keyword">is</span> ok</span><br><span class="line">nginx: configuration <span class="keyword">file</span> /www/server/nginx/<span class="keyword">conf</span>/nginx.<span class="keyword">conf</span> test <span class="keyword">is</span> successful</span><br></pre></td></tr></table></figure><p>首先找到nginx进程 pid</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@jupyter ~]# <span class="keyword">ps</span> aux | <span class="keyword">grep</span> <span class="string">"nginx: master"</span> | <span class="keyword">grep</span> -v <span class="keyword">pts</span> | awk <span class="string">'&#123;print $2;&#125;'</span></span><br><span class="line"><span class="number">21968</span></span><br></pre></td></tr></table></figure><p>将pid重新写入nginx.pid,需要注意的是 nginx.pid 的文件的路径，不同的配置，可能路径是不同的。 可以从之前的错误提示中找到路劲。</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> `<span class="keyword">ps</span> aux | <span class="keyword">grep</span> <span class="string">"nginx: master"</span> | <span class="keyword">grep</span> -v <span class="keyword">pts</span> | awk <span class="string">'&#123;print $2;&#125;'</span>` &gt; /www/server/nginx/logs/nginx.pid</span><br></pre></td></tr></table></figure><p>最后重启Nginx</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">nginx -s reload</span></span><br></pre></td></tr></table></figure><p>问题解决。</p><hr><p>其它相关问题还未有碰到！</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="Nginx" scheme="https://www.iamzmj.top/categories/Nginx/"/>
    
    
      <category term="Nginx" scheme="https://www.iamzmj.top/tags/Nginx/"/>
    
      <category term="腾讯云" scheme="https://www.iamzmj.top/tags/%E8%85%BE%E8%AE%AF%E4%BA%91/"/>
    
  </entry>
  
  <entry>
    <title>腾讯云部署JupyterLab</title>
    <link href="https://www.iamzmj.top/posts/f5651246.html"/>
    <id>https://www.iamzmj.top/posts/f5651246.html</id>
    <published>2019-12-27T02:41:09.000Z</published>
    <updated>2019-12-30T02:55:41.230Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><img src="https://i.loli.net/2019/12/29/D4m9INTSViogdJu.jpg" alt></p><p> Jupyter Notebook 的本质是一个 Web 应用程序，便于创建和共享文学化程序文档，支持实时代码，数学方程，可视化和 markdown。 用途包括：数据清理和转换，数值模拟，统计建模，机器学习等等 。用户可以通过电子邮件，Dropbox，GitHub 和 Jupyter Notebook Viewer，将 Jupyter Notebook 分享给其他人。在其中，代码可以实时的生成图像，视频，LaTeX和JavaScript。而<a href="http://jupyter.org/" rel="external nofollow noopener noreferrer" target="_blank">Jupyter Lab</a> 是 Jupyter Notebook的升级版本，</p><h1 id="安装Anaconda"><a href="#安装Anaconda" class="headerlink" title="安装Anaconda"></a>安装Anaconda</h1><p>搭建环境：Centos7 系统，宝塔面板已安装。</p><p><strong>将执行脚本获取到本地：</strong></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http<span class="variable">s:</span>//mirrors.tuna.tsinghua.edu.<span class="keyword">cn</span>/anaconda/archive/Anaconda3-<span class="number">5.3</span>.<span class="number">1</span>-Linux-x86_64.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure><p><strong>执行Anaconda安装：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">bash</span> <span class="selector-tag">Anaconda3-5</span><span class="selector-class">.3</span><span class="selector-class">.1-Linux-x86_64</span><span class="selector-class">.sh</span></span><br></pre></td></tr></table></figure><p><strong>安装过程提示1：</strong></p><p>直接回车</p><img src="http://111.229.17.211:3389/imgs/2019/12/1cc687f16cbbab80.jpg"><p><strong>安装过程提示2：</strong></p><p>输入yes+回车</p><img src="http://111.229.17.211:3389/imgs/2019/12/86d1fb4049aa3f88.jpg"><p><strong>安装提示3：</strong></p><p>Anaconda的安装位置默认会在执行用户的home目录下的anaconda3目录中，如果是要给服务器的全部用户安装的话，建议大家改成个公共的位置（如果安装时没有添加<code>-u</code>，目录如果存在会报错）。下面我是给改成安装在<code>/opt/anaconda3</code>下了。</p><img src="http://111.229.17.211:3389/imgs/2019/12/6f6271a9a4a839e4.jpg"><p>其实安装位置可以在执行安装脚本的时候直接指定，像上面要指定安装到<code>/opt/anaconda3</code>目录下，可以这样修改执行内容：<code>bash bash Anaconda3-5.3.1-Linux-x86_64.sh -p /opt/anaconda3</code>，这一步安装目录就已经指定好了，直接回车了。</p><p><strong>安装提示4：</strong></p><p>修改.bashrc脚本将Anaconda目录添加到PATH中，输入yes+回车</p><img src="http://111.229.17.211:3389/imgs/2019/12/d074c28935ec81b2.jpg"><p><strong>安装提示5：</strong></p><p>更新：安装2019版本的时候显示如下，输入yes+回车</p><img src="http://111.229.17.211:3389/imgs/2019/12/ccbe7c145394149f.jpg"><p><strong>安装提示6：</strong></p><p>是否安装Microsoft VSCode，由于是在云服务器上部署的，输入no+回车</p><img src="http://111.229.17.211:3389/imgs/2019/12/f416d6b1656076fd.jpg"><p>此时Anaconda安装完成！！</p><p>直接输入<code>conda</code>应该会提示说没找到该命令，这时候执行下：<code>source ~/.bashrc</code>，之后就可以正常使用了</p><img src="http://111.229.17.211:3389/imgs/2019/12/63f133c5cf89b26c.jpg"><h1 id="Conda管理多个python"><a href="#Conda管理多个python" class="headerlink" title="Conda管理多个python"></a>Conda管理多个python</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">conda<span class="built_in"> upgrade </span>conda</span><br><span class="line">conda update --all</span><br><span class="line">conda update anaconda</span><br></pre></td></tr></table></figure><p>查看conda环境：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">conda</span> <span class="literal">info</span> -e</span><br></pre></td></tr></table></figure><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基于 python3.7 创建一个名为py38 的环境</span></span><br><span class="line">conda <span class="built_in">create</span> <span class="comment">--name py38 python=3.8</span></span><br></pre></td></tr></table></figure><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基于 python2.7 创建一个名为py27 的环境</span></span><br><span class="line">conda <span class="built_in">create</span> <span class="comment">--name py27 python=2.7</span></span><br></pre></td></tr></table></figure><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 激活环境</span></span><br><span class="line"><span class="built_in">activate</span> py3  <span class="comment"># windows</span></span><br><span class="line">source <span class="built_in">activate</span> 环境名 <span class="comment"># linux/mac</span></span><br></pre></td></tr></table></figure><p>退出conda base环境</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">conda deactivate</span></span><br></pre></td></tr></table></figure><p>进入conda base 环境</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conda <span class="built_in">activate</span> base</span><br></pre></td></tr></table></figure><h1 id="安装Jupyter-lab"><a href="#安装Jupyter-lab" class="headerlink" title="安装Jupyter lab"></a>安装Jupyter lab</h1><p>1.在anaconda环境中安装Jupyter lab</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip <span class="keyword">install</span> jupyterlab</span><br></pre></td></tr></table></figure><p>2生成配置文件</p><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jupyter notebook --<span class="keyword">generate</span>-<span class="keyword">config</span></span><br></pre></td></tr></table></figure><img src="http://111.229.17.211:3389/imgs/2019/12/14e9c41792df2345.jpg"><p>3.生成密码,创建哈希密码</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ipython</span><br><span class="line"><span class="keyword">from</span> notebook.auth <span class="keyword">import</span> passwd</span><br><span class="line">passwd()</span><br><span class="line"># 输入你自己设置登录JupyterLab界面的密码，</span><br><span class="line"># 然后就会生产下面这样的密码，将它记下来，待会儿用</span><br><span class="line"><span class="string">'sha1:---------------------------------------------'</span></span><br></pre></td></tr></table></figure><img src="http://111.229.17.211:3389/imgs/2019/12/2944335a57c64832.jpg"><p>4.宝塔面板打开 root/.jupyter/jupter_notebook_config.py,</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">c.NotebookApp.allow_root = <span class="literal">True</span></span><br><span class="line">c.NotebookApp.ip = <span class="string">'*'</span></span><br><span class="line">c.NotebookApp.open_browser = <span class="literal">False</span></span><br><span class="line">c.NotebookApp.password = u<span class="string">'sha1:-------------------------------------------------'</span></span><br><span class="line">c.NotebookApp.port = <span class="number">8081</span></span><br><span class="line">c.NotebookApp.allow_remote_access = <span class="literal">True</span></span><br><span class="line">c.NotebookApp.notebook_dir = u<span class="string">'/home/jupyterlab'</span></span><br><span class="line"></span><br><span class="line">#################################</span><br><span class="line"></span><br><span class="line">允许以root方式运行jupyterlab</span><br><span class="line">允许任意ip段访问</span><br><span class="line">默认运行时不启动浏览器，因为服务器默认只有终端嘛</span><br><span class="line">设置之前生产的哈希密码</span><br><span class="line">设置访问端口</span><br><span class="line">允许远程访问</span><br><span class="line">jupyter运行目录</span><br></pre></td></tr></table></figure><p>到此，Jupyter lab已经安装成功了。</p><p>启动 Jupyter lab。</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup jupyter lab <span class="meta">&amp;</span></span><br></pre></td></tr></table></figure><p>然后你就可以在浏览器输入地址</p><img src="http://111.229.17.211:3389/imgs/2019/12/29ab8bbacd3cf000.jpg"><h1 id="安装Jupyter-lab插件"><a href="#安装Jupyter-lab插件" class="headerlink" title="安装Jupyter lab插件"></a>安装Jupyter lab插件</h1><p><strong>安装Node.js</strong></p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">curl</span> -sL https://rpm.nodesource.com/setup_10.x | bash -</span><br><span class="line"></span><br><span class="line">yum install -y nodejs</span><br><span class="line"></span><br><span class="line">[root<span class="variable">@localhost</span> /]<span class="comment"># node -v</span></span><br><span class="line">v10.<span class="number">9</span>.<span class="number">0</span></span><br><span class="line">[root<span class="variable">@localhost</span> /]<span class="comment"># npm -v</span></span><br><span class="line"><span class="number">6</span>.<span class="number">2</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure><p><strong>安装插件</strong></p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip <span class="keyword">install </span><span class="keyword">jupyter_contrib_nbextensions</span></span><br><span class="line"><span class="keyword">jupyter </span>contrib nbextension <span class="keyword">install </span>--user</span><br></pre></td></tr></table></figure><p> 安装完后，命令行输入jupyter lab  –watch   进入Jupyter Lab界面。点击 Settings –&gt; Advanced Settings Editor ，将Extension Manager 里的enabled 的 false 改成 true（在右边的里面改），如下图：</p><p><img src="https://i.loli.net/2019/12/29/itASfVMUYdqoj93.png" alt></p><p>现在，看向界面左侧应该就可以看到一个插件管理的图标，点击就可以看到刚才安装的插件，这个插件还有查询功能，我们可以很方便的安装卸载插件，上面是已安装的插件，下面是可以安装的插件，安装完成后可以直接更新。</p><p><img src="https://i.loli.net/2019/12/29/HsuITApo5wcxVS6.png" alt></p><p>如果你下载了字体插件，还可以更改字体大小和字体：Setting –&gt; Jupyter Lab Theme</p><p><img src="https://i.loli.net/2019/12/29/X4eJsDEd8rwIxqO.png" alt></p><p>如果你下载了字体插件，还可以更改字体大小和字体：</p><p><img src="https://i.loli.net/2019/12/29/vstIo4puGmhrWnF.png" alt></p><h1 id="后台运行Jupyter-lab"><a href="#后台运行Jupyter-lab" class="headerlink" title="后台运行Jupyter lab"></a>后台运行Jupyter lab</h1><p><strong>1.后台运行</strong></p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup jupyter lab  --ip=<span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> --no-browser --allow-root &gt; jupyter.log <span class="number">2</span>&gt;&amp;<span class="number">1</span> &amp;</span><br></pre></td></tr></table></figure><p>用&amp;让命令后台运行, 并把标准输出写入jupyter.log中</p><p>nohup表示no hang up, 就是不挂起, 于是这个命令执行后即使终端退出, 也不会停止运行.</p><p><strong>2.后台终止</strong></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ps -<span class="keyword">a</span>                <span class="comment">#查看进程pid</span></span><br><span class="line"><span class="built_in">kill</span> <span class="number">-9</span> pid          <span class="comment">#终止进程</span></span><br></pre></td></tr></table></figure><h1 id="卸载Jupyter-lab"><a href="#卸载Jupyter-lab" class="headerlink" title="卸载Jupyter lab"></a>卸载Jupyter lab</h1><p>命令行输入以下内容</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pip <span class="keyword">uninstall</span> jupyter -y</span><br><span class="line">pip <span class="keyword">uninstall</span> jupyter_core -y</span><br><span class="line">pip <span class="keyword">uninstall</span> jupyter-<span class="keyword">client</span> -y</span><br><span class="line">pip <span class="keyword">uninstall</span> jupyter-console -y</span><br><span class="line">pip <span class="keyword">uninstall</span> notebook -y</span><br><span class="line">pip <span class="keyword">uninstall</span> qtconsole -y</span><br><span class="line">pip <span class="keyword">uninstall</span> nbconvert -y</span><br><span class="line">pip <span class="keyword">uninstall</span> nbformat -y</span><br></pre></td></tr></table></figure><p>参考</p><p><a href="https://jupyterlab.readthedocs.io/en/stable/getting_started/installation.html" rel="external nofollow noopener noreferrer" target="_blank">Jupyterlab官方文档</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="Jupyter" scheme="https://www.iamzmj.top/categories/Jupyter/"/>
    
    
      <category term="腾讯云" scheme="https://www.iamzmj.top/tags/%E8%85%BE%E8%AE%AF%E4%BA%91/"/>
    
      <category term="Jupyter" scheme="https://www.iamzmj.top/tags/Jupyter/"/>
    
      <category term="Jupyterlab" scheme="https://www.iamzmj.top/tags/Jupyterlab/"/>
    
  </entry>
  
  <entry>
    <title>腾讯云部署Nextcloud</title>
    <link href="https://www.iamzmj.top/posts/f7aa0f14.html"/>
    <id>https://www.iamzmj.top/posts/f7aa0f14.html</id>
    <published>2019-12-16T02:50:05.000Z</published>
    <updated>2019-12-30T02:55:51.027Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><p>nextcloud  是基于云技术的工程教育平台，利用云技术，提高工程教育过程中教学、实验与创新的效率与效果。每一位nextcloud的使用者都可以以教师或学生身份登录， 从而使得每个人都可以传授知识也可以学习知识，真正做到any time， any where的工程教育全新愿景。</p><p>搭建环境：Centos7 系统，宝塔面板已安装。</p><img src="http://111.229.17.211:3389/imgs/2019/12/d30c4ee6621bcc31.jpg"><h1 id="宝塔面板安装"><a href="#宝塔面板安装" class="headerlink" title="宝塔面板安装"></a>宝塔面板安装</h1><p>远程登陆腾讯云服务器，Centos系统安装命令 ：</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -<span class="keyword">y</span> wget &amp;&amp; wget -O install.<span class="keyword">sh</span> http://download.bt.<span class="keyword">cn</span>/install/install_6.<span class="number">0</span>.<span class="keyword">sh</span> &amp;&amp; <span class="keyword">sh</span> install.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure><p>安装完成后根据界面提示链接和账号密码登陆宝塔面板。</p><p>安装必要的部署环境LNMP: Nginx/MySQL5.5+/PHP 7.0+</p><img src="https://i.loli.net/2019/12/17/rJZnf3p1TbDIliE.jpg" width="400"><h1 id="部署Nextcloud"><a href="#部署Nextcloud" class="headerlink" title="部署Nextcloud"></a>部署Nextcloud</h1><p>1.新建站点</p><img src="https://i.loli.net/2019/12/17/6noWLEbMS9VZhru.jpg"><p>2.点选文件，进入站点目录，然后点击远程下载</p><p>nextcloud的安装包下载地址</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="regexp">//</span>download.nextcloud.com<span class="regexp">/server/</span>releases<span class="regexp">/nextcloud-14.0.4.zip</span></span><br></pre></td></tr></table></figure><img src="https://i.loli.net/2019/12/17/VSL2gATOEMjDtWU.jpg"><p>下载完成后，点击右侧的“解压”，解压到nextcloud根目录。完成后可以看到有个nextcloud的文件夹，我们进入后将里面的文件复制到根目录。</p><img src="http://111.229.17.211:3389/imgs/2019/12/1eab10a2e1f119a5.jpg"><p>以上几步完成后，就可以打开创建站点时的域名，创建管理员账号界面，输入管理员账号密码，数据库名和密码，数据库用户名。点击“安装完成”。（数据库账号和数据库密码同创建网站时所创建的数据库账号，密码）</p><img src="http://111.229.17.211:3389/imgs/2019/12/870a80aec4315f7e.jpg"><p>点击安装完成，完成后会自动登录。</p><img src="http://111.229.17.211:3389/imgs/2019/12/f5b7f35eda1d8e17.jpg"><img src="http://111.229.17.211:3389/imgs/2019/12/d43c4a0354c05c09.jpg"><h1 id="安全及设置告警解决"><a href="#安全及设置告警解决" class="headerlink" title="安全及设置告警解决"></a>安全及设置告警解决</h1><p>点选设置—概览，系统检查跳出<font color="red">安全及设置警告</font>如下：</p><img src="http://111.229.17.211:3389/imgs/2019/12/2e71839b282515d4.jpg"><p><strong>错误1：一些问题没有通过完整性检查</strong></p><p>点击无效文件列表，根据提示删除根目录下的无效文件，即可。</p><p><strong>错误2：PHP 内存限制低于建议值 512MB</strong></p><img src="http://111.229.17.211:3389/imgs/2019/12/3519e5b1c0fcbfb5.jpg"><p>保存并重启PHP即可解决该问题。</p><p><strong>错误3：PHP 的安装似乎不正确，无法访问系统环境变量。getenv(“PATH”) 函数测试返回了一个空值。</strong></p><p>从宝塔文件管理，打开/www/server/php/73/etc/php-fpm.conf，在其尾部添加一行</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">env[PATH] = <span class="regexp">/usr/local</span><span class="regexp">/bin:/usr</span><span class="regexp">/bin:/bin</span><span class="symbol">:/usr/local/php/bin</span></span><br></pre></td></tr></table></figure><img src="http://111.229.17.211:3389/imgs/2019/12/c9abbd2d373d6a8b.jpg"><p>保存并重启PHP即可解决该问题。</p><p><strong>错误4：PHP 的组件 OPcache 没有正确配置</strong></p><p>在PHP7.3配置文件中替换如下几条语句</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">opcache.enable</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">opcache.enable_cli</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">opcache.interned_strings_buffer</span>=<span class="number">8</span></span><br><span class="line"><span class="attr">opcache.max_accelerated_files</span>=<span class="number">10000</span></span><br><span class="line"><span class="attr">opcache.memory_consumption</span>=<span class="number">128</span></span><br><span class="line"><span class="attr">opcache.save_comments</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">opcache.revalidate_freq</span>=<span class="number">1</span></span><br></pre></td></tr></table></figure><img src="http://111.229.17.211:3389/imgs/2019/12/55c06279e80a1286.jpg"><p><strong>错误5：</strong></p><ul><li>1.您的网页服务器未正确设置以解析“/.well-known/caldav”。</li><li>2.您的网页服务器未正确设置以解析“/.well-known/carddav”。</li><li>3.内存缓存未配置，为了提升使用体验，请尽量配置内存缓存。</li></ul><p>(1和2)网站配置文件  location 部分添加如下两条语句保存即可。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rewrite <span class="regexp">/.well-known/</span>carddav <span class="regexp">/remote.php/</span>dav permanent;</span><br><span class="line">rewrite <span class="regexp">/.well-known/</span>caldav <span class="regexp">/remote.php/</span>dav permanent;</span><br></pre></td></tr></table></figure><img src="http://111.229.17.211:3389/imgs/2019/12/064c3f8fd38787af.jpg"><p>(3)再在Mysql配置文件中添加两条语句</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="attr">innodb_buffer_pool_size</span>=<span class="number">1</span>G</span><br><span class="line"><span class="attr">innodb_io_capacity</span>=<span class="number">4000</span></span><br></pre></td></tr></table></figure><img src="http://111.229.17.211:3389/imgs/2019/12/139ee5ff6c737cd2.jpg"><p>将php的扩展开启Apcu和memcached，然后在Nextcloud的config.php文件添加：</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">'memcache.local' =&gt; '\OC\Memcache\APCu',</span><br><span class="line">  'memcache.distributed' =&gt; '\OC\Memcache\Memcached',</span><br><span class="line">  'memcached_servers' =&gt; </span><br><span class="line"> <span class="built_in"> array </span>(</span><br><span class="line">    0 =&gt; </span><br><span class="line">   <span class="built_in"> array </span>(</span><br><span class="line">      0 =&gt; 'localhost',</span><br><span class="line">      1 =&gt; 11211,</span><br><span class="line">    ),</span><br><span class="line"> ),</span><br></pre></td></tr></table></figure><p>问题解决。</p><p><strong>错误6：通过 HTTP 访问网站不安全。强烈建议您将服务器设置成要求使用HTTPS 协议</strong></p><p>添加域名解析，绑定SSL证书。</p><p><strong>问题7：所使用的数据库为MySQL但没有对4字节字符的支持。为正确处理文件名或评论中使用的4字节字符（比如emoji表情），建议开启MySQL的4字节字符支持</strong>。</p><p>1.修改Mysql 配置文件[mysqld],添加语句</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#低于Mysql8.0版本，</span></span><br><span class="line"><span class="attr">innodb_large_prefix</span>=<span class="literal">true</span></span><br><span class="line"><span class="attr">innodb_file_format</span>=barracuda</span><br><span class="line"><span class="attr">innodb_file_per_table</span>=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#高于Mysql8.0版本，</span></span><br><span class="line"><span class="attr">innodb_file_per_table</span>=<span class="number">1</span></span><br></pre></td></tr></table></figure><img src="http://111.229.17.211:3389/imgs/2019/12/7f96b656589c0df6.jpg"><p>2.开启Mysql 4字节支持</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">DATABASE</span> sql_118_25_73_16  <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_general_ci;</span><br></pre></td></tr></table></figure><img src="https://i.loli.net/2019/12/17/ydTwb5QmDaFtHMl.jpg"><p>重启mysql.</p><p>3.修改nextcloud配置文件config.php，将 utf8mb4值改为 true官方给出的方法是使用occ命令，当然也可以直接修改config.php，occ命令：需要在nextcloud的安装根目录下执行：</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u www php occ config:<span class="built_in">system</span>:<span class="built_in">set</span> mysql.utf8mb4 --<span class="built_in">type</span> boolean --<span class="built_in">value</span>=<span class="string">"true"</span></span><br></pre></td></tr></table></figure><p>4.修复数据库，同样是occ命令，需要在nextcloud的安装根目录下执行</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">sudo</span> <span class="selector-tag">-u</span> <span class="selector-tag">www</span> <span class="selector-tag">php</span> <span class="selector-tag">occ</span> <span class="selector-tag">maintenance</span><span class="selector-pseudo">:repair</span></span><br></pre></td></tr></table></figure><p>完成上述操作后，即可修复该告警。如出现登陆界面出现平台进入维护状态，只要修改config/config.php，将</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'maintenance'</span> =&gt; <span class="keyword">true</span>,</span><br><span class="line"> 改成</span><br><span class="line"><span class="string">'maintenance'</span> =&gt; <span class="keyword">false</span>,</span><br></pre></td></tr></table></figure><p><strong>问题8：HTTP的请求头 “Strict-Transport-Security” 未设置为至少 “15552000” 秒。</strong></p><p>解决方法还是修改nextcloud绑定的网站配置文件，添加一行header信息</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">add_header </span><span class="keyword">Strict-Transport-Security </span><span class="string">"max-age=63072000;"</span><span class="comment">;</span></span><br></pre></td></tr></table></figure><img src="http://111.229.17.211:3389/imgs/2019/12/7ac153d170a4607b.jpg"><p>最后附上完善的伪静态文件：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#nextcloud一些关键目录的权限设置</span></span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~ ^/(data|config|\.ht|db_structure\.xml|README)</span> &#123;</span><br><span class="line">        <span class="attribute">deny</span> all;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">#静态资源重定向1</span></span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~* \/core\/(?:js\/oc\.js|preview\.png).*$</span> &#123;</span><br><span class="line">        <span class="attribute">rewrite</span><span class="regexp"> ^</span> /index.php <span class="literal">last</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">#webdav重定向</span></span><br><span class="line">    <span class="attribute">location</span> / &#123;</span><br><span class="line">        <span class="attribute">rewrite</span><span class="regexp"> ^/caldav(.*)$</span> /remote.php/caldav<span class="variable">$1</span> <span class="literal">redirect</span>;</span><br><span class="line">        <span class="attribute">rewrite</span><span class="regexp"> ^/carddav(.*)$</span> /remote.php/carddav<span class="variable">$1</span> <span class="literal">redirect</span>;</span><br><span class="line">        <span class="attribute">rewrite</span><span class="regexp"> ^/webdav(.*)$</span> /remote.php/webdav<span class="variable">$1</span> <span class="literal">redirect</span>;</span><br><span class="line">        <span class="attribute">rewrite</span><span class="regexp"> ^(/core/doc/[^\/]+/)$</span> <span class="variable">$1</span>/index.html;</span><br><span class="line"><span class="comment">#静态资源重定向2,支持使用acme脚本在申请证书时对域名的验证</span></span><br><span class="line">     <span class="attribute">if</span> (<span class="variable">$uri</span> !<span class="regexp">~* (?:\.(?:css|js|svg|gif|png|html|ttf|woff)$|^\/(?:remote|public|cron|status|ocs\/v1|ocs\/v2)\.php|^\/\.well-known\/acme-challenge\/.*$))</span>&#123;</span><br><span class="line">         <span class="attribute">rewrite</span><span class="regexp"> ^</span> /index.php <span class="literal">last</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">#静态资源重定向3</span></span><br><span class="line">    <span class="attribute">location</span> <span class="regexp">~* \.(?:png|html|ttf|ico|jpg|jpeg)$</span> &#123;</span><br><span class="line">        <span class="attribute">try_files</span> <span class="variable">$uri</span> /index.php<span class="variable">$uri</span><span class="variable">$is_args</span><span class="variable">$args</span>;</span><br><span class="line">        <span class="attribute">access_log</span> <span class="literal">off</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"><span class="attribute">location</span> <span class="regexp">~ ^/(?:updater)(?:$|/)</span> &#123;</span><br><span class="line">        <span class="attribute">try_files</span> <span class="variable">$uri</span>/ =<span class="number">404</span>;</span><br><span class="line">        <span class="attribute">index</span> index.php;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">#caldav和#carddav</span></span><br><span class="line">    <span class="attribute">rewrite</span> /.well-known/carddav /remote.php/dav <span class="literal">permanent</span>;</span><br><span class="line">    <span class="attribute">rewrite</span> /.well-known/caldav /remote.php/dav <span class="literal">permanent</span>;</span><br></pre></td></tr></table></figure><h1 id="文件夹文件无法删除解决方法"><a href="#文件夹文件无法删除解决方法" class="headerlink" title="文件夹文件无法删除解决方法"></a>文件夹文件无法删除解决方法</h1><p>现象</p><p>删除目录或文件时提示：无法删除文件<strong>*或者”Error deleting file *</strong></p><p>解决方法</p><p>查看数据目录下nextcloud.log,可能有三种情况：</p><p><strong>情况A</strong>   </p><p>文件或目录被锁     关键词日志中检索  <font color="red">is locked</font></p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;"reqId":"0DijSqEkfOg2iyh9VD8J","remoteAddr":"xx.xx.xx.xx","app":"webdav","message":"Exception: &#123;<span class="symbol">\"</span>Message<span class="symbol">\"</span>:<span class="symbol">\"</span>HTTP<span class="symbol">\\</span><span class="symbol">\/</span>1.1 423 <span class="symbol">\\</span><span class="symbol">\"</span>path<span class="symbol">\\</span><span class="symbol">\/</span>file.extension<span class="symbol">\\</span><span class="symbol">\"</span> is locked<span class="symbol">\"</span>,<span class="symbol">\"</span>Exception<span class="symbol">\"</span>:<span class="symbol">\"</span>OCA<span class="symbol">\\</span><span class="symbol">\\</span>DAV<span class="symbol">\\</span><span class="symbol">\\</span>Connector<span class="symbol">\\</span><span class="symbol">\\</span>Sabre<span class="symbol">\\</span><span class="symbol">\\</span>Exception<span class="symbol">\\</span><span class="symbol">\\</span>FileLocked<span class="symbol">\"</span>,<span class="symbol">\"</span>Code<span class="symbol">\"</span>:0,<span class="symbol">\"</span>Trace<span class="symbol">\"</span>:<span class="symbol">\"</span>#0</span><br></pre></td></tr></table></figure><p>此时是因为文件或目录被锁，可按以下操作暂时解决问题：</p><p>1)宝塔面板nextcloud根目录下修改config文件夹内的config.php文件</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'maintenance'</span> =&gt; <span class="keyword">false</span>,        #<span class="string">'maintenance'</span> 赋值 <span class="keyword">true</span>    进入维护模式</span><br></pre></td></tr></table></figure><p>2)宝塔面板登陆nextcloud数据库，使用mysql命令行工具，执行语句</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> oc_file_locks <span class="keyword">WHERE</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><p>3)退出维护模式</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'maintenance'</span> =&gt; <span class="keyword">true</span>,        #<span class="string">'maintenance'</span> 赋值 <span class="keyword">false</span>     退出维护模式</span><br></pre></td></tr></table></figure><p>4)确保cron正常运行。</p><p><strong>情况B</strong>  <font color="red">Permission denied</font></p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"reqId"</span>:<span class="string">"***"</span>,<span class="string">"level"</span>:<span class="number">3</span>,<span class="string">"time"</span>:<span class="string">"2018-04-28T16:19:53+00:00"</span>,<span class="string">"remoteAddr"</span>:<span class="string">"127.0.0.1"</span>,<span class="string">"user"</span>:<span class="string">"***"</span>,<span class="string">"app"</span>:<span class="string">"PHP"</span>,<span class="string">"method"</span>:<span class="string">"<span class="keyword">DELETE</span>"</span>,<span class="string">"url"</span>:<span class="string">"\/remote.php\/webdav\***"</span>,<span class="string">"message"</span>:<span class="string">"unlink(\/mnt\/***): Permission denied at ***/lib\/private\/Files\/Storage\/Local.php#112"</span>,<span class="string">"userAgent"</span>:<span class="string">"Mozilla\/5.0 ,"</span>manuscript from cmdgy.com, version<span class="string">":"</span><span class="number">13.0.1.1</span><span class="string">"&#125;</span></span><br></pre></td></tr></table></figure><p>此时待删除的①文件、②目录、③目录中有文件 对于php进程无写入权限。</p><p>使用chown -R修复数据目录的权限解决。</p><p><strong>情况C</strong>  <font color="red">The first argument to copy() function cannot be a directory at，rename(<strong><em>files_trashbin/files/</em></strong>): Invalid cross-device link at / </font></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"reqId"</span>:<span class="string">"***"</span>,<span class="attr">"level"</span>:<span class="number">3</span>,<span class="attr">"time"</span>:<span class="string">"2018-04-28T16:26:32+00:00"</span>,<span class="attr">"remoteAddr"</span>:<span class="string">"127.0.0.1"</span>,<span class="attr">"user"</span>:<span class="string">"***"</span>,<span class="attr">"app"</span>:<span class="string">"PHP"</span>,<span class="attr">"method"</span>:<span class="string">"DELETE"</span>,<span class="attr">"url"</span>:<span class="string">"\/remote.php\/webdav\***"</span>,<span class="attr">"message"</span>:<span class="string">"rename(): The first argument to copy() function cannot be a directory at ***/lib\/private\/Files\/Storage\/Local.php#270"</span>,<span class="attr">"userAgent"</span>:<span class="string">"Mozilla\/5.0 manuscript from cmdgy.com "</span>,<span class="attr">"version"</span>:<span class="string">"13.0.1.1"</span>&#125;</span><br><span class="line"></span><br><span class="line">&#123;<span class="attr">"reqId"</span>:<span class="string">"***"</span>,<span class="attr">"level"</span>:<span class="number">3</span>,<span class="attr">"time"</span>:<span class="string">"2018-04-28T16:26:32+00:00"</span>,<span class="attr">"remoteAddr"</span>:<span class="string">"127.0.0.1"</span>,<span class="attr">"user"</span>:<span class="string">"***"</span>,<span class="attr">"app"</span>:<span class="string">"PHP"</span>,<span class="attr">"method"</span>:<span class="string">"DELETE"</span>,<span class="attr">"url"</span>:<span class="string">"\/remote.php\/webdav\***"</span>,<span class="attr">"message"</span>:<span class="string">"rename(***files_trashbin\/files\/***): Invalid cross-device link at \/***\/lib\/private\/Files\/Storage\/Local.php#270"</span>,<span class="attr">"userAgent"</span>:<span class="string">"Mozilla\/5.0 manuscript from cmdgy.com"</span>,<span class="attr">"version"</span>:<span class="string">"13.0.1.1"</span>&#125;</span><br></pre></td></tr></table></figure><p>此时需检查文件目录是否通过mount -bind方式挂载。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="腾讯云" scheme="https://www.iamzmj.top/categories/%E8%85%BE%E8%AE%AF%E4%BA%91/"/>
    
    
      <category term="腾讯云" scheme="https://www.iamzmj.top/tags/%E8%85%BE%E8%AE%AF%E4%BA%91/"/>
    
      <category term="宝塔面板" scheme="https://www.iamzmj.top/tags/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF/"/>
    
      <category term="Nextcloud" scheme="https://www.iamzmj.top/tags/Nextcloud/"/>
    
  </entry>
  
  <entry>
    <title>腾讯云弹性网卡实现多外网IP</title>
    <link href="https://www.iamzmj.top/posts/bacec032.html"/>
    <id>https://www.iamzmj.top/posts/bacec032.html</id>
    <published>2019-12-15T02:04:20.000Z</published>
    <updated>2019-12-17T23:16:17.384Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><h1 id="多IP服务器选择"><a href="#多IP服务器选择" class="headerlink" title="多IP服务器选择"></a>多IP服务器选择</h1><img src="http://111.229.17.211:3389/imgs/2019/12/91c394660ca0ab76.jpg"><p>如图上图所示， 性价比推荐以下两个配置<br> CPU：1核 内存：2GB  可以申请弹性公网IP数量为 弹性网卡数量网卡绑定IP数：2X6=12个IP<br> CPU：2核 内存：2GB  可以申请弹性公网IP数量为 弹性网卡数量网卡绑定IP数：2X10=20个IP<br> 以此类推</p><h1 id="购买腾讯云服务器"><a href="#购买腾讯云服务器" class="headerlink" title="购买腾讯云服务器"></a>购买腾讯云服务器</h1><p>已购买 CPU：1核 内存：2GB的服务器，并创建了实例。</p><img src="http://111.229.17.211:3389/imgs/2019/12/43b355f5d579080a.jpg"><h1 id="创建弹性网卡"><a href="#创建弹性网卡" class="headerlink" title="创建弹性网卡"></a>创建弹性网卡</h1><p>选择云产品—私有网络—IP与网卡—弹性网卡—点击默认网卡名字</p><p>先配置第一张主网卡</p><img src="http://111.229.17.211:3389/imgs/2019/12/d1176b1dc78b29ea.jpg"><img src="http://111.229.17.211:3389/imgs/2019/12/a3039a613deffd8e.jpg"><p>选择 IPV4管理- 先把普通公网IP转换成弹性公网IP，然后点击 修改主IP</p><img src="http://111.229.17.211:3389/imgs/2019/12/33352ab52dac3d9d.jpg"><p>将内网当前IP D段修改为2，以方便后续记忆。</p><img src="http://111.229.17.211:3389/imgs/2019/12/306f359aa3e531e3.jpg"><p>点击 分配内网IP ，手动添加5个（只能添加5个）辅助内网IP</p><p><img src="http://111.229.17.211:3389/imgs/2019/12/63bca68ef1add94a.jpg">再配置第二张辅助网卡 </p><p>主IP可以自动分配也可以手动添加，但一定要和主网卡内网IP再同一个网段内。</p><img src="http://111.229.17.211:3389/imgs/2019/12/a93a12200c32baa0.jpg"><p>选择内网主IP：172.17.15.2 点击绑定给辅助IP绑定弹性公网IP地址，选择新建EIP绑定，会自动申请弹性公网IP并绑定。弹性公网IP申请后立即绑定，<font color="red">弹性公网IP不闲置不收费</font>。(也可以选择使用现有EIP绑定，前提是你之前已经在弹性公网IP申请了空闲的IP地址)</p><img src="http://111.229.17.211:3389/imgs/2019/12/43bb93fdb2f9cac2.jpg"><img src="http://111.229.17.211:3389/imgs/2019/12/efa533412295954a.jpg"><p>返回弹性网卡，可以看到辅助网卡已新建。</p><img src="http://111.229.17.211:3389/imgs/2019/12/eacd16421d2c41e8.jpg"><p>左后绑定云服务器。 </p><img src="http://111.229.17.211:3389/imgs/2019/12/6fb6c04ce5eb446c.jpg"><p>辅助网卡绑定服务器成功。</p><h1 id="服务器绑定弹性公网IP-实现多IP"><a href="#服务器绑定弹性公网IP-实现多IP" class="headerlink" title="服务器绑定弹性公网IP 实现多IP"></a>服务器绑定弹性公网IP 实现多IP</h1><h2 id="创建辅助网卡的配置文件"><a href="#创建辅助网卡的配置文件" class="headerlink" title="创建辅助网卡的配置文件"></a>创建辅助网卡的配置文件</h2><p><strong>远程登陆云服务器</strong></p><p>执行以下命令：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd <span class="regexp">/etc/</span>sysconfig<span class="regexp">/network-scripts/</span></span><br></pre></td></tr></table></figure><p><strong>创建新网卡的配置文件 ifcfg-eth1 ：</strong></p><p> 1.输入命令：</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cp</span> ifcfg-eth0 ifcfg-eth1</span><br></pre></td></tr></table></figure><p>2.输入命令：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">vim</span> ifcfg-eth1</span><br></pre></td></tr></table></figure><p>3.按 “i” 切换至编辑模式，把配置文件内容修改为：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEVICE</span>=<span class="string">'eth1'</span></span><br><span class="line"><span class="attribute">NM_CONTROLLED</span>=<span class="string">'yes'</span></span><br><span class="line"><span class="attribute">ONBOOT</span>=<span class="string">'yes'</span></span><br><span class="line"><span class="attribute">IPADDR</span>=<span class="string">'192.168.1.62'</span>  # 根据实际填写，此处写弹性网卡上的<span class="built_in"> IP </span>地址</span><br><span class="line"><span class="attribute">NETMASK</span>=<span class="string">'255.255.255.192'</span>  #根据实际填写，此处写子网掩码</span><br><span class="line"><span class="comment">#GATEWAY='192.168.1.1'  #根据实际需要填写。因为eth0文件定义了网关，这里不再写网关，避免网关冲突</span></span><br></pre></td></tr></table></figure><p>我这边使用宝塔面环境进行配置</p><ul><li>打开宝塔文件根目录/etc/sysconfig/network-scripts  </li><li>创建一个ifcfg-eth1的网卡配置文件（不要直接在ifcfg-eth0里边修改）</li></ul><p>配置文件中放入如下代码:</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DEVICE</span>=<span class="string">'eth1'</span></span><br><span class="line"><span class="attribute">NM_CONTROLLED</span>=<span class="string">'yes'</span></span><br><span class="line"><span class="attribute">ONBOOT</span>=<span class="string">'yes'</span></span><br><span class="line"><span class="attribute">IPADDR</span>=<span class="string">'192.168.1.62'</span>  # 根据实际填写，此处写弹性网卡上的<span class="built_in"> IP </span>地址</span><br><span class="line"><span class="attribute">NETMASK</span>=<span class="string">'255.255.255.192'</span>  #根据实际填写，此处写子网掩码</span><br><span class="line"><span class="comment">#GATEWAY='192.168.1.1'  #根据实际需要填写。因为eth0文件定义了网关，这里不再写网关，避免网关冲突</span></span><br></pre></td></tr></table></figure><img src="http://111.229.17.211:3389/imgs/2019/12/69569b8dac413faf.jpg" width="600"><p>保存并推出。</p><h2 id="关闭-rp-filter-校验"><a href="#关闭-rp-filter-校验" class="headerlink" title="关闭 rp_filter 校验"></a>关闭 rp_filter 校验</h2><p>rp_filter参数用于控制系统是否开启对数据包源地址的校验,配置完成后需要需要关闭反向过滤，如果不关闭，在本机ping弹性公网IP会不成功</p><p>注意：反向过滤指系统在接收到一个 IP 包后检查该 IP 是否符合要求，不合要求则被丢弃。<br> 例如，用户在 A 网卡上收到一个 IP 包，发送 IP 为 B。而给 B 的 IP 发送时应该用的网卡不是 A，则会丢弃。由于默认路由走的是主网卡，所以开启反向过滤后，辅助网卡上的 IP 会 ping 不通。</p><p>在   /etc/sysctl.conf 里，打开找到</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net<span class="selector-class">.ipv4</span><span class="selector-class">.conf</span><span class="selector-class">.default</span><span class="selector-class">.rp_filter</span> = <span class="number">1</span></span><br></pre></td></tr></table></figure><p>删掉并替换成</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">net<span class="selector-class">.ipv4</span><span class="selector-class">.conf</span><span class="selector-class">.default</span><span class="selector-class">.rp_filter</span> = <span class="number">0</span></span><br><span class="line">net<span class="selector-class">.ipv4</span><span class="selector-class">.conf</span><span class="selector-class">.all</span><span class="selector-class">.rp_filter</span> = <span class="number">0</span></span><br><span class="line">net<span class="selector-class">.ipv4</span><span class="selector-class">.conf</span><span class="selector-class">.eth0</span><span class="selector-class">.rp_filter</span> = <span class="number">0</span></span><br><span class="line">net<span class="selector-class">.ipv4</span><span class="selector-class">.conf</span><span class="selector-class">.eth1</span><span class="selector-class">.rp_filter</span> = <span class="number">0</span></span><br></pre></td></tr></table></figure><h2 id="SSH命令重启网卡"><a href="#SSH命令重启网卡" class="headerlink" title="SSH命令重启网卡"></a>SSH命令重启网卡</h2><p>生效命令:<code># sysctl -p</code></p><img src="http://111.229.17.211:3389/imgs/2019/12/eb88d7ab739a8da8.jpg"><p>重启网卡:<code># systemctl restart network.service</code>并查看路由</p><img src="http://111.229.17.211:3389/imgs/2019/12/728103b2c986f87a.jpg"><p>查看配置后的效果:<code># ip a</code></p><img src="http://111.229.17.211:3389/imgs/2019/12/307f7ef56a99c3eb.jpg"><p>查看弹性公网已经可以ping通。</p><img src="http://111.229.17.211:3389/imgs/2019/12/9d368151a70cb6b1.jpg"><p>参考博客：</p><p>腾讯官方文档 <a href="https://cloud.tencent.com/document/product/576/18535" rel="external nofollow noopener noreferrer" target="_blank">https://cloud.tencent.com/document/product/576/18535</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="腾讯云" scheme="https://www.iamzmj.top/categories/%E8%85%BE%E8%AE%AF%E4%BA%91/"/>
    
    
      <category term="腾讯云" scheme="https://www.iamzmj.top/tags/%E8%85%BE%E8%AE%AF%E4%BA%91/"/>
    
      <category term="弹性网卡" scheme="https://www.iamzmj.top/tags/%E5%BC%B9%E6%80%A7%E7%BD%91%E5%8D%A1/"/>
    
      <category term="多公网IP" scheme="https://www.iamzmj.top/tags/%E5%A4%9A%E5%85%AC%E7%BD%91IP/"/>
    
  </entry>
  
  <entry>
    <title>腾讯云部署ImgURL个人图床</title>
    <link href="https://www.iamzmj.top/posts/a9a46c5c.html"/>
    <id>https://www.iamzmj.top/posts/a9a46c5c.html</id>
    <published>2019-12-13T09:26:05.000Z</published>
    <updated>2019-12-30T02:50:11.307Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><p>利用腾讯云的官方<a href="https://cloud.tencent.com/document/product/436/6883" rel="external nofollow noopener noreferrer" target="_blank">COSFS工具</a>，把新建的COS存储桶挂载到腾讯云服务器上（操作系统为Centos7）。</p><p>再安装ImgURL搭建个人图床。</p><p>搭建环境：Centos7 系统，宝塔面板已安装。</p><h1 id="建立存储"><a href="#建立存储" class="headerlink" title="建立存储"></a>建立存储</h1><p>登陆腾讯云控制台—选择对象存储—新建存储桶（我这边已创建完成）</p><img src="https://i.loli.net/2019/12/13/8aQSV9K7rU4LguN.jpg"><p>创建完成后整理如下信息：</p><p>存储桶名称（bucket_name）：x04680126 替换成你自己的</p><p>存储桶APPID（bucket_appid）：1300755540 替换成你自己的</p><p>存储桶访问域名（bucket_region）：<a href="https://x04680126-1300755540.cos.ap-shanghai.myqcloud.com" rel="external nofollow noopener noreferrer" target="_blank">https://x04680126-1300755540.cos.ap-shanghai.myqcloud.com</a></p><h1 id="生成密钥"><a href="#生成密钥" class="headerlink" title="生成密钥"></a>生成密钥</h1><p>接下来在<a href="https://console.cloud.tencent.com/cos5/key" rel="external nofollow noopener noreferrer" target="_blank">密钥管理</a>中切换到API密钥管理，生成密钥。如果是生产环境，建议使用子账户使用密钥。密钥分为SecretId和SecretKey。其中SecretKey需要验证手机号才能显示。</p><p>API秘钥id（SecretId）：AKIDXXXXXXXXXXXXXXXXXXXXXXBM951 替换成你自己的</p><p>API秘钥key（SecretKey）：jBMXXXXXXXXXXXXXXXXXXXXXXweB 替换成你自己的</p><h1 id="服务器上配置"><a href="#服务器上配置" class="headerlink" title="服务器上配置"></a>服务器上配置</h1><p><strong>Xshell6 远程登陆腾讯云服务器</strong></p><h2 id="1-安装环境依赖包"><a href="#1-安装环境依赖包" class="headerlink" title="1.安装环境依赖包"></a><strong>1.安装环境依赖包</strong></h2><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">sudo</span> <span class="comment">yum</span> <span class="comment">install</span> <span class="comment">automake</span> <span class="comment">gcc</span><span class="literal">-</span><span class="comment">c</span><span class="literal">+</span><span class="literal">+</span> <span class="comment">git</span> <span class="comment">libcurl</span><span class="literal">-</span><span class="comment">devel</span> <span class="comment">libxml2</span><span class="literal">-</span><span class="comment">devel</span> <span class="comment">fuse</span><span class="literal">-</span><span class="comment">devel</span> <span class="comment">make</span> <span class="comment">openssl</span><span class="literal">-</span><span class="comment">devel</span></span><br></pre></td></tr></table></figure><h2 id="2-安装工具"><a href="#2-安装工具" class="headerlink" title="2.安装工具"></a><strong>2.安装工具</strong></h2><p>使用 GitHub 将源码下载到 /usr/cosfs 为例：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https:<span class="regexp">//gi</span>thub.com<span class="regexp">/tencentyun/</span>cosfs-v4.<span class="number">2.1</span> <span class="regexp">/usr/</span>cosfs</span><br></pre></td></tr></table></figure><h2 id="3-进入到该目录，编译安装"><a href="#3-进入到该目录，编译安装" class="headerlink" title="3.进入到该目录，编译安装"></a><strong>3.进入到该目录，编译安装</strong></h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> <span class="string">/usr/cosfs</span></span><br><span class="line"><span class="string">./autogen.sh</span></span><br><span class="line"><span class="string">./configure</span></span><br><span class="line">make</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure><p>注：在这里有一个大坑，使用腾讯云VPS编译安装的时候会报错，但安装完成之后可以正常使用！！！！！！！</p><h2 id="4-配置文件"><a href="#4-配置文件" class="headerlink" title="4.配置文件"></a><strong>4.配置文件</strong></h2><p>替换自己的真实bucket_appid，secretId和secredKey</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo kenny-hexo-<span class="number">1256238228</span><span class="symbol">:AKIDXXXXXXXXXXXXXXXXXXXXXXBM951</span><span class="symbol">:jBMXXXXXXXXXXXXXXXXXXXXXXweB</span> &gt; <span class="regexp">/etc/passwd</span>-cosfs</span><br><span class="line">chmod <span class="number">640</span> /etc/passwd-cosfs</span><br></pre></td></tr></table></figure><h2 id="5-云服务器挂载存储桶"><a href="#5-云服务器挂载存储桶" class="headerlink" title="5.云服务器挂载存储桶"></a><strong>5.云服务器挂载存储桶</strong></h2><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cosfs <span class="number">1300755540</span>:x<span class="number">04680126</span> /usr/x<span class="number">04680126</span>-<span class="number">1300755540</span> -ourl=https://cos.ap-shanghai.myqcloud.com -odbglevel=info</span><br></pre></td></tr></table></figure><p>1300755540:x04680126 是自己的 bucket_appid 和 bucket_name， 需要替换为用户自己的；</p><p>/usr/x04680126-1300755540  是要挂载到服务器上（本地）的目录，需要使用宝塔提前创建；</p><p><a href="https://cos.ap-shanghai.myqcloud.com" rel="external nofollow noopener noreferrer" target="_blank">https://cos.ap-shanghai.myqcloud.com</a> 是你的 bucket_region部分</p><p>-odbglevel 参数表示信息级别，照写即可。</p><p><strong>云服务器卸载存储桶</strong></p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fusermount -u /usr/x<span class="number">04680126</span>-<span class="number">1300755540</span></span><br><span class="line">或者</span><br><span class="line">umount -l /usr/x<span class="number">04680126</span>-<span class="number">1300755540</span></span><br></pre></td></tr></table></figure><p>查看是否挂载成功</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">df -h</span></span><br></pre></td></tr></table></figure><img src="https://i.loli.net/2019/12/13/we4smb3XBHKrVaI.jpg"><p>出现红框里内容表示挂载成功。</p><h1 id="设置图片在线浏览"><a href="#设置图片在线浏览" class="headerlink" title="设置图片在线浏览"></a>设置图片在线浏览</h1><p>点击创建的存储桶—基础配置—拉到最下—开启静态网站和强制HTTPS</p><img src="https://i.loli.net/2019/12/13/BHR5MosPil9kpre.jpg"><h1 id="安装ImgURL"><a href="#安装ImgURL" class="headerlink" title="安装ImgURL"></a>安装ImgURL</h1><p>宝塔面板<strong>新建站点</strong>—<strong>新建站点根目录</strong></p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">新建站点：<span class="string">http:</span><span class="comment">//111.229.17.211:3389/</span></span><br><span class="line"></span><br><span class="line">新建站点根目录：<span class="regexp">/usr/</span>ImgURL              自己设定</span><br></pre></td></tr></table></figure><p>软件商店 php安装 <code>fileinfo</code>和<code>imagemagick</code>扩展</p><img src="https://i.loli.net/2019/12/17/ftG2ALsdEUDuN8V.jpg" style="zoom:200%;"><p>Nginx设置伪静态</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">location</span> / &#123;</span><br><span class="line"><span class="attribute">try_files</span> <span class="variable">$uri</span> <span class="variable">$uri</span>/ /index.php?<span class="variable">$query_string</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="attribute">location</span> <span class="regexp">~* \.(db3|json)$</span> &#123;</span><br><span class="line">  <span class="attribute">deny</span> all;</span><br><span class="line">&#125;</span><br><span class="line"><span class="attribute">location</span> <span class="regexp">~* ^/(temp|upload|imgs|data|application|static|system)/.*.(php|php5)$</span> &#123;</span><br><span class="line">    <span class="attribute">return</span> <span class="number">403</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>下载地址:<a href="https://github.com/helloxz/imgurl" rel="external nofollow noopener noreferrer" target="_blank">ImgURL</a>，并解压。</p><p>宝塔面板进入站点根目录/usr/ImgURL-test，全选解压后的子文件并上传。</p><img src="https://i.loli.net/2019/12/17/Bok5fWud7NcXpUJ.jpg"><p>浏览器输入 站点域名 <a href="http://111.229.17.211:3389/" rel="external nofollow noopener noreferrer" target="_blank">http://111.229.17.211:3389/</a>  并确保检测结果通过—按下一步安装完成。</p><img src="https://i.loli.net/2019/12/17/hF3t1VGmwUTJERY.jpg"><h1 id="取消广告"><a href="#取消广告" class="headerlink" title="取消广告"></a>取消广告</h1><p>新版本安装完成后默认会添加俩个条广告，取消掉都非常简单只需编辑网站根目录下的 footer.php 文件，文件路径 \ application \ views \ user \ footer.php </p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span> = <span class="string">'https://libs.xiaoz.top/assets/imgurl.js'</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">如果只是想删除广告，那就删掉以上代码就OK了</span><br><span class="line"></span><br><span class="line">如果要改为自己的广告就替换为本地调用：</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span> = <span class="string">'/static/imgurl.js'</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">然后再修改js为自己的广告</span><br><span class="line">/static/imgurl.js</span><br></pre></td></tr></table></figure><p>使用协议广告路径</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#使用协议打赏二维码路径</span></span><br><span class="line"><span class="meta-keyword">/data/</span>pages/use.md</span><br><span class="line"><span class="meta">#使用协议广告图片路径</span></span><br><span class="line"><span class="meta-keyword">/application/</span>views<span class="meta-keyword">/user/</span>page.php</span><br></pre></td></tr></table></figure><p>由于本次安装为社区版本，无法绑定腾讯COS等外部存储。</p><img src="https://i.loli.net/2019/12/17/XM3dVFaIqnH2J4P.jpg"><p>参考博客：</p><p><a href="https://www.234du.com/1167.html" rel="external nofollow noopener noreferrer" target="_blank">https://www.234du.com/1167.html</a></p><p><a href="https://blog.nicky1605.com/linux-mount-cos.html" rel="external nofollow noopener noreferrer" target="_blank">https://blog.nicky1605.com/linux-mount-cos.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="图床" scheme="https://www.iamzmj.top/categories/%E5%9B%BE%E5%BA%8A/"/>
    
    
      <category term="腾讯云" scheme="https://www.iamzmj.top/tags/%E8%85%BE%E8%AE%AF%E4%BA%91/"/>
    
      <category term="宝塔面板" scheme="https://www.iamzmj.top/tags/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF/"/>
    
      <category term="ImgURL" scheme="https://www.iamzmj.top/tags/ImgURL/"/>
    
  </entry>
  
  <entry>
    <title>读书计划2020</title>
    <link href="https://www.iamzmj.top/posts/42058630.html"/>
    <id>https://www.iamzmj.top/posts/42058630.html</id>
    <published>2019-12-04T09:47:00.000Z</published>
    <updated>2020-01-01T02:15:11.883Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><p>建立终生信仰的三观（价值观、人生观、世界观）。 </p><p>构建完整稳定的知识体系，达到对人生世事基本无惑的智慧。 </p><p>完成身体、心灵、与社会三者之间健康、和谐的平衡发展。 </p><p>形成一套完整有效的思考、推演、决策、行动的解决问题模型。 </p><p>基本跟上前沿信息与知识点，不被时代淘汰。</p><h2 id="技能类"><a href="#技能类" class="headerlink" title="技能类"></a>技能类</h2><p>❤️<a href="https://pan.baidu.com/s/12kVGtn64LkxxUrP6ZtCLJQ" rel="external nofollow noopener noreferrer" target="_blank">利用Python进行数据分析(第二版)</a></p><h2 id="思维类"><a href="#思维类" class="headerlink" title="思维类"></a>思维类</h2><p>高效能人士的七个习惯</p><p>博弈论 </p><p>批判性思维</p><p>拆掉思维的墙</p><p><a href="https://www.lanzous.com/i59rhib" rel="external nofollow noopener noreferrer" target="_blank">学会提问 - (美)尼尔.布朗</a></p><p>逻辑学导论</p><p>放弃的艺术</p><p>别做正常的傻瓜</p><p>卓有成效的管理者</p><p>第五项修炼</p><p>六顶思考帽</p><p>墨菲定律</p><h2 id="自我完善"><a href="#自我完善" class="headerlink" title="自我完善"></a>自我完善</h2><p>焦虑症的心理研究与矫治</p><p>走出抑郁</p><p>❤️🤍自卑与超越</p><p>心理咨询师笔记</p><p>爱的艺术</p><p>被讨厌的勇气</p><p>异类的天赋</p><h2 id="信息前沿"><a href="#信息前沿" class="headerlink" title="信息前沿"></a>信息前沿</h2><p>图说区块链</p><p>区块链革命</p><p>区块链社会</p><h2 id="心理学"><a href="#心理学" class="headerlink" title="心理学"></a>心理学</h2><p>瞬间读懂身体语言</p><p>变态心理学</p><p>认知心理学</p><p>发展心理学</p><p>人格心理学</p><h2 id="经济哲学"><a href="#经济哲学" class="headerlink" title="经济哲学"></a>经济哲学</h2><p>读懂中国制造2025</p><h2 id="其它类"><a href="#其它类" class="headerlink" title="其它类"></a>其它类</h2><p><a href="https://www.lanzous.com/i59rheh" rel="external nofollow noopener noreferrer" target="_blank">巨婴国 - 武志红</a></p><p>万万没想到 - 万维钢</p><p><a href="https://www.lanzous.com/i59rhfi" rel="external nofollow noopener noreferrer" target="_blank">洗澡 - 杨绛</a></p><p><a href="https://www.lanzous.com/i59rhha" rel="external nofollow noopener noreferrer" target="_blank">显微镜下的大明 - 马伯庸</a></p><p>🤍🤍逆向盈利</p><p>❤️❤️镇魂街漫画</p><img src="https://i.loli.net/2019/12/13/e2H3IVTu1wXv9bc.jpg" width="700">]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="书单" scheme="https://www.iamzmj.top/categories/booklist/"/>
    
    
      <category term="书单" scheme="https://www.iamzmj.top/tags/booklist/"/>
    
      <category term="计划" scheme="https://www.iamzmj.top/tags/plan/"/>
    
  </entry>
  
  <entry>
    <title>腾讯云部署Hexo</title>
    <link href="https://www.iamzmj.top/posts/e1764d0e.html"/>
    <id>https://www.iamzmj.top/posts/e1764d0e.html</id>
    <published>2019-12-03T02:31:30.000Z</published>
    <updated>2019-12-30T03:02:07.221Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><p>原先将Hexo部署到 <code>github</code> 和 <code>coding</code> 上的，访问速度较慢，于是购买了低配腾讯云服务器对原先博客进行重新部署。只要通过三步即可成功部署：</p><p>1.云服务器端 git 的配置<br>2.配置Nginx<br>3.本地端 hexo 的设置更改</p><h1 id="云服务器重装系统并远程登陆"><a href="#云服务器重装系统并远程登陆" class="headerlink" title="云服务器重装系统并远程登陆"></a>云服务器重装系统并远程登陆</h1><img src="https://i.loli.net/2019/12/03/jGMQNRkDl28gTsS.jpg" width="800"><p>确保是干净的操作系统，没有安装过其它环境带的Apache/Nginx/php/MySQL（已有环境不可安装）。</p><h1 id="安装宝塔Linux面板"><a href="#安装宝塔Linux面板" class="headerlink" title="安装宝塔Linux面板"></a><strong>安装宝塔Linux面板</strong></h1><p>7.0.2安装命令如下：</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -<span class="keyword">y</span> wget &amp;&amp; wget -O install.<span class="keyword">sh</span> http://download.bt.<span class="keyword">cn</span>/install/install_6.<span class="number">0</span>.<span class="keyword">sh</span> &amp;&amp; <span class="keyword">sh</span> install.<span class="keyword">sh</span></span><br></pre></td></tr></table></figure><p><strong>宝塔面板登陆：</strong></p><p>根据安装完成的提示（登陆地址，账号，密码），登陆宝塔管理面板我的如下：</p><p>Bt-Panel: <a href="http://111.229.17.211:8888/0e1fb823。" rel="external nofollow noopener noreferrer" target="_blank">http://111.229.17.211:8888/0e1fb823。</a></p><h1 id="安装配置建站环境"><a href="#安装配置建站环境" class="headerlink" title="安装配置建站环境"></a><strong>安装配置建站环境</strong></h1><h2 id="宝塔面板安装Nginx"><a href="#宝塔面板安装Nginx" class="headerlink" title="宝塔面板安装Nginx"></a>宝塔面板安装Nginx</h2><p>软件商店选择建站安装环境，本次选择推荐选项安装</p><ul><li>Nginx (主要用到这个)</li><li>Mysql</li><li>php</li><li>Pure-Ftpd </li><li>phpMyAdmin </li></ul><h2 id="云服务器端配置git"><a href="#云服务器端配置git" class="headerlink" title="云服务器端配置git"></a>云服务器端配置git</h2><p>下载 git （下载到 /usr/local/src 目录下）</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd <span class="regexp">/usr/</span>local/src </span><br><span class="line">wget <span class="string">http:</span><span class="comment">//ftp.ntu.edu.tw/software/scm/git/git-2.9.5.tar.gz</span></span><br></pre></td></tr></table></figure><p>解压到当前目录</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">tar</span> <span class="selector-tag">-zvxf</span> <span class="selector-tag">git-2</span><span class="selector-class">.9</span><span class="selector-class">.5</span><span class="selector-class">.tar</span><span class="selector-class">.gz</span></span><br></pre></td></tr></table></figure><p>编译</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cd</span> git-<span class="number">2.9</span>.<span class="number">5</span></span><br><span class="line"><span class="keyword">make</span> <span class="keyword">all</span> prefix=/usr/local/git</span><br></pre></td></tr></table></figure><p>安装 git 到 /usr/local/git 目录下</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">make</span> install prefix=/usr/<span class="keyword">local</span>/git</span><br></pre></td></tr></table></figure><p>配置 git 环境变量</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 'export <span class="built_in">PATH</span>=$<span class="built_in">PATH</span>:/usr/local/git/bin' &gt;&gt; /etc/bashrc</span><br></pre></td></tr></table></figure><p>使 git 环境变量生效</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">source</span> <span class="regexp">/etc/</span>bashrc</span><br></pre></td></tr></table></figure><p>验证安装完成</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="comment">--version</span></span><br></pre></td></tr></table></figure><p>宝塔面板文件管理查看git已安装</p><img src="https://i.loli.net/2019/12/03/S35nJO98vygsjYQ.jpg"><h2 id="云服务器创建git-仓库"><a href="#云服务器创建git-仓库" class="headerlink" title="云服务器创建git 仓库"></a>云服务器创建git 仓库</h2><p><strong>1.创建hexo的仓库</strong></p><p>git仓库用于存放博客网站资源。在 home/git的目录下，创建一个名为hexo的仓库。<br>如果没有 home/git目录，需要先创建，然后修改目录的所有权和用户权限。</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mkdir <span class="string">/home/git/</span></span><br><span class="line">chown -R $USER:$USER <span class="string">/home/git/</span></span><br><span class="line">chmod -R 755 <span class="string">/home/git/</span></span><br><span class="line"><span class="keyword">cd</span> <span class="string">/home/git/</span></span><br><span class="line">git init <span class="params">--bare</span> hexo.git</span><br></pre></td></tr></table></figure><p><strong>2.创建git hooks</strong></p><p>在 /home/git/hexo.git下，有一个自动生成的 hooks文件夹，我们创建一个新的 git钩子 post-receive，用于自动部署。</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim <span class="regexp">/home/gi</span>t<span class="regexp">/hexo.git/</span>hooks<span class="regexp">/post-receive</span></span><br></pre></td></tr></table></figure><p>将以下代码写到post-receive</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash </span></span><br><span class="line">git --work-tree=/home/hexo --git-dir=/home/git/hexo.git checkout -f</span><br></pre></td></tr></table></figure><p>宝塔面板文件夹系统内查看如下：</p><img src="https://i.loli.net/2019/12/03/3oDKVlpOJvQ7mxX.jpg"><img src="https://i.loli.net/2019/12/03/v7CcxBmTyhQRObY.jpg"><p>修改文件权限，使得其可执行</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x <span class="regexp">/home/gi</span>t<span class="regexp">/hexo.git/</span>hooks<span class="regexp">/post-receive</span></span><br></pre></td></tr></table></figure><p><strong>3.创建博客保存目录hexo</strong></p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mkdir</span> /home/hexo/ </span><br><span class="line"><span class="keyword">chown</span> -R $USER:$USER /home/hexo/</span><br><span class="line"><span class="keyword">chmod</span> -R <span class="number">755</span> /home/hexo/</span><br></pre></td></tr></table></figure><img src="https://i.loli.net/2019/12/03/qIfYruAERMw4zLj.jpg"><h2 id="宝塔面板配置-Nginx"><a href="#宝塔面板配置-Nginx" class="headerlink" title="宝塔面板配置 Nginx"></a>宝塔面板配置 Nginx</h2><p>添加网络，选择之前服务器上创建的根目录</p><img src="https://i.loli.net/2019/12/13/6ynSjxNTq5dbB7r.jpg" width="800"><p>填写1年期免费SSL 证书,可以在<a href="https://buy.cloud.tencent.com/ssl?fromSource=ssl" rel="external nofollow noopener noreferrer" target="_blank">腾讯SSL 证书-域名型免费版</a>申请并下载（Nginx的，因为我安装的是这个服务）</p><img src="https://i.loli.net/2019/12/13/Gs5A1FM2wbB7CSi.jpg"><h2 id="hexo站点配置文件修改"><a href="#hexo站点配置文件修改" class="headerlink" title="hexo站点配置文件修改"></a>hexo站点配置文件修改</h2><p>1.打开hexo站点配置文件_config.yml，修改如下：</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># Deployment</span></span><br><span class="line"><span class="meta">## Docs: https:<span class="comment">//hexo.io/docs/deployment.html</span></span></span><br><span class="line"><span class="symbol">deploy:</span></span><br><span class="line">  - type: git</span><br><span class="line"><span class="symbol">    repo:</span> </span><br><span class="line"><span class="symbol">        tencent:</span> root@<span class="number">111.229</span><span class="number">.17</span><span class="number">.211</span>:<span class="meta-keyword">/home/</span>git/hexo   </span><br><span class="line"><span class="symbol">    branch:</span> master</span><br><span class="line"><span class="symbol">    message:</span> blog update</span><br><span class="line">  - type: baidu_url_submitter</span><br></pre></td></tr></table></figure><h1 id="服务器上部署"><a href="#服务器上部署" class="headerlink" title="服务器上部署"></a>服务器上部署</h1><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo <span class="keyword">generate</span></span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure><p>hexo deploy     期间需要输入云服务器登陆密码。静态文件已部署到服务器中。</p><img src="https://i.loli.net/2019/12/13/Du98SX7TBIxCmYE.jpg"><p>若 hexo deploy  出现以下内容：</p><img src="https://i.loli.net/2019/12/17/nNJbSIGVlFCuH3g.jpg"><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -rf ~<span class="regexp">/.ssh/</span>known_hosts</span><br></pre></td></tr></table></figure><p>重新ssh连接就可以了！</p><p>参考博客：<a href="https://blog.csdn.net/jiejiemcu/article/details/102081674" rel="external nofollow noopener noreferrer" target="_blank">https://blog.csdn.net/jiejiemcu/article/details/102081674</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="腾讯云" scheme="https://www.iamzmj.top/categories/%E8%85%BE%E8%AE%AF%E4%BA%91/"/>
    
    
      <category term="Hexo部署" scheme="https://www.iamzmj.top/tags/Hexo%E9%83%A8%E7%BD%B2/"/>
    
      <category term="云服务器" scheme="https://www.iamzmj.top/tags/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    
  </entry>
  
  <entry>
    <title>腾讯云部署Docker</title>
    <link href="https://www.iamzmj.top/posts/d3aaaed9.html"/>
    <id>https://www.iamzmj.top/posts/d3aaaed9.html</id>
    <published>2019-11-23T12:55:35.000Z</published>
    <updated>2019-12-30T02:59:52.692Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>Docker是一个开源的应用容器引擎；是一个轻量级容器技术，Docker支持将软件编译成一个镜像；然后在镜像中各种软件做好配置，将镜像发布出去，其他使用者可以直接使用这个镜像，Docker运行中的这个镜像称为容器，容器启动是非常快速的。</p><p><img src="https://i.loli.net/2019/12/30/XMCy5TqdpeFWrhO.jpg" alt></p><h1 id="Docker简介"><a href="#Docker简介" class="headerlink" title="Docker简介"></a>Docker简介</h1><p><strong>简单的说：</strong></p><p>Docker是一个开源的应用容器引擎；是一个轻量级容器技术；</p><p>Docker支持将软件编译成一个镜像；然后在镜像中各种软件做好配置，将镜像发布出去，其他使用者可以直接使用这个镜像；</p><p>Docker运行中的这个镜像称为容器，容器启动是非常快速的；</p><p><a href="https://www.runoob.com/docker/docker-tutorial.html" rel="external nofollow noopener noreferrer" target="_blank">Docker 教程</a></p><p><strong>Docker的几个核心概念：</strong></p><p>docker主机(Host)：安装了Docker程序的机器（Docker直接安装在操作系统之上）；—我这边是腾讯云服务器</p><p>docker客户端(Client)：连接docker主机进行操作；—我这边是笔记本电脑</p><p>docker仓库(Registry)：用来保存各种打包好的软件镜像；</p><p>docker镜像(Images)：软件打包好的镜像；放在docker仓库中；</p><p>docker容器(Container)：镜像启动后的实例称为一个容器；容器是独立运行的一个或一组应用</p><p><strong>需要区分的两个概念：容器和虚拟机</strong></p><ul><li>容器</li></ul><p>容器技术是和我们的宿主机共享硬件资源及操作系统，可以实现资源的动态分配。容器包含应用和其所有的依赖包，但是与其他容器共享内核。容器在宿主机操作系统中，在用户空间以分离的状态进程运行。</p><ul><li>虚拟机</li></ul><p>传统虚拟机如 VMware ， VisualBox 之类的需要模拟整台机器包括硬件，每台虚拟机都需要有自己的操作系统，虚拟机一旦被开启，预分配给它的资源将全部被占用。每一台虚拟机包括应用，必要的二进制和库，以及一个完整的用户操作系统。</p><p><font color="blue">两者比较图</font>：</p><img src="https://i.loli.net/2019/11/23/cHUsT9IDkorYfXL.jpg" width="600"><p><strong>Docker 属于 Linux 容器的一种封装，提供简单易用的容器使用接口。</strong> </p><p>它不是模拟一个完整的操作系统，而是对进程进行隔离，相当于是在正常进程的外面套了一个保护层。对于容器里面的进程来说，它接触到的各种资源都是虚拟的，从而实现与底层系统的隔离。</p><p>Docker 将应用程序与该程序的依赖，打包在一个文件里面。运行这个文件，就会生成一个虚拟容器。程序在这个虚拟容器里运行，就好像在真实的物理机上运行一样。有了 Docker，就不用担心环境问题。</p><p>总体来说 Docker 的接口相当简单，用户可以方便地创建和使用容器，把自己的应用放入容器。容器还可以进行版本管理、复制、分享、修改，就像管理普通的代码一样。</p><p><font color="blue"> 容器相比于传统虚拟机的特性的优势所在</font>： </p><img src="https://i.loli.net/2019/11/23/EmxFMrkWlzfBPDp.jpg" width="600"><p><strong>Docker中包括三个基本的概念：</strong></p><p>镜像是 Docker 运行容器的前提，仓库是存放镜像的场所，可见镜像更是 Docker的核心。</p><ul><li><p><strong>Image(镜像)</strong></p><p>docker像可以看作是一个特殊的文件系统，除了提供容器运行时所需的程序、库、资源、配置等文件外，还包含了一些为运行时准备的一些配置参数（如匿名卷、环境变量、用户等）。镜像不包含任何动态数据，其内容在构建之后也不会被改变。</p><p>镜像（Image）就是一堆只读层（read-only layer）的统一视角，也许这个定义有些难以理解，下面的这张图能够帮助读者理解镜像的定义。</p><img src="https://i.loli.net/2019/11/23/6A5CEeGXSTK91kI.png" width="600"></li></ul><ul><li><strong>Container(容器)</strong></li></ul><p>​         容器 (container) 的定义和镜像 (image)几乎一模一样，也是一堆层的统一视角，唯一区别在于容器的最</p><p>​         上面那一层是可读可写的。  由于容器的定义并没有提及是否要运行容器，所以实际上，容器 = 镜像 + 读写  </p><p>​          层。 </p><p>​          <img src="   https://i.loli.net/2019/11/23/eU9KCJ6HoIDau3S.png" width="600"></p><p>​       </p><ul><li><strong>Repository(仓库)</strong></li></ul><p>​       Docker仓库是集中存放镜像文件的场所。镜像构建完成后，可以很容易的在当前宿主上运行，但是， 如果需</p><p>​       要在其它服务器上使用这个镜像，我们就需要一个集中的存储、分发镜像的服务，Docker Registry (仓库注册</p><p>​       服务器)就是这样的服务。有时候会把仓库 (Repository) 和仓库注册服务器 (Registry) 混为一谈，并不严格区</p><p>​       分。Docker仓库的概念跟 Git 类似，注册服务器可以理解为 GitHub`这样的托管服务。实际上，一个 </p><p>​       Docker Registry中可以包含多个仓库 (Repository) 每个仓库可以包含多个标签 (Tag)，每个标签对应着一个镜</p><p>​       像。所以说，镜像仓库是 Docker 用来集中存放镜像文件的地方类似于我们之前常用的代码仓库。</p><p>通常，<strong>一个仓库会包含同一个软件不同版本的镜像</strong>，而<strong>标签就常用于对应该软件的各个版本</strong> 。</p><p>我们可以通过<code>&lt;仓库名&gt;:&lt;标签&gt;</code>的格式来指定具体是这个软件哪个版本的镜像。如果不给出标签，将以 <code>latest</code> 作为默认标签.。</p><h1 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h1><p>在腾讯云服务器Centos系统上安装Docker社区版</p><p>1.卸载掉旧版本的 Docker</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sudo yum <span class="builtin-name">remove</span> docker \</span><br><span class="line">sudo yum <span class="builtin-name">remove</span> docker-client \</span><br><span class="line">sudo yum <span class="builtin-name">remove</span> docker-client-latest \</span><br><span class="line">sudo yum <span class="builtin-name">remove</span> docker-common \</span><br><span class="line">sudo yum <span class="builtin-name">remove</span> docker-latest \</span><br><span class="line">sudo yum <span class="builtin-name">remove</span> docker-latest-logrotate \</span><br><span class="line">sudo yum <span class="builtin-name">remove</span> docker-logrotate \</span><br><span class="line">sudo yum <span class="builtin-name">remove</span> docker-selinux \</span><br><span class="line">sudo yum <span class="builtin-name">remove</span> docker-engine-selinux \</span><br><span class="line">sudo yum <span class="builtin-name">remove</span> docker-engine</span><br></pre></td></tr></table></figure><p>2.安装依赖包 </p><figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">yum</span> install -y yum-utils device-mapper-persistent-<span class="class"><span class="keyword">data</span> lvm2</span></span><br></pre></td></tr></table></figure><p>3.通过阿里云下载docker-ce社区版</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager --<span class="built_in">add</span>-repo http://mirrors.aliyun.<span class="keyword">com</span>/docker-<span class="keyword">ce</span>/linux/centos/docker-<span class="keyword">ce</span>.repo</span><br></pre></td></tr></table></figure><p>4.安装Docker </p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> docker-ce</span><br></pre></td></tr></table></figure><p>5.启动Docker并测试</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br><span class="line"> </span><br><span class="line">docker <span class="keyword">run</span><span class="bash"> hello-world</span></span><br></pre></td></tr></table></figure><img src="https://i.loli.net/2019/11/23/TVQohSEA3IRJewa.jpg" width="700"><p>6.使用docker -version命令来查看docker是否安装成功 </p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker -<span class="built_in">version</span></span><br></pre></td></tr></table></figure><img src="https://i.loli.net/2019/11/23/gz5GME2qPxtOY4V.jpg" width="700"><p>7.Docker的简单运用—Hello World </p><p> 将名为 hello-world的 image文件从仓库抓取到本地。 </p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull <span class="keyword">library</span>/hello-world</span><br></pre></td></tr></table></figure><img src="https://i.loli.net/2019/11/23/WI6stEO7Nxm3Q5e.jpg" width="700"><p>8.运行 hello-world 这个 image 文件 </p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span><span class="bash"> hello-world</span></span><br></pre></td></tr></table></figure><img src="https://i.loli.net/2019/11/23/gfLrbtFsdjS1kOn.jpg" width="700"><p>输出这段提示以后，<code>hello world</code> 就会停止运行，容器自动终止。  有些容器不会自动终止，因为提供的是服务，比如Mysql镜像等。 </p><p>Docker提供了一套简单实用的命令来创建和更新镜像，我们可以通过网络直接下载一个已经创建好了的应用镜像，并通过 Docker RUN 命令就可以直接使用。当镜像通过 RUN 命令运行成功后，这个运行的镜像就是一个 Docker 容器啦，容器可以理解为一个轻量级的沙箱， Docker 利用容器来运行和隔离应用，容器是可以被启动、停止、删除的，这并不会影响 Docker 镜像。 </p><h1 id="Docker架构"><a href="#Docker架构" class="headerlink" title="Docker架构"></a>Docker架构</h1><img src="https://i.loli.net/2019/11/23/InzeOokFKB4Hsvr.png" width="700"><p>Docker采用的是C/S架构，既 Client/Server架构 。</p><p>客户端向服务器发送请求，服务器负责构建、运行和分发容器。客户端和服务器可以运行在同一个 <code>Host</code> 上，客户端也可以通过 socket 或 REST API 与远程的服务器通信。 </p><p><strong>其核心组件包括：</strong></p><ul><li><p><strong>Docker Client</strong>  Docker 提供命令行界面 (CLI) 工具</p></li><li><p><strong>Docker daemon</strong>  服务器组件，以 Linux 后台服务的方式运行，是 Docker 最核心的后台进程，我们也把它称为守护进程。它负责响应来自  Docker Client 的请求，然后将这些请求翻译成系统调用完成容器管理操作。该进程会在后台启动一个 API Server ，负责接收由 Docker Client 发送的请求，接收到的请求将通过Docker daemon 内部的一个路由分发调度，由具体的函数来执行请求。</p><img src="https://i.loli.net/2019/11/23/ZGYmJg5eWIay9qf.jpg" width="700"></li></ul><p>  ​    运行过程的作用有以下几种可能：</p><ul><li>向 Docker Registry 获取镜像</li><li>通过 graphdriver 执行容器镜像的本地化操作</li><li>通过 networkdriver 执行容器网络环境的配置</li><li>通过 execdriver执行容器内部运行的执行工作</li></ul><p>​           默认配置下， Docker daemon 只能响应来自本地 Host 的客户端请求。如果要允许远程客户端请求，需要</p><p>​           在配置文件中打开 TCP 监听。我们可以照着如下步骤进行配置：</p><p>​           1、编辑配置文件 /etc/systemd/system/multi-user.target.wants/docker.service ，在环境变量 ExecStart</p><p>​           后面添加 -H tcp://0.0.0.0，允许来自任意 IP 的客户端连接。</p><p>​            <font color="red">centos7下编辑配置文件？？？</font></p><p>​            2、重启 Docker daemon</p><p>​           <code>systemctl daemon-reload</code></p><p>​           <code>systemctl restart docker.service</code></p><p>​            3、 实现与远程服务器通信 </p><p>​           <code>docker -H 服务器IP地址 info</code></p><p>​           -H 是用来指定服务器主机， info 子命令用于查看 Docker 服务器的信息</p><ul><li><strong>Docker Image</strong> </li></ul><p>​         Docker 镜像可以看作是一个特殊的文件系统，除了提供容器运行时所需的程序、库、资源、配置等文件外，</p><p>​         还包含了一些为运行时准备的一些配置参数（如匿名卷、环境变量、用户等）。镜像不包含任何动态数据，  </p><p>​         其内容在构建之后也不会被改变。我们可将 Docker 镜像看成只读模板，通过它可以创建 Docker 容器。</p><p>​         镜像有多种生成方式：1.从无到有创建镜像；2.下载并使用别人现成的镜像；3.在镜像上创建镜像</p><p>​         我们可以将镜像的内容和创建步骤描述在一个文本文件中，这个文件被称作 Dockerfile，通过执行 </p><p>​          docker build 命令可以构建出 Docker 镜像 。</p><ul><li><strong>Docker Registry</strong> </li></ul><p>​        存储 docker image 的仓库，</p><ul><li><strong>Docker Container</strong> </li></ul><p>​        Docker 容器就是 Docker 镜像的运行实例，是真正运行项目程序、消耗系统资源、提供服务的地方。 </p><p>​        Docker   Container 提供了系统硬件环境，我们可以使用 Docker Images 这些制作好的系统盘，再加上我们</p><p>​        所编写好的项目代码， run 一下就可以提供服务。</p><h1 id="Docker组件运作"><a href="#Docker组件运作" class="headerlink" title="Docker组件运作"></a>Docker组件运作</h1><img src="https://i.loli.net/2019/11/23/vz5lLI681pdSkj3.jpg" width="700"><p>运作流程如下：</p><p>1.Docker 客户端执行 docker run 命令<br>2.Docker daemon 发现本地没有我们需要的镜像<br>3.daemon 从 Docker Hub 下载镜像<br>4.下载完成后，镜像被保存到本地<br>5.Docker daemon 启动容器</p><h1 id="Docker常用命令"><a href="#Docker常用命令" class="headerlink" title="Docker常用命令"></a>Docker常用命令</h1><img src="https://i.loli.net/2019/11/24/1LXJBOZVNC3y4Ia.png" width="700"><p>拉去一个镜像</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">docker</span> <span class="selector-tag">pull</span> <span class="selector-tag">image_name</span>                                    <span class="selector-id">#image_name</span> 为镜像的名称</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">docker</span> <span class="selector-tag">pull</span> <span class="selector-tag">centos</span><span class="selector-pseudo">:latest</span>                                 <span class="selector-id">#centos</span><span class="selector-pseudo">:lastest</span> 是镜像的名称</span><br></pre></td></tr></table></figure><p>查看主机有多少镜像</p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">image</span></span><br></pre></td></tr></table></figure><p>查看哪些容器在运行</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker ps -a</span></span><br></pre></td></tr></table></figure><p> 对一个容器进行启动，重启和停止 </p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="literal">start</span> container_name/container_id</span><br><span class="line">docker restart container_name/container_id</span><br><span class="line">docker <span class="literal">stop</span> container_name/container_id</span><br></pre></td></tr></table></figure><p> 进入到这个容器 </p><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">attach</span> container_name/container_id</span><br></pre></td></tr></table></figure><p> 运行这个容器中的镜像，并且调用镜像里面的 bash</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="keyword">run</span><span class="bash"> -t -i container_name/container_id /bin/bash</span></span><br></pre></td></tr></table></figure><p> 删除指定容器</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker ps -<span class="keyword">a</span></span><br><span class="line">docker <span class="built_in">stop</span> container_name/container_id</span><br><span class="line"></span><br><span class="line">docker rm container_name/container_id</span><br></pre></td></tr></table></figure><p>删除指定镜像</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">docker</span> rmi image_name</span><br></pre></td></tr></table></figure><p>更多命令：</p><h1 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h1><p>Dockerfile 是自动构建 docker 镜像的配置文件， 用户可以使用 Dockerfile 快速创建自定义的镜像。Dockerfile 中的命令非常类似于 linux 下的 shell 命令。</p><p>Docker 镜像、容器和 Dockerfile 三者之间的关系 ：</p><img src="https://i.loli.net/2019/11/24/zxXwbFal8RdE1Yr.jpg" width="700"><p>上图中可以看到， Dockerfile可以自定义镜像，通过 Docker 命令去运行镜像，从而达到启动容器的目的。</p><p>Dockerfile 是由一行行命令语句组成，并且支持已 <code>#</code> 开头的注释行。</p><p><strong>可以将 Dockerfile 分为四个部分：</strong></p><ul><li>基础镜像(父镜像)信息指令 <code>FROM</code></li><li>维护者信息指令 <code>MAINTAINER</code></li><li>镜像操作指令 <code>RUN</code> 、 <code>EVN</code> 、 <code>ADD</code> 和 <code>WORKDIR</code> 等</li><li>容器启动指令 <code>CMD</code> 、 <code>ENTRYPOINT</code> 和 <code>USER</code> 等</li></ul><p>例子：</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:<span class="number">2.7</span></span><br><span class="line"><span class="keyword">MAINTAINER</span> Angel_Kitty &lt;angelkitty6698@gmail.com&gt;</span><br><span class="line"><span class="comment">#copy 当前目录到容器中的 /app 目录下 复制本地主机的 &lt;src&gt; (Dockerfile所在目录的相对路径)到容器里 &lt;dest&gt;</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . /app</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> pip install -r requirements.txt</span></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">5000</span></span><br><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">"python"</span>]</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">"app.py"</span>]</span></span><br></pre></td></tr></table></figure><p>命令解析：<br><strong>FROM</strong><br>FROM 是用于指定基础的 images ，一般格式为 FROM <image> or FORM <image>:<tag> ，所有的 Dockerfile 都用该以 FROM 开头，FROM 命令指明 Dockerfile 所创建的镜像文件以什么镜像为基础，FROM 以后的所有指令都会在 FROM 的基础上进行创建镜像。</tag></image></image></p><p><strong>MAINTAINER</strong></p><p>是用于指定镜像创建者和联系方式，一般格式为 MAINTAINER <name> 。</name></p><p><strong>COPY</strong></p><p>COPY 是用于复制本地主机的 <src> (为 Dockerfile 所在目录的相对路径)到容器中的 <dest>。</dest></src></p><p>当使用本地目录为源目录时，推荐使用 COPY 。一般格式为 COPY <src><dest> 。例如我们要拷贝当前目录到容器中的 /app 目录下，我们可以这样操作：</dest></src></p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="bash"> . /app</span></span><br></pre></td></tr></table></figure><p> <strong>WORKDIR</strong></p><p>WORKDIR 用于配合 RUN，CMD，ENTRYPOINT 命令设置当前工作路径。可以设置多次，如果是相对路径，则相对前一个 WORKDIR 命令。默认路径为/。一般格式为 WORKDIR /path/to/work/dir 。例如我们设置/app 路径，我们可以进行如下操作：</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br></pre></td></tr></table></figure><p><strong>run</strong></p><p>RUN 用于容器内部执行命令。每个 RUN 命令相当于在原有的镜像基础上添加了一个改动层，原有的镜像不会有变化。一般格式为 RUN <command> 。例如我们要安装 python 依赖包，我们做法如下：</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="bash"> pip install -r requirements.txt</span></span><br></pre></td></tr></table></figure><p> <strong>EXPOSE</strong></p><p>EXPOSE 命令用来指定对外开放的端口。一般格式为 EXPOSE <port> [<port>…]</port></port></p><p>例如上面那个例子，开放5000端口：</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">EXPOSE</span> <span class="number">5000</span></span><br></pre></td></tr></table></figure><p> <strong>ENTRYPOINT</strong></p><p>ENTRYPOINT 可以让你的容器表现得像一个可执行程序一样。一个 Dockerfile 中只能有一个 ENTRYPOINT，如果有多个，则最后一个生效。</p><p>ENTRYPOINT 命令也有两种格式：</p><pre><code>ENTRYPOINT [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;] ：推荐使用的 exec形式ENTRYPOINT command param1 param2 ：shell 形式</code></pre><p> <strong>CMD</strong> </p><p>CMD 命令用于启动容器时默认执行的命令，CMD 命令可以包含可执行文件，也可以不包含可执行文件。不包含可执行文件的情况下就要用 ENTRYPOINT 指定一个，然后 CMD 命令的参数就会作为ENTRYPOINT的参数。</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">"executable"</span>,<span class="string">"param1"</span>,<span class="string">"param2"</span>]：推荐使用的 <span class="built_in">exec</span> 形式。</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">"param1"</span>,<span class="string">"param2"</span>]：无可执行程序形式</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> <span class="built_in">command</span> param1 param2：shell 形式。</span></span><br></pre></td></tr></table></figure><p>一个 Dockerfile 中只能有一个CMD，如果有多个，则最后一个生效。而 CMD 的 shell 形式默认调用 /bin/sh -c 执行命令。CMD 命令会被 Docker 命令行传入的参数覆盖：docker run busybox /bin/echo Hello Docker 会把 CMD 里的命令覆盖。</p><p>例如我们要启动 /app ，我们可以用如下命令实现：</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">"app.py"</span>]</span></span><br></pre></td></tr></table></figure><img src="https://i.loli.net/2019/12/30/WUK6T2BSguXdewM.jpg" style="zoom:100%;"><p>参考博客：</p><p><a href="https://blog.csdn.net/deng624796905/article/details/86493330" rel="external nofollow noopener noreferrer" target="_blank">https://blog.csdn.net/deng624796905/article/details/86493330</a></p><p><a href="https://blog.csdn.net/u011781521/article/details/80469804" rel="external nofollow noopener noreferrer" target="_blank">https://blog.csdn.net/u011781521/article/details/80469804</a></p><p>​     </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="Docker" scheme="https://www.iamzmj.top/categories/Docker/"/>
    
    
      <category term="Docker" scheme="https://www.iamzmj.top/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>Win10下IE浏览器图标无法删除的解决办法</title>
    <link href="https://www.iamzmj.top/posts/ed3f23a1.html"/>
    <id>https://www.iamzmj.top/posts/ed3f23a1.html</id>
    <published>2019-11-08T15:00:58.000Z</published>
    <updated>2019-12-29T09:43:06.767Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><p>为自学MySQL,在Win10电脑上安装SQLyog软件，安装完毕时突然发现电脑桌面自动添加了IE浏览器的图标，而且该图标无法直接右键删除。 我去【控制面板】-【程序卸载】里面也没有找到安装IE浏览器（之前一直没有遇到过这种情况） ，那该如何是好呢？通过百度后，我将相关的解决办法记录与此，以便日后出现同类问题可以及时的解决。 </p><img src="https://i.loli.net/2019/11/08/hHfRi4lUWrJc7Lx.jpg" width="400"><p>Win+R,输入“regedit”,进入注册表编辑器,</p><p>进入如下目录</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">\H</span>KEY_LOCAL_MACHINE<span class="symbol">\S</span>OFTWARE<span class="symbol">\M</span>icrosoft<span class="symbol">\W</span>indows<span class="symbol">\C</span>urrentVersion<span class="symbol">\E</span>xplorer<span class="symbol">\D</span>esktop<span class="symbol">\N</span>ameSpace</span><br></pre></td></tr></table></figure><p>找到{00010203-0001-0305-102938475600}字典目录  </p><p>删除{00010203-0001-0305-102938475600}字典目录  </p><p> 这时再返回电脑桌面，发现原先的IE图标已经被删除，问题成功解决！ </p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="Windows" scheme="https://www.iamzmj.top/categories/Windows/"/>
    
    
      <category term="IE浏览器" scheme="https://www.iamzmj.top/tags/IE%E6%B5%8F%E8%A7%88%E5%99%A8/"/>
    
      <category term="系统优化" scheme="https://www.iamzmj.top/tags/%E7%B3%BB%E7%BB%9F%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>MySQL学习笔记二：DQL查询语言</title>
    <link href="https://www.iamzmj.top/posts/2a4d6fbc.html"/>
    <id>https://www.iamzmj.top/posts/2a4d6fbc.html</id>
    <published>2019-11-08T06:40:21.000Z</published>
    <updated>2019-12-03T00:23:40.563Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><img src="https://i.loli.net/2019/11/17/P23yRM6DmGA54tT.png" width="800"><img src="https://i.loli.net/2019/11/17/8NbygLtE35pADJU.png" width="800"><img src="https://i.loli.net/2019/12/03/5fPzqSBduaAFNbM.png" width="800"><img src="https://i.loli.net/2019/12/03/mPaepydEOiSs7WI.png" width="800"><img src="https://i.loli.net/2019/12/03/blKQZI8kfjSROLy.png" width="800"><img src="https://i.loli.net/2019/12/03/gZrRLMEThfyYClq.png" width="800"><img src="https://i.loli.net/2019/12/03/6qVkX8UQDdFZrAw.png" width="800"><h1 id="MySQL-DQL查询语言"><a href="#MySQL-DQL查询语言" class="headerlink" title="MySQL-DQL查询语言"></a>MySQL-DQL查询语言</h1><script type="text/javascript" src="/js/src/bai.js"></script><p>将参考用数据库 <a href="https://www.lanzous.com/i78v5yf" rel="external nofollow noopener noreferrer" target="_blank">myemployees.sql</a>添加至图形化用户界面客户端</p><h2 id="MySQL常见命令"><a href="#MySQL常见命令" class="headerlink" title="MySQL常见命令"></a>MySQL常见命令</h2><p>1、查看当前所有数据库</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br></pre></td></tr></table></figure><p>2、打开指定数据库</p><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> 库名</span><br></pre></td></tr></table></figure><p>3、查看当前库的所有表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br></pre></td></tr></table></figure><p>4、查看其它库的所有表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span> <span class="keyword">from</span> 库名;`</span><br></pre></td></tr></table></figure><p>5、创建一个表</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table 表名(</span><br><span class="line"></span><br><span class="line">   列名     列类型,</span><br><span class="line">   列名     列类型,</span><br><span class="line">    <span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span>.</span><br><span class="line">)</span><br></pre></td></tr></table></figure><p>6、查看表结构</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">desc</span> 表名</span><br></pre></td></tr></table></figure><p>5、查看服务器的版本</p><p>方式一：登录到mysqI服务端，</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">version</span>();</span><br></pre></td></tr></table></figure><p>方式二：未连接到mysql服务端</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">mysql</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">version</span> <span class="comment">或</span>  <span class="comment">mysql</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">V</span></span><br></pre></td></tr></table></figure><h2 id="MySQL语句规范"><a href="#MySQL语句规范" class="headerlink" title="MySQL语句规范"></a>MySQL语句规范</h2><ul><li>不区分大小写，但建议关键字大写，表名、列名小写</li><li>每条命令最好用分号结尾</li><li>每条命令根据需要，可以进行缩进或者换行</li><li>注释  <ul><li>单行注释：#注释文字</li><li>单行注释：–[空格]注释文字</li><li>多行注释</li></ul></li></ul><h3 id="基础查询语句（进阶一）"><a href="#基础查询语句（进阶一）" class="headerlink" title="基础查询语句（进阶一）"></a>基础查询语句（进阶一）</h3><p>语法：select 查询的列表 from 表名</p><ul><li><p>查询列表可以是：表中的字段、常量值、表达式、函数</p></li><li><p>查询的结果是一个虚拟的表格</p></li></ul><blockquote><p><strong>1、查询字段</strong></p></blockquote><p>查询表中的单个字段</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> last_name <span class="keyword">from</span> employees</span><br></pre></td></tr></table></figure><p>查询表中多个字段</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> last_name, salary, email <span class="keyword">from</span> employees</span><br></pre></td></tr></table></figure><p>查询表中所有字段</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> employees</span><br></pre></td></tr></table></figure><blockquote><p><strong>2、查询常量值</strong></p></blockquote><p>注意:字符型和日期型的常量值必须用单引号引起来，数值型不需要</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">100</span></span><br><span class="line"><span class="keyword">select</span> <span class="symbol">'john</span>'</span><br></pre></td></tr></table></figure><blockquote><p><strong>3、查询表达式</strong></p></blockquote><p>注意：不支持++、–等运算方式</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select <span class="number">100</span>*<span class="number">98</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>4、查询函数</strong></p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">version</span>();</span><br></pre></td></tr></table></figure><blockquote><p><strong>5、为字段起别名</strong></p></blockquote><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>、<span class="keyword">as</span></span><br><span class="line"><span class="keyword">select</span> <span class="number">100</span>*<span class="number">98</span> <span class="keyword">as</span> 结果</span><br><span class="line"><span class="keyword">select</span> last_name <span class="keyword">as</span> 姓,first_name <span class="keyword">as</span> 名 <span class="keyword">from</span> employees</span><br><span class="line"><span class="number">2</span>、空格</span><br><span class="line"><span class="keyword">select</span> last_name 姓,first_name 名 <span class="keyword">from</span> employees</span><br></pre></td></tr></table></figure><ul><li>便于理解</li><li>如果要查询字段有重名，使用别名可以区分开来</li><li>如果别名中有特殊符号，建议别名上加双引号。</li></ul><blockquote><p><strong>6、为字段去重</strong></p></blockquote><p>select distinct 字段名 from 表名；</p><p>案列：查询员工表中涉及到的所有部门编号</p><p>语句中需添加 <code>DISTINCT</code></p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">DISTINCT</span> department_id <span class="keyword">from</span> employees</span><br></pre></td></tr></table></figure><blockquote><p><strong>7、+号的作用</strong></p></blockquote><p>+仅仅只有加法运算功能</p><ul><li>select 90+199；两个操作数均为数值型，则做加法运算</li><li>如果有其中一方为字符型，，试图将字符型数值转换成数值型<ul><li>select ‘123’+100; 如果转换成功，则继续做加法运算</li><li>select ‘john’+90 ; 如果转换失败，则将字符型数值转换成0</li><li>select ‘null’+100; 只要其中一方为null，则结果肯定是null</li><li></li></ul></li></ul><blockquote><p><strong>8、contact 函数</strong></p></blockquote><p>起到拼接字符的功能</p><p>案列：查询员工名和姓连接成一个字段，并显示为 姓名</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">concat</span>(last_name,first_name) <span class="keyword">as</span> 姓名 <span class="keyword">from</span> employees</span><br></pre></td></tr></table></figure><blockquote><p>9、【补充】ifunll函数</p></blockquote><p>判断某字段或表达式是否为unll,如果是返回指定值，否则返回原本值。</p><blockquote><p>10、【补充】isunll函数</p></blockquote><p>判断某字段或表达式是否为unll,如果是返回1，否则返回0。</p><h3 id="条件查询语句（进阶二）"><a href="#条件查询语句（进阶二）" class="headerlink" title="条件查询语句（进阶二）"></a>条件查询语句（进阶二）</h3><p>语法：</p><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">          查询列表</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">          表名</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">          删选条件</span><br></pre></td></tr></table></figure><p>分类：</p><ul><li><p>按条件表达式删选：&gt;  &lt;  !=  &lt;&gt;  &gt;=  &lt;=</p></li><li><p>按逻辑表达式删选：and or not</p><ul><li>&amp;&amp; 和 and  两个条件都为true，结果为true，反之为flase</li><li>|| 和 or      两个条件有一个为true，结果为true，反之为flase</li><li>! 和not        如果链接的条件本身为flase，结果为true，反之为flase</li></ul></li><li><p>模糊查询：like、between、 in、 is null</p></li></ul><blockquote><p><strong>按条件表达式删选</strong></p></blockquote><p>案例1：查询工资&gt;12000的员工的信息</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> salary &gt;<span class="number">12000</span></span><br></pre></td></tr></table></figure><p>案例2：查询部门编号不等于90号的员工名和部门编号</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">       last_name,</span><br><span class="line">       department_id</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">       employees</span><br><span class="line">       </span><br><span class="line"><span class="keyword">WHERE</span>  </span><br><span class="line">       department_id&lt;&gt;<span class="number">90</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>按逻辑表达式删选</strong></p></blockquote><p>案例1：工资在1万到2万之间的员工名、工资、奖金信息</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">last_name,</span><br><span class="line">salary,</span><br><span class="line">commission_pct</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">salary&gt;=<span class="number">10000</span> <span class="keyword">AND</span> salary&lt;=<span class="number">20000</span></span><br></pre></td></tr></table></figure><p>案例2：查询部门编号不在90到110之间，或者薪水高于15000的员工信息</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">*</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line"><span class="keyword">NOT</span>(department_id&gt;=<span class="number">90</span> <span class="keyword">AND</span> department_id&lt;=<span class="number">110</span>) <span class="keyword">OR</span> salary&gt;<span class="number">15000</span>;</span><br></pre></td></tr></table></figure><blockquote><p><strong>模糊查询删选</strong></p></blockquote><p>1</p><p>2</p><p>3</p><p>4</p><p><strong>is null</strong>  </p><ul><li>=或者,&gt;不能用于判断null值</li><li>is null或is not null可以</li></ul><p>案例1：查询没有奖金的员工名和奖金率</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">last_name,</span><br><span class="line">commission_pct</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">commission_pct <span class="keyword">IS</span> <span class="literal">NULL</span></span><br></pre></td></tr></table></figure><p>案例2：查询工资为12000的员工信息    使用 <code>&lt;=&gt;</code>  安全等于</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">last_name,</span><br><span class="line">salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">salary &lt;=&gt; <span class="number">12000</span></span><br></pre></td></tr></table></figure><p>注意：</p><ul><li><p>is null 仅仅可以判断 null值，可读性较高，建议使用。</p></li><li><p>&lt;=&gt;      既可以判断null值，又可以判断普通数量，可读性较低。</p></li></ul><p>综合案列1:查询没有奖金，且工资小于18000的salary/last_name</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">last_name,</span><br><span class="line">salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">commission_pct <span class="keyword">IS</span> <span class="literal">NULL</span> </span><br><span class="line"><span class="keyword">AND</span> salary &lt; <span class="number">18000</span>;</span><br></pre></td></tr></table></figure><p>综合案例2：查询employees表中，job_id不为 ‘IT’ 或者 工资为12000的员工信息。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">*</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">job_id &lt;&gt; <span class="string">'IT'</span></span><br><span class="line"><span class="keyword">OR</span> salary = <span class="number">12000</span>;</span><br></pre></td></tr></table></figure><p>综合案例3：查看departments表的结构</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">DESC departments</span></span><br></pre></td></tr></table></figure><p>综合案例4： 查看部门中涉及到那些位置编号   （关键是去重）</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> location_id <span class="keyword">FROM</span> departments;</span><br></pre></td></tr></table></figure><h3 id="排序查询语句（进阶三）"><a href="#排序查询语句（进阶三）" class="headerlink" title="排序查询语句（进阶三）"></a>排序查询语句（进阶三）</h3><p>语法：select 查询列表 </p><p>​           from 表名 </p><p>​           where 【筛选条件】</p><p>​           oder by 排序列表【asc | desc】</p><p>  特点：</p><ul><li><p>desc 降序，asc升序   不写的话默认升序</p></li><li><p>order by 子句可以支持单个字段，多个字段、表达式、函数、别名</p></li><li><p>order by 子句一般放在查询语句的最后面，limit子句除外。</p></li></ul><p>案例1：查询员工工资，从高到底排序</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">*</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>案例2：查询部门编号大于等于90的员工信息。按入职时间先后进行排序</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">*</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">department_id&gt;=<span class="number">90</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> hiredate <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure><p>案例3：【按表达式排序】按年薪的高低显示员工的信息和年薪</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">*,</span><br><span class="line">salary*<span class="number">12</span>*(<span class="number">1</span>+<span class="built_in">IFNULL</span>(commission_pct,<span class="number">0</span>)) <span class="keyword">AS</span> 年薪</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 年薪 <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>案例4：按姓名的长度显示员工的姓名和工资【按函数排序】</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="built_in">LENGTH</span>(last_name) 字节长度,</span><br><span class="line">last_name,</span><br><span class="line">salary</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 字节长度 <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>案例5：查询员工信息，先按工资排序升序，再按员工编号排序降序【按多个字段排序】</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">*</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">ASC</span>,department_id <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><h3 id="常见函数学习（进阶四）"><a href="#常见函数学习（进阶四）" class="headerlink" title="常见函数学习（进阶四）"></a>常见函数学习（进阶四）</h3><p>将一组逻辑语句封装在方法体中，对外暴露方法名</p><p>好处1：隐藏实现细节 2、提高代码重用性</p><p>调用：select 函数名(实参列表) 【from 表】</p><p>特点：</p><ul><li>叫什么（函数名）</li><li>干什么的（函数功能）</li></ul><p>分类</p><ul><li>单行函数<ul><li>字符函数、数学函数、日期函数、其他函数、流程控制函数，</li></ul></li><li>分组函数<ul><li>统计函数、聚合函数等</li></ul></li></ul><p>单行函数</p><blockquote><h5 id="字符函数"><a href="#字符函数" class="headerlink" title="字符函数"></a><strong>字符函数</strong></h5></blockquote><p>1、length</p><p>获取参数值的字节数</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">LENGTH</span>(<span class="string">'jhon'</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">LENGTH</span>(<span class="string">'张三丰hahaha'</span>);</span><br></pre></td></tr></table></figure><p>2、concat 拼接/连接 字符串</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(last_name,<span class="string">'_'</span>,first_name) 姓名 <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure><p>3、upper、lower    大写/小写</p><p>案例：将姓变大写，名变小写,然后拼接</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(<span class="keyword">UPPER</span>(last_name),<span class="keyword">LOWER</span>(first_name)) 姓名 <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure><p>4、substr/substring 截取字符长度</p><p>注意：截取从1开始</p><ul><li>截取从指定索引处后面的所有字符</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUBSTR</span>(<span class="string">'占敏捷爱上谢菲'</span>,<span class="number">6</span>) 输出结果;</span><br></pre></td></tr></table></figure><ul><li>截取从指定索引处指定字符长度的字符</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUBSTR</span>(<span class="string">'占敏捷爱上谢菲hahhahah'</span>,<span class="number">4</span>,<span class="number">2</span>) 输出结果;</span><br></pre></td></tr></table></figure><p>案例1：姓名中首字母大写，其它字母小写，然后用_拼接</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT CONCAT(<span class="name">UPPER</span>(<span class="name">SUBSTR</span>(<span class="name">last_name</span>,<span class="number">1</span>,<span class="number">1</span>)),'_',LOWER(<span class="name">SUBSTR</span>(<span class="name">last_name</span>,<span class="number">2</span>)))FROM employees<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>5、instr</p><p>返回子串第<font color="red">一次</font>出现的索引,如果找不到返回0。</p><p>6、trim</p><p>去前后空格</p><p>7、lpad  左填充</p><p>用指定的字符实现左填充指定长度</p><p>8、rpad 右填充</p><p>用指定的字符实现右填充指定长度</p><p>9、replace 全部替换</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">REPLACE</span>(<span class="string">'张无忌爱上了周芷若'</span>,<span class="string">'周芷若'</span>,<span class="string">'赵敏'</span>) 输出;</span><br></pre></td></tr></table></figure><blockquote><h5 id="数学函数"><a href="#数学函数" class="headerlink" title="数学函数"></a><strong>数学函数</strong></h5></blockquote><p>1、ronud    四舍五入</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">ROUND</span>(<span class="number">-1.55</span>);          -2</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">ROUND</span>(<span class="number">-1.45</span>);          -1</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">ROUND</span>(<span class="number">-1.45678</span>,<span class="number">2</span>);     -1.46    四舍五入，并保留小数点后2位</span><br></pre></td></tr></table></figure><p>2.ceil  向上取整</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CEIL</span>(<span class="number">1.02</span>);             2       返回》=该参数的最小整数</span><br></pre></td></tr></table></figure><p>3.floor 向下取整</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">FLOOR</span>(<span class="number">9.99</span>);            9</span><br></pre></td></tr></table></figure><p>4、truncate   截断</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT TRUNCATE(<span class="number">1.2345678</span>,<span class="number">2</span>);  <span class="number">1.23</span></span><br></pre></td></tr></table></figure><p>5、mod 取余</p><p>mod(a,b)：a-a/b*b</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT MOD(<span class="number">10</span>,<span class="number">3</span>);               <span class="number">1</span></span><br><span class="line">SELECT <span class="number">10</span>%<span class="number">3</span>                     <span class="number">1</span></span><br></pre></td></tr></table></figure><p>6、rand 获取随机数，返回0-1之间的小数</p><blockquote><h5 id="日期函数"><a href="#日期函数" class="headerlink" title="日期函数"></a><strong>日期函数</strong></h5></blockquote><p>1、now/year/date/month/hour</p><p>返回当前系统日期+时间</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">NOW</span>();</span><br></pre></td></tr></table></figure><p>2、curdate</p><p>返回当前系统日期，不返回时间</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CURDATE</span>();</span><br></pre></td></tr></table></figure><p>3、curtime</p><p>返回当前系统时间，不返回日期</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CURTIME</span>();</span><br></pre></td></tr></table></figure><p>可以获取指定部分。年、月、日、小时、分钟、秒</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">YEAR</span>(<span class="keyword">NOW</span>()) 年;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MONTH</span>(<span class="keyword">NOW</span>()) 月;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> MONTHNAME(<span class="keyword">NOW</span>()) 月;           November</span><br></pre></td></tr></table></figure><p>4、str_to_data** 将字符通过指定的格式转换成日期</p><p>案例：</p><p>5、date_format 将日期转换成字符</p><p>案例：查询有奖金的员工名和入职日期（格式：xx年/xx月 xx年）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">last_name,</span><br><span class="line"><span class="keyword">DATE_FORMAT</span>(hiredate,<span class="string">'%m月/%d日 %y年'</span>) 入职日期</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> NUL</span><br></pre></td></tr></table></figure><ul><li>相关格式符：</li></ul><img src="https://i.loli.net/2019/11/10/cIP3kDleQzswfan.jpg" width="500"><p>6、datediff、返回两个日期间的天数</p><p>7、monthname、以英文形式返回</p><blockquote><h5 id="其它函数"><a href="#其它函数" class="headerlink" title="其它函数"></a><strong>其它函数</strong></h5></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">VERSION</span>();</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATABASES</span>();</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>();</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">PASSWORD</span>();</span><br></pre></td></tr></table></figure><blockquote><h5 id="流程控制函数"><a href="#流程控制函数" class="headerlink" title="流程控制函数"></a>流程控制函数</h5></blockquote><p>用于实现一些流程控制的</p><p>1、if函数 ：if else 的效果</p><p>if（条件表达式，表达式1，表达式2）:如果条件表达式成立，返回表达式1，否则返回表达式2；</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">last_name,</span><br><span class="line">commission_pct,<span class="keyword">IF</span>(commission_pct <span class="keyword">IS</span> <span class="literal">NULL</span>,<span class="string">'没奖金，呵呵'</span>,<span class="string">'有奖金，嘻嘻'</span>) 备注；</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br></pre></td></tr></table></figure><p>2、case函数</p><p><strong>case 使用语法一：</strong></p><p>语法如下：</p><p>case 变量或表达式或字段</p><p>when 常量1 then 值1</p><p>when 常量2 then 值2</p><p>……</p><p>else  值n</p><p>end</p><p>案例1：  查询员工工资，部门号=30.显示工资为1.1倍；部门号为40，显示工资为1.2倍；部门号=50，显示工资为1.3倍；其它的部门显示的工资为原来工资。</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">salary 原始工资,</span><br><span class="line">department_id,</span><br><span class="line"><span class="keyword">CASE</span> department_id</span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">30</span> <span class="keyword">THEN</span> salary*<span class="number">1.1</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">40</span> <span class="keyword">THEN</span> salary*<span class="number">1.2</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">50</span> <span class="keyword">THEN</span> salary*<span class="number">1.3</span></span><br><span class="line"><span class="keyword">ELSE</span> salary</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">AS</span> 新工资</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure><p><strong>case 使用方法二：</strong></p><p>语法如下：</p><p>case</p><p>when 条件1 then 值1</p><p>when 条件2 then 值2</p><p>……</p><p>else 值n</p><p>end</p><p>案例：查询员工的工资情况，如果大于20000，显示A级别；如果工资大于15000，显示A级别，如果工资大于10000，显示C级别，否则显示D级别</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> salary,</span><br><span class="line"><span class="keyword">CASE</span></span><br><span class="line"><span class="keyword">WHEN</span> salary&gt;<span class="number">20000</span> <span class="keyword">THEN</span> <span class="string">'A'</span></span><br><span class="line"><span class="keyword">WHEN</span> salary&gt;<span class="number">15000</span> <span class="keyword">THEN</span> <span class="string">'B'</span></span><br><span class="line"><span class="keyword">WHEN</span> salary&gt;<span class="number">10000</span> <span class="keyword">THEN</span> <span class="string">'c'</span></span><br><span class="line"><span class="keyword">ELSE</span> <span class="string">'D'</span></span><br><span class="line"><span class="keyword">END</span> <span class="keyword">AS</span> 工资级别</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees;</span><br></pre></td></tr></table></figure><p>综合案例 1：显示系统时间（注意：日期+时间）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">NOW</span>();</span><br></pre></td></tr></table></figure><p>综合案例 2：查询员工号，姓名，工资，以及工资提高20%后的结果（new salary）</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">employee_id,last_name,salary,salary*<span class="number">1.2</span> <span class="keyword">AS</span> <span class="string">'new aslary'</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees;</span><br></pre></td></tr></table></figure><p>综合案例 3：将员工的姓名按首字母排序，并写出姓名长度</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">last_name 姓名,<span class="built_in">LENGTH</span>(last_name) 姓名长度,<span class="built_in">SUBSTR</span>(last_name,<span class="number">1</span>,<span class="number">1</span>) 首字母</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 首字母;</span><br></pre></td></tr></table></figure><p>综合案例 4：做一个查询，产生下面的结果</p><p><salary_name> earns <salary> monthly but wants &lt;salary*3&gt;</salary></salary_name></p><p>Dream salary </p><p>King earns 24000 monthly but wants 72000</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">CONCAT</span>(last_name,<span class="string">'earns'</span>,salary,<span class="string">'monthly but wants'</span>,salary*<span class="number">3</span>) <span class="keyword">AS</span> <span class="string">"Dream alary"</span></span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">employees</span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">salary=<span class="number">24000</span>;</span><br></pre></td></tr></table></figure><p>综合案例 5：使用case-when  按照下面的条件：</p><p>job                        qrade</p><p>AD_PRES                 A</p><p>ST_MAN                  B</p><p>IT_PROG                  C</p><p>SA_PRE                    D</p><p>IT_CLEAR                 E</p><p>产生下面的结果</p><p>last_name     job_id    Grade    </p><p>King    AD_PRES   A</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name,job_id <span class="keyword">AS</span> job,</span><br><span class="line"><span class="keyword">CASE</span> job_id</span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">'AD_PRES'</span> <span class="keyword">THEN</span> <span class="string">'A'</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">'ST_MAN'</span> <span class="keyword">THEN</span><span class="string">'B'</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">'IT_PROG'</span> <span class="keyword">THEN</span> <span class="string">'C'</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">'SA_PRE'</span> <span class="keyword">THEN</span> <span class="string">'D'</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">'IT_CLEAR'</span> <span class="keyword">THEN</span> <span class="string">'E'</span></span><br><span class="line"><span class="keyword">END</span> <span class="keyword">AS</span> Grade</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">employees</span><br><span class="line"><span class="keyword">WHERE</span> job_id = <span class="string">'AD_PRES'</span></span><br></pre></td></tr></table></figure><p>分组函数</p><p>分组函数其功能：用作统计使用，又称为聚合函数或统计函数或组函数</p><p>分类包括：sum求和、avg平均值、max最大值、min最小值、count计算个数</p><p>语法：select max（字段）from 表名；</p><ul><li>简单使用方法：</li></ul><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line"><span class="built_in">SUM</span>(salary) 求和,</span><br><span class="line"><span class="built_in">AVG</span>(salary) 平均值,</span><br><span class="line"><span class="built_in">MIN</span>(salary) 最小值,</span><br><span class="line"><span class="built_in">MAX</span>(salary) 最大值,</span><br><span class="line"><span class="built_in">COUNT</span>(salary) 计数值 </span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure><ul><li><p>参数支持哪些类型</p><p>sum、avg 一般处理数值型</p></li></ul><p>​       max、min、count  可以处理任何类型</p><ul><li><p>是否忽略null</p><p>sum、avg、max、min、count 都忽略null值。</p></li><li><p>可以和distinct搭配</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(<span class="keyword">DISTINCT</span> salary),<span class="built_in">SUM</span>(salary) <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure></li><li><p>count 函数详细介绍</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(字段) <span class="keyword">FROM</span> employees;   统计该字段非空值的个数</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(*) <span class="keyword">FROM</span> employees;     统计结果集的行数</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure><p>一般推荐<code>COUNT(*)</code> 来进行统计使</p></li></ul><ul><li>和分组函数一同查询的字段有限制，要求是group by 后的字段</li></ul><p>综合案例1：查询公司员工工资的最大值，最小值，平均值及总和</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line"><span class="built_in">MAX</span>(salary) 工资最大值,</span><br><span class="line"><span class="built_in">MIN</span>(salary) 工资最小值,</span><br><span class="line"><span class="built_in">AVG</span>(salary) 工资平均值,</span><br><span class="line"><span class="built_in">SUM</span>(salary) 工资总和 </span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">employees;</span><br></pre></td></tr></table></figure><p>综合案例2：查询员工中的最大入职时间和最小入职时间的相差天数（DIFFRENCR）</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT DATEDIFF(<span class="name">MAX</span>(<span class="name">hiredate</span>),MIN(<span class="name">hiredate</span>)) DIFFRENCE </span><br><span class="line">FROM employees<span class="comment">;</span></span><br></pre></td></tr></table></figure><p>综合案例3：查询部门编号为90的员工个数</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(*)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">department_id=<span class="number">90</span>;</span><br></pre></td></tr></table></figure><h3 id="分组查询语句（进阶五）"><a href="#分组查询语句（进阶五）" class="headerlink" title="分组查询语句（进阶五）"></a>分组查询语句（进阶五）</h3><p>语法：</p><p>select 分组函数，列名（要求出现在group by 的后面）</p><p>from 表名</p><p>【where 筛选条件】</p><p>group by 分组的列名</p><p>【order by子句】</p><p>注意：</p><ul><li><p>查询列表必须特殊，要求是分组函数和group by后出现的字段</p></li><li><p>group by 支持单个字段查询，也支持多个字段查询（多字段之间用用逗号隔开，没有先后顺序之分）</p></li><li><p>也可插入排序语句，放在整个分组查询语句的最后</p></li></ul><p>分组分类</p><p>1.分组前查询          原始表                               group by 之前</p><p>2.分组后查询          分组后的结果集                group by 之后</p><p>能用分组前删选的，尽量用分组前查询。</p><blockquote><p> 简单分组查询</p></blockquote><p>案例1：查询每个工种的最高工资</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">MAX(salary),job_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line">GROUP BY job_id;</span><br></pre></td></tr></table></figure><p>案例2：查询每个位置上的部门个数</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">COUNT(*),location_id</span><br><span class="line"><span class="keyword">FROM</span> departments</span><br><span class="line">GROUP BY location_id;</span><br></pre></td></tr></table></figure><blockquote><p>添加删选条件的分组查询</p></blockquote><p>1、添加分组前删选</p><p>案例1：查询邮箱中包含a字符的，每个部门的平均工资</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="keyword">AVG</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">email <span class="keyword">LIKE</span> <span class="string">'%a%'</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id;</span><br></pre></td></tr></table></figure><p>案例2：查询有奖金的  每个领导手下员工的最高工工资</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">MAX(salary),manager_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line">WHERE</span><br><span class="line">commission_pct IS <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">GROUP BY manager_id;</span><br></pre></td></tr></table></figure><p>2、添加分组后删选</p><p>案例1：查询哪个部门的员工个数大于2</p><p>思路：先查询每个部门的员工个数—再查询大于2个员工的部门</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">COUNT<span class="comment">(*),department_id</span></span><br><span class="line"><span class="comment">FROM</span></span><br><span class="line"><span class="comment">employees</span></span><br><span class="line"><span class="comment">GROUP BY department_id</span></span><br><span class="line"><span class="comment">HAVING COUNT(*)</span>&gt;<span class="number">2</span>;</span><br></pre></td></tr></table></figure><p>案例2：查询每个工种有奖金的员工的最高工资大于12000的工种编号和最高工资</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">MAX(salary),job_id</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">commission_pct IS <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">GROUP BY job_id</span><br><span class="line">HAVING MAX(salary)&gt;12000;</span><br></pre></td></tr></table></figure><p>案例3：查询领导编号大于102的每个领导手下最低工资大于5000的领导编号</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">MIN(salary),manager_id  </span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line">WHERE</span><br><span class="line">manager_id&gt;102</span><br><span class="line">GROUP BY manager_id</span><br><span class="line">HAVING MIN(salary)&gt;5000;</span><br></pre></td></tr></table></figure><p>2.1、按表达式或函数分组</p><p>案例4：按员工姓名长度分组，查询每一组员工的个数，删选员工个数大于5的有哪些</p><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">COUNT<span class="comment">(*),LENGTH(last_name) 姓名长度</span></span><br><span class="line"><span class="comment">FROM</span></span><br><span class="line"><span class="comment">employees</span></span><br><span class="line"><span class="comment">GROUP BY LENGTH(last_name)</span></span><br><span class="line"><span class="comment">HAVING COUNT(*)</span>&gt;<span class="number">5</span>;</span><br></pre></td></tr></table></figure><p>2.2、按多个字段分组</p><p>查询每个部门每个工种的员工的平均工资</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">AVG(salary),department_id,job_id</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">employees</span><br><span class="line">GROUP BY department_id,job_id;</span><br></pre></td></tr></table></figure><p>2.3、添加排序</p><p>查询每个部门每个工种的员工的平均工资，并按照工资从高到底排序</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">AVG(salary),department_id,job_id</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">employees</span><br><span class="line">GROUP BY department_id,job_id</span><br><span class="line">ORDER BY AVG(salary) DESC;</span><br></pre></td></tr></table></figure><p>综合案例1：查询员工最高工资和最低工资的差距（DIFFERENCE）</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line"><span class="built_in">MAX</span>(salary)-<span class="built_in">MIN</span>(salary) DIFFRENCE</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">employees;</span><br></pre></td></tr></table></figure><p>综合案例2：查询各个管理者手下员工的最低工资，其中最低工资不能低于6000，没有管理者的员工不计算在内</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">MIN(salary),manager_id</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line">WHERE manager_id IS <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">GROUP BY manager_id</span><br><span class="line">HAVING MIN(salary)&gt;=6000;</span><br></pre></td></tr></table></figure><p>案例3：查询所有部门的编号，员工数量和工资平均值，并按平均工资降序</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">department_id 部门编号,<span class="built_in">COUNT</span>(*) 员工数量,<span class="built_in">ROUND</span>(<span class="built_in">AVG</span>(salary),<span class="number">2</span> )平均工资</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 平均工资 <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>案例4：选择具有各个job_id的员工人数</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">COUNT(*),job_id</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">employees</span><br><span class="line">GROUP BY job_id</span><br></pre></td></tr></table></figure><h3 id="连接查询语句（进阶六）"><a href="#连接查询语句（进阶六）" class="headerlink" title="连接查询语句（进阶六）"></a>连接查询语句（进阶六）</h3><p>当查询中涉及到多个表的字段，需要使用多表连接</p><p>select 字段1，字段2</p><p>from 表1，表2，……..</p><p><font color="red">笛卡尔乘积现象</font>：表1 有m行，表2有n行，结果=m*n行,发生这个原因是由于没有有效的链接条件，要想避免该现象，只要添加有效的链接条件即可。</p><p>连接查询分类：</p><ul><li><p>按年代分类：</p><p>sql92 连接查询   </p><ul><li>等值</li><li>非等值</li><li>自连接</li></ul><p>sql99 连接查询   （<font color="red">推荐使用</font>）</p><ul><li><p>内连接</p><ul><li>等值</li><li>非等值</li><li>自连接</li></ul></li><li><p>外连接</p><ul><li>左外</li><li>右外</li><li>全外（MySQL不支持）</li></ul></li><li><p>交叉连接</p></li></ul></li></ul><h4 id="SQL92语法"><a href="#SQL92语法" class="headerlink" title="SQL92语法"></a>SQL92语法</h4><p>1、等值连接</p><p>语法：</p><p>select 查询列表</p><p>from 表1 别名，表2 别名</p><p>where  表1.key=表2.key   （等值连接条件）</p><p>【AND 删选条件】</p><p>【groub by 分组字段】</p><p>【having 分组后的删选】</p><p>【order by 排序】</p><p>注意事项：</p><ul><li><p>多表的顺序没有要求</p></li><li><p>一般需要为表起别名</p></li><li><p>可以搭配前面介绍的所有查询语句</p></li><li><p>n表连接，至少需要n-1个连接条件</p></li><li><p>多表等值连接的结果为多表的交集部分</p></li></ul><p>案例1：查询女神名对应的男神名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">NAME</span>,boyname <span class="keyword">FROM</span> boys,beauty</span><br><span class="line"><span class="keyword">WHERE</span> beauty.boyfriend_id=boys.id ;</span><br></pre></td></tr></table></figure><p>案例2：查询员工名和对应的部门名</p><p>1.2、为表起别名，提高语句简洁度/区分多个重名的字段。</p><ul><li>如果为表起别名，则查询的字段就不能使用原来的表名</li></ul><p>案例1：查询员工名，工种号、工种名</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> d.last_name,d.job_id,s.job_title</span><br><span class="line"><span class="keyword">FROM</span> employees d,jobs s</span><br><span class="line"><span class="keyword">WHERE</span> d.job_id=s.job_id;</span><br></pre></td></tr></table></figure><p>1.3、可以加删选</p><p>案例1：查询有奖金的员工名、部门名</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">e</span>.last_name,d.department_name,commission_pct</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="built_in">e</span>,departments d</span><br><span class="line"><span class="keyword">WHERE</span> <span class="built_in">e</span>.department_id=d.department_id</span><br><span class="line"><span class="keyword">AND</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure><p>案例2：查询城市名中第二个字符为O的对应的部门名和城市名</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> department_name,city</span><br><span class="line"><span class="keyword">FROM</span> departments d,locations f</span><br><span class="line"><span class="keyword">WHERE</span> d.location_id=f.location_id</span><br><span class="line"><span class="keyword">AND</span> city <span class="keyword">LIKE</span> <span class="string">'_o%'</span>;</span><br></pre></td></tr></table></figure><p>1.4、加分组</p><p>案例1：查询每个城市的部门个数</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT COUNT(*),city</span><br><span class="line"><span class="keyword">FROM</span> departments d,locations l</span><br><span class="line">WHERE d.<span class="attribute">location_id</span>=l.`location_id`</span><br><span class="line">GROUP BY city;</span><br></pre></td></tr></table></figure><p>案例2：查询有奖金的每个部门的部门名和部门的领导编号和该部门的最低工资</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary),f.manager_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees d,departments f</span><br><span class="line"><span class="keyword">WHERE</span> d.<span class="symbol">`department_id`</span>=f.<span class="symbol">`department_id`</span></span><br><span class="line"><span class="keyword">AND</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_name,f.manager_id;</span><br></pre></td></tr></table></figure><p>1.5、加排序</p><p>案例1：查询每个工种的工种名和员工个数，并且按员工个数降序</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> job_title,<span class="built_in">COUNT</span>(*)</span><br><span class="line"><span class="keyword">FROM</span> employees d,jobs f</span><br><span class="line"><span class="keyword">WHERE</span> d.<span class="symbol">`job_id`</span>=f.<span class="symbol">`job_id`</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_title</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">COUNT</span>(*) <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>1.6 实现三表连接</p><p>案例1：查询员工名 部门名 所在城市</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name,department_name,city</span><br><span class="line"><span class="keyword">FROM</span> employees d,departments m,locations s</span><br><span class="line"><span class="keyword">WHERE</span> d.department_id=m.department_id</span><br><span class="line"><span class="keyword">AND</span> m.<span class="symbol">`location_id`</span>=s.<span class="symbol">`location_id`</span></span><br></pre></td></tr></table></figure><p>2、非等值连接</p><p>语法：</p><p>select 查询列表</p><p>from 表1 别名，表2 别名</p><p>where  非等值的连接条件</p><p>【AND 删选条件】</p><p>【groub by 分组字段】</p><p>【having 分组后的删选】</p><p>【order by 排序】</p><p>案例1：查询出员工 的工资和工资级别</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> salary,grade_level</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="built_in">e</span>,job_grades f</span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="keyword">BETWEEN</span> f.lowest_sal <span class="keyword">AND</span> f.highest_sal;</span><br></pre></td></tr></table></figure><p>3.自连接</p><p>语法：</p><p>select 查询列表</p><p>from 表 别名1，表 别名2</p><p>where  非等值的连接条件</p><p>【AND 删选条件】</p><p>【groub by 分组字段】</p><p>【having 分组后的删选】</p><p>【order by 排序】</p><p>综合案例1：显示员工表的最大工资，工资平均值</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary),<span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure><p>综合案例2：查询员工表的employee_id,job_id,last_name,按department_id降序，salary升序</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> employee_id,job_id,last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> department_id <span class="keyword">DESC</span>,salary <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure><p>综合案例3：查询员工表的job_id中包含a和e 的，并且a 在 e前面</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name,job_id </span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> job_id <span class="keyword">LIKE</span> <span class="string">'%a%e%'</span>;</span><br></pre></td></tr></table></figure><p>综合案例4：</p><p>已知表student,里面有id（学号），name ， gradeID（年级编号）</p><p>已知表grade，里面有id（年级编号） ,name（年级名）</p><p>已知表result，里面有id ，score，studentNo（学号）</p><p>要求查询姓名、年级名、成绩</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT <span class="selector-tag">a</span><span class="selector-class">.name</span> <span class="selector-tag">b</span><span class="selector-class">.name</span> score</span><br><span class="line">FROM student <span class="selector-tag">a</span>,grade <span class="selector-tag">b</span>,result c</span><br><span class="line">WHERE <span class="selector-tag">a</span>.id=c.studentNo</span><br><span class="line">AND <span class="selector-tag">a</span>.gradeID=<span class="selector-tag">b</span>.id</span><br></pre></td></tr></table></figure><p>综合案例5：显示所有员工的姓名，部门号和部门名称</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">USE myemployees;</span><br><span class="line"><span class="keyword">SELECT</span> last_name,d.department_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="built_in">e</span>,departments d</span><br><span class="line"><span class="keyword">WHERE</span> <span class="built_in">e</span>.<span class="symbol">`department_id`</span>=d.<span class="symbol">`department_id`</span>;</span><br></pre></td></tr></table></figure><p>综合案例6：查询90号部门员工的job_id和90号部门的location_id；</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> job_id,location_id</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="built_in">e</span>,departments d</span><br><span class="line"><span class="keyword">WHERE</span> <span class="built_in">e</span>.<span class="symbol">`department_id`</span>=d.<span class="symbol">`department_id`</span></span><br><span class="line"><span class="keyword">AND</span> <span class="built_in">e</span>.department_id=<span class="number">90</span>;</span><br></pre></td></tr></table></figure><p>综合案例7：选择所有奖金员工的last_name，department_name,location_id,city</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name,department_name,s.location_id,city</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="built_in">e</span>,departments d,locations s</span><br><span class="line"><span class="keyword">WHERE</span> <span class="built_in">e</span>.<span class="symbol">`department_id`</span>=d.<span class="symbol">`department_id`</span></span><br><span class="line"><span class="keyword">AND</span> d.<span class="symbol">`location_id`</span>=s.<span class="symbol">`location_id`</span></span><br><span class="line"><span class="keyword">AND</span> <span class="built_in">e</span>.commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure><p>综合案例8：选择city在Toroto工作的员工的last_name,department_id,department_name</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name,<span class="built_in">e</span>.department_id,department_name,f.city</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="built_in">e</span>,departments d,locations f</span><br><span class="line"><span class="keyword">WHERE</span> <span class="built_in">e</span>.<span class="symbol">`department_id`</span>=d.<span class="symbol">`department_id`</span></span><br><span class="line"><span class="keyword">AND</span> d.<span class="symbol">`location_id`</span>=f.<span class="symbol">`location_id`</span></span><br><span class="line"><span class="keyword">AND</span> f.<span class="symbol">`city`</span>=<span class="string">'Toronto'</span></span><br></pre></td></tr></table></figure><p>综合案例9：查询每个工种、每个部门的部门名、工种名和最低工资</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> department_name,job_title,<span class="built_in">MIN</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> departments d,jobs j,employees <span class="built_in">e</span></span><br><span class="line"><span class="keyword">WHERE</span> d.<span class="symbol">`department_id`</span>=<span class="built_in">e</span>.<span class="symbol">`department_id`</span></span><br><span class="line"><span class="keyword">AND</span> j.job_id<span class="symbol">`=e.`</span>job_id<span class="symbol">`</span></span><br><span class="line"><span class="symbol">group by department_name,job_title</span></span><br></pre></td></tr></table></figure><p>综合案例10：查询每个国家下的部门个数大于2的国家编号 第77课时</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT country_id,COUNT(*)</span><br><span class="line"><span class="keyword">FROM</span> departments d,locations s</span><br><span class="line">WHERE d.<span class="attribute">location_id</span>=s.location_id</span><br><span class="line">GROUP BY country_id</span><br><span class="line">HAVING COUNT(*)&gt;2</span><br></pre></td></tr></table></figure><h4 id="SQL99语法"><a href="#SQL99语法" class="headerlink" title="SQL99语法"></a>SQL99语法</h4><p>语法：</p><p>select 查询列表</p><p>from 表1 别名 </p><p>【连接类型】jion   表2 别名 </p><p>on 连接条件</p><p>【where 筛选条件】</p><p>【group by 分组】</p><p>【having 筛选条件】</p><p>【order by 排序条件】</p><p>分类</p><p>内连接：inner</p><p>外连接</p><ul><li>左外：left  【outer】</li><li>右外:   right  【outer】</li><li>全外： full  【outer】</li></ul><p>交叉连接</p><p>1.内连接</p><p>语法：</p><p>select 查询列表</p><p>from 表1 别名 </p><p>inner join   表2 别名 </p><p>on 连接条件；</p><p>分类：</p><ul><li>等值</li><li>非等值</li><li>自连接</li></ul><p>特点：</p><ul><li>可添加排序、分组、筛选</li><li>筛选条件放在where后面，连接条件放在on后面，提高分离性，便于阅读</li><li>inner 可以省略</li><li>inner join连接和sql92语法中的等值连接效果是一样的，查询表的交集部分</li></ul><p>1.1、等值连接</p><p>案例1：查询员工名，部门名</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="built_in">e</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> departments b</span><br><span class="line"><span class="keyword">ON</span> <span class="built_in">e</span>.<span class="symbol">`department_id`</span>=b.<span class="symbol">`department_id`</span>;</span><br></pre></td></tr></table></figure><p>案例2：查询名字中包含e的员工名和工种名</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name,job_title</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="built_in">e</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> jobs b</span><br><span class="line"><span class="keyword">ON</span> <span class="built_in">e</span>.<span class="symbol">`job_id`</span>=b.<span class="symbol">`job_id`</span></span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">'%e%'</span>;</span><br></pre></td></tr></table></figure><p>案例3：查询部门个数&gt;3的城市名和部门个数</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> city,<span class="built_in">COUNT</span>(*) 部门个数</span><br><span class="line"><span class="keyword">FROM</span> locations l</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> l.<span class="symbol">`location_id`</span>=d.<span class="symbol">`location_id`</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> city</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(*)&gt;<span class="number">3</span>;</span><br></pre></td></tr></table></figure><p>案例4：查询哪个部门的部门员工数》3的部门名和员工个数，并按个数降序排列。</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> department_name,<span class="built_in">COUNT</span>(*) 员工数</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> employees <span class="built_in">e</span></span><br><span class="line"><span class="keyword">ON</span> d.<span class="symbol">`department_id`</span>=<span class="built_in">e</span>.<span class="symbol">`department_id`</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_name</span><br><span class="line"><span class="keyword">HAVING</span> 员工数 &gt;=<span class="number">3</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 员工数 <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>案列5：查询员工名、部门名、工种名，并按部门名降序</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name,department_name,job_title</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="built_in">e</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> departments d <span class="keyword">ON</span> <span class="built_in">e</span>.<span class="symbol">`department_id`</span>=d.<span class="symbol">`department_id`</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> jobs j <span class="keyword">ON</span> <span class="built_in">e</span>.<span class="symbol">`job_id`</span>=j.<span class="symbol">`job_id`</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> department_name <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><p>1.2、非等值连接</p><p>案例1：查询员工的工资级别</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> salary,grade_level</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="built_in">e</span></span><br><span class="line"><span class="keyword">JOIN</span> job_grades j</span><br><span class="line"><span class="keyword">ON</span> <span class="built_in">e</span>.salary <span class="keyword">BETWEEN</span> j.lowest_sal <span class="keyword">AND</span> j.highest_sal;</span><br></pre></td></tr></table></figure><p>案例2：查询工资级别的个数&gt;20的个数，并且按工资级别降序排序</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(*) 工资级别个数,grade_level</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="built_in">e</span></span><br><span class="line"><span class="keyword">JOIN</span> job_grades j</span><br><span class="line"><span class="keyword">ON</span> <span class="built_in">e</span>.salary <span class="keyword">BETWEEN</span> j.lowest_sal <span class="keyword">AND</span> j.highest_sal</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> grade_level</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(*)&gt;<span class="number">20</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">COUNT</span>(*) <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure><p>1.3、自连接</p><p>案例1：查询姓名中包含K的员工的名字、上级名字</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">e</span>.last_name 员工名,d.last_name 上级名</span><br><span class="line"><span class="keyword">FROM</span> employees <span class="built_in">e</span></span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> employees d</span><br><span class="line"><span class="keyword">ON</span> <span class="built_in">e</span>.manager_id=d.employee_id</span><br><span class="line"><span class="keyword">WHERE</span> <span class="built_in">e</span>.last_name <span class="keyword">LIKE</span> <span class="string">'%k%'</span>;</span><br></pre></td></tr></table></figure><p>1.4、左（右）外连接</p><p>应用场景：用于查询一个表中有，另一个表中没有的记录</p><p>特点：</p><p>1、外连接的查询结果为主表中的所有记录</p><ul><li>如果从表中有和它匹配的，则显示匹配的值</li><li>如果从表中没有和他匹配的，则显示null</li><li>外连接查询结果=内连接结果+主表中有而从表中没有的记录</li></ul><p>2、左外连接 left join 左边的是主表/右外连接 right join 右边是主表</p><p>3、左外和右外如果交换两表的顺序，可以实现同样的效果</p><p>案例1：查询没有男朋友的女神名</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> b.name,d.*</span><br><span class="line"><span class="keyword">FROM</span> beauty b</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> boys d</span><br><span class="line"><span class="keyword">ON</span> b.<span class="symbol">`boyfriend_id`</span>=d.<span class="symbol">`id`</span></span><br></pre></td></tr></table></figure><p>案例2：查询哪个部门没有员工</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> d.*,<span class="built_in">e</span>.employee_id</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> employees <span class="built_in">e</span></span><br><span class="line"><span class="keyword">ON</span> d.department_id = <span class="built_in">e</span>.department_id</span><br><span class="line"><span class="keyword">WHERE</span> <span class="built_in">e</span>.employee_id <span class="keyword">IS</span> <span class="literal">NULL</span></span><br></pre></td></tr></table></figure><p>1.5 全外连接</p><p>全外连接=内连接的结果+表1有表2没有的+表2有表1没有的</p><p>不支持</p><p>1.6、交叉连接</p><p>SQL99 语句图形示意：</p><img src="https://i.loli.net/2019/11/13/A3UkPWzL9adbMyE.jpg" width="600"><img src="https://i.loli.net/2019/11/13/dFU9eMA6VEIJRKQ.jpg" width="600"><p>综合案例1：查询编号&gt;3的女神的男朋友信息，如果有则列出详细，如果没有就用null填充</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> b.id,b.name,bo.*</span><br><span class="line"><span class="keyword">FROM</span> beauty b</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> boys bo</span><br><span class="line"><span class="keyword">ON</span> b.<span class="symbol">`boyfriend_id`</span>=bo.<span class="symbol">`id`</span></span><br><span class="line"><span class="keyword">WHERE</span> b.id &gt;<span class="number">3</span>;</span><br></pre></td></tr></table></figure><p>综合案例2：查询哪个城市没有部门？</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">左外连接</span><br><span class="line"><span class="keyword">SELECT</span> city,s.*</span><br><span class="line"><span class="keyword">FROM</span> departments s</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> locations l</span><br><span class="line"><span class="keyword">ON</span> s.<span class="symbol">`location_id`</span>=l.<span class="symbol">`location_id`</span></span><br><span class="line"><span class="keyword">WHERE</span> s.department_id <span class="keyword">IS</span> <span class="literal">NULL</span>；</span><br><span class="line"></span><br><span class="line">右外连接</span><br><span class="line"><span class="keyword">SELECT</span> city,s.*</span><br><span class="line"><span class="keyword">FROM</span> locations l</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> departments s</span><br><span class="line"><span class="keyword">ON</span> s.<span class="symbol">`location_id`</span>=l.<span class="symbol">`location_id`</span></span><br><span class="line"><span class="keyword">WHERE</span> s.department_id <span class="keyword">IS</span> <span class="literal">NULL</span>；</span><br></pre></td></tr></table></figure><p>综合案例3：</p><p>查询部门名为SAL或IT的员工信息</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> d.department_name,<span class="built_in">e</span>.*</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> employees <span class="built_in">e</span></span><br><span class="line"><span class="keyword">ON</span> d.<span class="symbol">`department_id`</span>=<span class="built_in">e</span>.<span class="symbol">`department_id`</span></span><br><span class="line"><span class="keyword">WHERE</span> d.department_name <span class="keyword">IN</span>(<span class="string">'SAL'</span>,<span class="string">'IT'</span>)</span><br></pre></td></tr></table></figure><h3 id="子查询语句（进阶七）"><a href="#子查询语句（进阶七）" class="headerlink" title="子查询语句（进阶七）"></a>子查询语句（进阶七）</h3><p>出现在其它语句中的select语句，称为子查询或内查询</p><p>外部的查询语句，称为主查询或外查询</p><p>分类：</p><p>按出现的位置分类：</p><ul><li>select后面   仅仅支持标量子查询</li><li>from后面   支持表子查询</li><li><font color="red">where或having</font>后面   <font color="red">标量子查询、列子查询</font>&gt;、行子查询</li><li>exists后面  表查询</li></ul><p>按结果集的行列数不同：</p><ul><li>标量子查询（结果集只有一行一列）</li><li>列子查询（结果集只有一列多行）</li><li>行子查询（结果集只有一行多列）</li><li>表子查询（结果集一般为多行多列）</li></ul><p>1、where和having后面</p><ul><li>标量子查询（单行子查询）<ul><li>一般搭配单行操作符使用 </li></ul></li><li>列子查询（多行子查询）<ul><li>一般搭配多单行操作符使用  in、any/some、all</li></ul></li><li>行子查询（多列多行）</li></ul><p>特点：</p><ul><li>子查询放在小括号内</li><li>子查询一般放在条件的右侧</li><li>标量子查询，一般搭配单行操作符使用</li><li>子查询的执行优先与主查询执行</li></ul><p><strong>1.1where后面的标量子查询</strong></p><p>案例1查询谁的工资比Albel的工资高</p><p>思路：1.查询Albel的工资——2.查询员工的信息，满足salary&gt;1的结果</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary&gt;(</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name = <span class="string">"Abel"</span></span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>案例2：返回job_id与141号员工相同，salary比143号员工多的员工姓名，job_id 和工资</p><p>思路：1.查询 与141号员工相同的job_id——2.查询143号员工的工资——3查询员工姓名，job_id 和工资，满足1结果且工资大于2结果</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name,job_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> job_id=(</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> job_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> employee_id=<span class="number">141</span></span><br><span class="line"></span><br><span class="line">)<span class="keyword">AND</span> salary&gt;(</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> employee_id=<span class="number">143</span></span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>案例三：返回公司工资最少的员工的last_name,job_id和salary<br>$$</p><p>$$</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name,job_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary=(</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>案例4：查询最低工资大于50号部门最低工资的部门id和其最低工资</p><p>思路 :1、查询50号部门的最低工资——2、查询所有部门的最低工资——3、在2结果的基础上筛选 满足最低工资大于1结果</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT MIN(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees </span><br><span class="line">GROUP BY department_id</span><br><span class="line">HAVING MIN(salary)&gt;(</span><br><span class="line"></span><br><span class="line">SELECT MIN(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees </span><br><span class="line">WHERE <span class="attribute">department_id</span>=50</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>1.2where后面的列子查询（多行子查询）</strong></p><p>in/not in    (等于列表中的任意一个值)</p><p><del>any|some   （和子查询返回的某一个值比较）</del>   推荐用 <font color="red">a&gt;min()</font>代替a&gt;any() </p><p><del>all  （和子查询返回的所有值比较）</del>  推荐用 <font color="red">a&gt;max()</font>代替a&gt;any() </p><p>案例1：返回location_id 是1400或者1700的部门中所有员工的姓名</p><p>思路：1：查询location_id是1400或1700的部门编号—2：查询满足1结果的员工姓名</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="keyword">IN</span>(</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> department_id</span><br><span class="line"><span class="keyword">FROM</span> departments</span><br><span class="line"><span class="keyword">WHERE</span> location_id <span class="keyword">IN</span>(<span class="number">1400</span>,<span class="number">1700</span>)</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>案例2：返回其他部门中比job_id为’IT_PROG’部门任一工资低的员工的：工号、姓名、job_id,以及salary.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,job_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary &lt;<span class="keyword">ANY</span>(</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> job_id=<span class="string">'IT_PROG'</span></span><br><span class="line"></span><br><span class="line">)<span class="keyword">AND</span> job_id&lt;&gt;<span class="string">'IT_PROG'</span></span><br></pre></td></tr></table></figure><p>案例3：返回其他部门中比job_id为’IT_PROG’部门所有工资低的员工的：工号、姓名、job_id,以及salary.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,job_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary &lt;(</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">min</span>(msalary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> job_id=<span class="string">'IT_PROG'</span></span><br><span class="line"></span><br><span class="line">)<span class="keyword">AND</span> job_id&lt;&gt;<span class="string">'IT_PROG'</span></span><br></pre></td></tr></table></figure><p><strong>1.3where后面的行子查询</strong>（结果集一行多列或多行多列）</p><p>案例：查询员工编号最小且工资最高的员工信息</p><p>方法1：之前的语法</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> employee_id=(</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(employee_id)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line">)</span><br><span class="line"><span class="keyword">AND</span> salary=(</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line">);</span><br></pre></td></tr></table></figure><p><strong>1.4 select后面</strong></p><p>案例1：查询每个部门的员工个数</p><p><font color="red">90~95级  重学</font>&gt;</p><p><strong>综合案列讲解：</strong></p><p>1.查询工资最低的员工信息：last_name  salary</p><p>思路1：查询最低工资</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(salary)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> employees;</span><br></pre></td></tr></table></figure><p>思路2：查询满足1的 last_name salary</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> last_name,salary</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"></span><br><span class="line"><span class="keyword">where</span> salary=(</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(salary)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> employees</span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>2.查询平均工资最低的部门信息</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> departments</span><br><span class="line"><span class="keyword">WHERE</span> department_id=(</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">AVG</span>(salary) </span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>3.查询平均工工资最低的部门信息和该部门的平均工资</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> d.*,ag</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span>(</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) ag,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> ag</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line">)ag_dep</span><br><span class="line"><span class="keyword">ON</span> d.<span class="symbol">`department_id`</span>=ag_dep.department_id</span><br></pre></td></tr></table></figure><p>4.查询平均工资最高的job信息</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> jobs</span><br><span class="line"><span class="keyword">WHERE</span> job_id=(</span><br><span class="line"><span class="keyword">SELECT</span> job_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">AVG</span>(salary) <span class="keyword">DESC</span></span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">1</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure><p>5.查询平均工资高于公司平均工资的部门有哪些？</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> d.department_name </span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> (</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) dvg,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">AVG</span>(salary)&gt;(<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> employees)</span><br><span class="line"></span><br><span class="line">) dvg_dep</span><br><span class="line"><span class="keyword">ON</span> d.department_id=dvg_dep.department_id</span><br></pre></td></tr></table></figure><p>6.各个部门中最高工资中最低的那个部门的最低工资是多少</p><p>7.查询平均工资最高的部门的manager的详细信息：last_name,depatment_id,email,salary</p><p>6.查询出公司中所以有manager的详细信息</p><p>所有manager的员工编号</p><h3 id="分页查询语句（进阶八）"><a href="#分页查询语句（进阶八）" class="headerlink" title="分页查询语句（进阶八）"></a>分页查询语句（进阶八）</h3><p>应用场景：当我们要显示的数据一页显示不全，我们就要分页提交sql请求。</p><p>语法：</p><p>select 查询列表</p><p>from 表</p><p>【join type】join 表2</p><p>on 连接条件</p><p>where 删选条件</p><p>group by 分组字段</p><p>having 分组后的删选</p><p>order by 排序的字段</p><p>limit offset, size;</p><p>其中：</p><ul><li>offset：要显示条目的起始索引，从0开始,。从0开始offset可省略 </li><li>size：要显示的条目个数;</li></ul><p>特点：</p><ul><li><p>limit语句在查询语句的最后，在执行顺序中也是最后一步。</p></li><li><p>公式</p><p>要显示的页数 page, 每页的条目数size</p><p>select 查询列表</p><p>from 表</p><p>limit （page-1）*size，size</p></li><li><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">size</span>=10</span><br><span class="line"></span><br><span class="line">page</span><br><span class="line">1        0</span><br><span class="line">2       10</span><br><span class="line">3       20</span><br></pre></td></tr></table></figure></li></ul><p>案例1：查询前五条员工信息</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">0</span>,<span class="number">4</span>;</span><br></pre></td></tr></table></figure><p>案例2：查询第1条—第25条</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">LIMIT</span> <span class="number">10</span>,<span class="number">15</span>;</span><br></pre></td></tr></table></figure><p>案例3：有奖金的员工信息，并且工资较高的前10名显示出来</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> </span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span> <span class="keyword">LIMIT</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure><p><strong>综合案例讲解：</strong></p><p>已知表 stuinfo</p><p>id 学号</p><p>name 姓名</p><p>email 邮箱</p><p>grade id 年级编号</p><p>sex 性别  男  女</p><p>age 年龄</p><p>已知表 grade </p><p>id 年级编号</p><p>gradeName 年级名称</p><p>答题1：查询所有学员的邮箱用户名（注：邮箱中@前面的字符）</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">select  substr(<span class="section">email</span>,<span class="number">1</span>,instr(<span class="section">email</span>,‘@‘)<span class="number">-1</span>)  用户名</span><br><span class="line"></span><br><span class="line">from stuinfo</span><br></pre></td></tr></table></figure><p>注：</p><p> instr(field, str) 函数，第一个参数 field 是字段，第二个参数 str 是要查询的串，返回串 str 的位置，没找到就是0 </p><p>答题2：查询男生和女生的个数</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">select count（*）个数，sex</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> stuinfo </span><br><span class="line"></span><br><span class="line">group by  sex;</span><br></pre></td></tr></table></figure><p>答题3：查询年龄大于18岁的所有学生的姓名和年级名称</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> s.name,g.gradeName</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> stuinfo s</span><br><span class="line"></span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span> grade g <span class="keyword">on</span> s.grade <span class="keyword">id</span>=g.id</span><br><span class="line"></span><br><span class="line"><span class="keyword">where</span> age&gt;<span class="number">18</span>;</span><br></pre></td></tr></table></figure><p>答题4：查询哪个年级的学生最小年龄&gt;20岁</p><p>思路1：查询每个年级学生的最小年龄数  2:在一的基础上删选</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">select min(age),grade id</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> stuinfo</span><br><span class="line"></span><br><span class="line">group by grade id</span><br><span class="line"></span><br><span class="line">having min(age)&gt;20;</span><br></pre></td></tr></table></figure><p>答题5：试说出查询语句中涉及到的所有关键字，及执行先后顺序</p><p>select  查询的列表                        7</p><p>from 表 1                                       1</p><p>链接类型 join 表2                          2</p><p>on 连接条件                                   3</p><p>where 删选条件                            4</p><p>group by 分组条件                       5</p><p>having  分组后的删选条件           6</p><p>order by 排序条件                        8</p><p>limit 偏移条目数                           9</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="MySQL" scheme="https://www.iamzmj.top/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="https://www.iamzmj.top/tags/MySQL/"/>
    
      <category term="数据库" scheme="https://www.iamzmj.top/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>MySQL学习笔记一：MySQL8.0安装及启动</title>
    <link href="https://www.iamzmj.top/posts/ca03e1e5.html"/>
    <id>https://www.iamzmj.top/posts/ca03e1e5.html</id>
    <published>2019-11-06T08:33:37.000Z</published>
    <updated>2019-11-19T18:01:20.020Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><h1 id="MySQL介绍"><a href="#MySQL介绍" class="headerlink" title="MySQL介绍"></a>MySQL介绍</h1><p>MySQL是一个关系型数据库管理系统，由瑞典MySQL AB 公司开发，目前属于 Oracle 旗下产品。MySQL 是最流行的关系型数据库管理系统之一，在 WEB 应用方面，MySQL是最好的 RDBMS (Relational Database Management System，关系数据库管理系统) 应用软件之一。</p><p>其特点在于：开源、免费、成本低；性能高、移随性好；体积小、便于安装。</p><p>目前MySQL已推出8.0版本。</p><img src="https://i.loli.net/2019/11/08/3gFNO8EjiYBSHMz.jpg" width="500" height="高度" align="center"><h1 id="数据库概念"><a href="#数据库概念" class="headerlink" title="数据库概念"></a>数据库概念</h1><p><strong>1、数据库好处</strong></p><p>可以持久化数据到本地</p><p>结构化查询</p><p><strong>2、数据库常见概念</strong></p><p><strong>DB</strong> (Data Base)，存储数据的仓库</p><p><strong>DBMS</strong> (Data Base Management System)  数据库管理系统，DB是通过DBMS创建和操作的容器。</p><p><strong>SQL</strong>（Strucure Query Language）结构化查询语言，专门用来同数据库通信的语言。</p><p>其特点：</p><ul><li>DBMS都支持SQL</li><li>简单易学</li><li>是一种强有力的语言。</li></ul><p><strong>3、MySQL存储数据的特点</strong></p><p>1、将数据放到表中，再将表放到数据库中。</p><p>2、一个数据库中可以有多个表，每个表都有一个名字，每张表具有唯一的表名，用来标识自己。</p><p>3、表具有一些特性，这些特性定义了数据在表中如何存储。</p><h1 id="Win10下安装MySQL8-0"><a href="#Win10下安装MySQL8-0" class="headerlink" title="Win10下安装MySQL8.0"></a>Win10下安装MySQL8.0</h1><h2 id="下载MySQL8-0"><a href="#下载MySQL8-0" class="headerlink" title="下载MySQL8.0"></a>下载<a href="https://dev.mysql.com/downloads/mysql/" rel="external nofollow noopener noreferrer" target="_blank">MySQL8.0</a></h2><h2 id="添加环境变量"><a href="#添加环境变量" class="headerlink" title="添加环境变量"></a>添加环境变量</h2><p>Windows下安装数据库，将下载的的压缩包解压， 文件位于：C:\mysql-8.0.18-winx64</p><p>然后去配置环境变量，点击电脑-&gt;属性-&gt;高级系统配置-&gt;环境变量；先对系统变量进行设置 </p><img src="https://i.loli.net/2019/11/07/uLMYeVqdUDAOnJz.png" width="500" height="高度" align="center"><img src="https://i.loli.net/2019/11/07/A8uXO3FvPstGHe4.jpg" width="500" height="高度" align="center"><img src="https://i.loli.net/2019/11/07/tyXTJFYHqWxw8QK.jpg" width="500" height="高度" align="center"><h2 id="新建配置文件"><a href="#新建配置文件" class="headerlink" title="新建配置文件"></a>新建配置文件</h2><p>打开mysql-8.0.16-winx64文件，在当前目录下，新建一个名为my.ini的文件，然后打开该文件，将下列代码加入到该文件中； </p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="comment"># 设置3306端口</span></span><br><span class="line"><span class="attr">port</span>=<span class="number">3306</span></span><br><span class="line"><span class="comment"># 设置mysql的安装目录</span></span><br><span class="line"><span class="attr">basedir</span>=C:\mysql-<span class="number">8.0</span>.<span class="number">18</span>-winx64</span><br><span class="line"><span class="comment"># 设置mysql数据库的数据的存放目录</span></span><br><span class="line"><span class="attr">datadir</span>=C:\mysql-<span class="number">8.0</span>.<span class="number">18</span>-winx64\Database</span><br><span class="line"><span class="comment"># 允许最大连接数</span></span><br><span class="line"><span class="attr">max_connections</span>=<span class="number">200</span></span><br><span class="line"><span class="comment"># 允许连接失败的次数。这是为了防止有人从该主机试图攻击数据库系统</span></span><br><span class="line"><span class="attr">max_connect_errors</span>=<span class="number">10</span></span><br><span class="line"><span class="comment"># 服务端使用的字符集默认为UTF8</span></span><br><span class="line"><span class="attr">character-set-server</span>=utf8</span><br><span class="line"><span class="comment"># 创建新表时将使用的默认存储引擎</span></span><br><span class="line"><span class="attr">default-storage-engine</span>=INNODB</span><br><span class="line"><span class="comment"># 默认使用“mysql_native_password”插件认证</span></span><br><span class="line"><span class="attr">default_authentication_plugin</span>=mysql_native_password</span><br><span class="line"><span class="section">[mysql]</span></span><br><span class="line"><span class="comment"># 设置mysql客户端默认字符集</span></span><br><span class="line"><span class="attr">default-character-set</span>=utf8</span><br><span class="line"><span class="section">[client]</span></span><br><span class="line"><span class="comment"># 设置mysql客户端连接服务端时默认使用的端口</span></span><br><span class="line"><span class="attr">port</span>=<span class="number">3306</span></span><br><span class="line"><span class="attr">default-character-set</span>=utf8</span><br></pre></td></tr></table></figure><h2 id="命令行登录"><a href="#命令行登录" class="headerlink" title="命令行登录"></a>命令行登录</h2><p>进入C:\mysql-8.0.18-winx64\bin 目录,以管理员身份打开CMD窗口，</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:<span class="symbol">\W</span>INDOWS<span class="symbol">\s</span>ystem32&gt;CD C:<span class="symbol">\m</span>ysql-8.0.18-winx64<span class="symbol">\b</span>in</span><br></pre></td></tr></table></figure><p> <strong>MySQL服务安装</strong>， 执行mysqld install命令当出现Service successfully installed时表示mysql服务安装完成 ，</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld <span class="comment">--install</span></span><br></pre></td></tr></table></figure><p>注意：mysqld –install [服务名]</p><p>后面的服务名可以不写，默认的名字为 mysql。当然，如果你的电脑上需要安装多个MySQL服务，就可以用不同的名字区分了，比如 mysql5 和 mysql8。</p><p><img src="https://i.loli.net/2019/11/20/7PKQDUm4EwN3yYx.jpg" alt></p><p> <strong>MySQL服初始化</strong>， 在MySQL安装目录的 bin 目录下执行命令： </p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">mysqld</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">initialize</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">console</span></span><br></pre></td></tr></table></figure><p> 执行完成后，会打印 root 用户的初始默认密码，比如： </p><img src="https://i.loli.net/2019/11/20/yV9DU6riTIexkAR.jpg" width="800"><p>注意！执行输出结果里面有一段： [Note] [MY-010454] [Server] A temporary password is generated for root@localhost: Ng* jbnKGd2!其中root@localhost:后面的“Ng*jbnKGd2!”就是初始密码（不含首位空格）。在没有更改密码前，需要记住这个密码，后续登录需要用到。要是手贱，关快了，或者没记住，那也没事，删掉初始化的 datadir 目录，再执行一遍初始化命令，又会重新生成的。当然，也可以使用安全工具，强制改密码，用什么方法，自己随意。</p><p><strong>启动MySQL的服务</strong>，通过命令net start mysql启动</p><p>进入D:\Program Files\mysql-8.0.11-winx64\bin路径下，执行mysql -u root -p命令，然后输入之前保存的密码，我这里是Ng*jbnKGd2_! </p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1、<span class="selector-tag">cd</span> <span class="selector-tag">C</span>:\<span class="selector-tag">mysql-8</span><span class="selector-class">.0</span><span class="selector-class">.18-winx64</span>\<span class="selector-tag">bin</span></span><br><span class="line">2、<span class="selector-tag">mysql</span> <span class="selector-tag">-u</span> <span class="selector-tag">root</span> <span class="selector-tag">-p</span></span><br></pre></td></tr></table></figure><img src="https://i.loli.net/2019/11/07/FnWYrTy1NzDwbJa.jpg" width="800" height="高度" align="center"><p>至此数据库安装成功</p><h2 id="修改初始登陆密码："><a href="#修改初始登陆密码：" class="headerlink" title="修改初始登陆密码："></a>修改初始登陆密码：</h2><p> 修改用户密码，在MySQL中执行命令： </p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">'root'</span>@<span class="string">'localhost'</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">WITH</span> mysql_native_password <span class="keyword">BY</span> <span class="string">'qq886991985'</span>;</span><br></pre></td></tr></table></figure><img src="https://i.loli.net/2019/11/20/iQKk5Prn4j2DFMq.jpg" width="800" height="高度" align="center"><h1 id="Navicat-Premium-12-登录MySQL"><a href="#Navicat-Premium-12-登录MySQL" class="headerlink" title="Navicat Premium 12  登录MySQL"></a>Navicat Premium 12  登录MySQL</h1><p><a href="https://www.lanzous.com/i77rnkj" rel="external nofollow noopener noreferrer" target="_blank">Navicat Premium 12+注册机</a>  简单连接配置即可连接使用，使用界面如下：</p><img src="https://i.loli.net/2019/11/08/8gROWhnuQKBALmx.jpg" width="800" height="高度" align="center"><h1 id="服务的启动和停止"><a href="#服务的启动和停止" class="headerlink" title="服务的启动和停止"></a>服务的启动和停止</h1><p>方式一：net start 服务名 / net stop 服务名</p><p>方式二:   计算机—右击—管理—服务</p><h1 id="登录和退出"><a href="#登录和退出" class="headerlink" title="登录和退出"></a>登录和退出</h1><p>登录：MySQL  【-h 主机名 -p 端口号】-u 用户名 -p密码</p><p>退出：exit 或者 ctrl +C</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="MySQL" scheme="https://www.iamzmj.top/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="https://www.iamzmj.top/tags/MySQL/"/>
    
      <category term="数据库" scheme="https://www.iamzmj.top/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>Win10中使用Hyper-V安装Ubuntu18.04并SSH远程</title>
    <link href="https://www.iamzmj.top/posts/b9259de4.html"/>
    <id>https://www.iamzmj.top/posts/b9259de4.html</id>
    <published>2019-11-02T03:33:34.000Z</published>
    <updated>2019-11-02T11:38:18.938Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><h1 id="安装Hyper-V"><a href="#安装Hyper-V" class="headerlink" title="安装Hyper-V"></a>安装Hyper-V</h1><p> 首先安装Hyper-V：打开Win10控制面板–程序–启用或关闭Windows功能–选择Hyper-V勾选上（全部）–然后点击确定进行安装 。</p><p><img src="https://i.loli.net/2019/11/02/Ggtk2h9zC3poIji.jpg" alt></p><p>等待安装完毕后重启电脑，安装即可生效。</p><h1 id="快速创建虚拟机"><a href="#快速创建虚拟机" class="headerlink" title="快速创建虚拟机"></a>快速创建虚拟机</h1><p>提前下载<a href="https://cn.ubuntu.com/download" rel="external nofollow noopener noreferrer" target="_blank">Ubuntu</a>操作系统镜像文件。</p><p><img src="https://i.loli.net/2019/11/02/pRTw6GH5A8sovND.jpg" alt></p><p>最后点击创建虚拟机，进入以下界面并点击链接</p><p><img src="https://i.loli.net/2019/11/02/JANil3rG9ytdEBe.jpg" alt></p><p>点击启动</p><p><img src="https://i.loli.net/2019/11/02/C9aGLPl2YcyA4D7.jpg" alt></p><p> 进入到下面页面后选择Install Ubuntu，进行Ubuntu系统安装： </p><p><img src="https://i.loli.net/2019/11/02/V8U9ZTWKj2QFzPE.jpg" alt></p><p> 进入安装界面后，选择中文（简体），然后继续： </p><p><img src="https://i.loli.net/2019/11/02/nuJg8HGwj9TvB7f.jpg" alt></p><p> 键盘布局选择默认就好，然后继续： </p><p><img src="https://i.loli.net/2019/11/02/5DZeVpkKNjmXHFU.jpg" alt></p><p> 选择正常安装，其他选项暂不勾选，避免安装速度过慢，然后继续： </p><p><img src="https://i.loli.net/2019/11/02/4QjlsgUrEqNVLpw.jpg" alt></p><p> 由于是在虚拟机里面，选择第一项就好，然后选择现在安装开始安装系统： </p><p><img src="https://i.loli.net/2019/11/02/Kj7fbEpMJGtVHwN.jpg" alt></p><p> 点击中国所在位置，选择时区，然后继续： </p><p><img src="https://i.loli.net/2019/11/02/dZDloiX4myhtwaz.jpg" alt></p><p> 设置用户信息及登陆信息，然后继续： </p><p><img src="https://i.loli.net/2019/11/02/1HIbW92X6RTJQNF.jpg" alt></p><p> 等待安装完成： </p><p><img src="https://i.loli.net/2019/11/02/3HxIF2ksclAguqo.jpg" alt></p><p>进入主界面，打开终端安装net-tools(可以通过ifconfig查询主机IP)</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt <span class="keyword">install</span> net-tools</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/11/02/fgvsS1Ao2tTRPEH.jpg" alt></p><p> 查看 ubuntu 的 ssh 服务是否启动</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -e <span class="string">| grp ssh</span></span><br></pre></td></tr></table></figure><p>出现以下提示，表示Openssh-Server已安装。</p><p> <img src="https://i.loli.net/2019/11/02/yepGJoCUx9rcnm4.jpg" alt></p><p>若未出现以上提示则需要安装openssh-server,方ssh软件远程操作</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-<span class="builtin-name">get</span> install openssh-server</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/11/02/C65p8kvtBhiy7KF.jpg" alt></p><p>设置防火墙允许22端口被访问</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ufw allow <span class="number">22</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/11/02/NEe9rnc3uXQOFK5.jpg" alt></p><p>查询主机IP</p><p><img src="https://i.loli.net/2019/11/02/LqXJWBjyU2raPSK.jpg" alt></p><p>Win+R 调用命令提示符CMD    Ping 虚拟机主机地址+端口 并回车</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telnet <span class="number">172.31</span><span class="number">.84</span><span class="number">.77</span> <span class="number">22</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2019/11/02/bQiHn96ju3g7ftG.jpg" alt></p><p>出现如下提示表示 地址端口可以ping通。</p><p><img src="https://i.loli.net/2019/11/02/rOwPhbyjFknK71I.jpg" alt></p><h1 id="安装远程登陆软件"><a href="#安装远程登陆软件" class="headerlink" title="安装远程登陆软件"></a>安装远程登陆软件</h1><p>推荐<a href="https://www.lanzous.com/i74t49i" rel="external nofollow noopener noreferrer" target="_blank">MobaXterm</a></p><p>安装完毕后，进行相关登录设置</p><p><img src="https://i.loli.net/2019/11/02/7RkIzr3iCKWgsFa.jpg" alt></p><p>至此SSH远程登陆成功</p><p><img src="https://i.loli.net/2019/11/02/FlqJXmhZAIGv7Sk.jpg" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="Ubuntu" scheme="https://www.iamzmj.top/categories/Ubuntu/"/>
    
    
      <category term="Ubuntu" scheme="https://www.iamzmj.top/tags/Ubuntu/"/>
    
      <category term="Hyper-V" scheme="https://www.iamzmj.top/tags/Hyper-V/"/>
    
  </entry>
  
  <entry>
    <title>读书计划2019</title>
    <link href="https://www.iamzmj.top/posts/10f46d57.html"/>
    <id>https://www.iamzmj.top/posts/10f46d57.html</id>
    <published>2019-10-28T17:14:20.000Z</published>
    <updated>2020-01-01T02:10:55.981Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><h1 id="读书是一剂良药"><a href="#读书是一剂良药" class="headerlink" title="读书是一剂良药"></a>读书是一剂良药</h1><p>读书读来读去，读的都不是未来，而是过去。人为何要钟情于阅读？</p><p>有些人，经历一些生活的打击，会怨恨，愤慨，绝望。而还有一些人，经历一些生活的打击，反而学会了宽恕，淡忘，释然。后者多半内心平静。从前有人说，现在静不下来读书了。另一人说，搞错了，不是静下来读书，是读书让你静下来。读书到底有没有用，我想说某种程度上没有用，但它能让人平静。平静这种心情，</p><p>在这样躁动的年代，书是一种精神药物。摆在书架上，它就像是一颗颗药丸，各有不同的功效，治各种不同的精神创伤。</p><h1 id="读书计划2019"><a href="#读书计划2019" class="headerlink" title="读书计划2019"></a>读书计划2019</h1><h2 id="职场管理类"><a href="#职场管理类" class="headerlink" title="职场管理类"></a>职场管理类</h2><p>❤️❤️ 小强升职记 - 邹鑫</p><p>❤️<a href="https://www.lanzous.com/i59re0f" rel="external nofollow noopener noreferrer" target="_blank">搞定 - [美]戴维·艾伦</a></p><p>🤍<a href="https://www.lanzous.com/i59r96b" rel="external nofollow noopener noreferrer" target="_blank">专业主义 - 大前研一</a></p><p>❤️<a href="https://www.lanzous.com/i59r8cb" rel="external nofollow noopener noreferrer" target="_blank">非暴力沟通 - [美] 马歇尔·卢森堡</a></p><p>原则 - [美]瑞·达利欧</p><p>❤️<a href="https://www.lanzous.com/i5apseh" rel="external nofollow noopener noreferrer" target="_blank">每周工作4小时 - 蒂莫西·费里斯</a></p><p>❤️<a href="https://www.lanzous.com/i59r8hg" rel="external nofollow noopener noreferrer" target="_blank">高效演讲-胡维</a></p><p>❤️<a href="https://www.lanzous.com/i5lopxi" rel="external nofollow noopener noreferrer" target="_blank">把时间当作朋友-李笑来</a></p><h2 id="经济类"><a href="#经济类" class="headerlink" title="经济类"></a>经济类</h2><p>❤️ 穷爸爸富爸爸 - [美] 罗伯特·清崎</p><p>❤️ 小狗钱钱 -  [德] 博多·舍费尔</p><p>🤍<a href="https://www.lanzous.com/i59rh8b" rel="external nofollow noopener noreferrer" target="_blank">魔鬼经济学 - [美] 史蒂芬·列维特</a></p><h2 id="互联网类"><a href="#互联网类" class="headerlink" title="互联网类"></a>互联网类</h2><p>❤️<a href="https://www.lanzous.com/i59r94j" rel="external nofollow noopener noreferrer" target="_blank">人人都是产品经理 - 苏杰</a></p><p>❤️<a href="https://www.lanzous.com/i59r8la" rel="external nofollow noopener noreferrer" target="_blank">人人都是产品经理2.0 - 苏杰</a></p><p>❤️<a href="https://www.lanzous.com/i59r8nc" rel="external nofollow noopener noreferrer" target="_blank">新零售的未来 -  翁怡诺</a></p><p><a href="https://www.lanzous.com/i59rhmf" rel="external nofollow noopener noreferrer" target="_blank"><del>重新定义公司 - [美]埃里克·施密特</del></a></p><p><del>参与感_小米口碑营销内部手册</del></p><p><a href="https://www.lanzous.com/i59r8uj" rel="external nofollow noopener noreferrer" target="_blank">从零开始做运营进阶篇-张亮</a></p><h2 id="生活技能类"><a href="#生活技能类" class="headerlink" title="生活技能类"></a>生活技能类</h2><p>❤️斯坦福完美睡眠法 - 西野精致 </p><p>❤️如何阅读一本书 - [美]莫提默·J.艾德勒 </p><p><del>美国纽约摄影学院摄影教材（上）</del></p><p><del>美国纽约摄影学院摄影教材（下）</del></p><h2 id="社会人文"><a href="#社会人文" class="headerlink" title="社会人文"></a>社会人文</h2><p>🤍激荡十年 - 吴晓波</p><p>🤍激荡三十年 - 吴晓波</p><p>🤍大败局 - 吴晓波</p><p>❤️❤️今日简史 - 尤瓦尔·赫拉利</p><p>❤️❤️未来简史 - 尤瓦尔·赫拉利</p><p><del>事实 - 汉斯·罗斯林</del></p><p>❤️乌合之众 - (法)古斯塔夫.勒庞</p><h2 id="小说"><a href="#小说" class="headerlink" title="小说"></a>小说</h2><p>❤️❤️<a href="https://pan.baidu.com/s/1tUC24-jO3La9li14rqjzCQ" rel="external nofollow noopener noreferrer" target="_blank">三体1-地球往事 - 刘慈欣</a></p><p>❤️❤️<a href="https://pan.baidu.com/s/1yFtm57PTpcXjdaif1lwixQ" rel="external nofollow noopener noreferrer" target="_blank">三体2-黑暗森林 - 刘慈欣</a></p><p>❤️❤️<a href="https://pan.baidu.com/s/1BVT1TTzr-faV3aGSHmSORA" rel="external nofollow noopener noreferrer" target="_blank">三体3-死神永生 -刘慈欣</a></p><p>❤️流浪地球 - 刘慈欣</p><p>❤️<a href="https://pan.baidu.com/s/1ttgruo4vOQnRXNdF4oXNCg" rel="external nofollow noopener noreferrer" target="_blank">长安十二时辰</a></p><p>🤍<a href="https://pan.baidu.com/s/1WVUff19oXtLAQAlXCUrc5Q" rel="external nofollow noopener noreferrer" target="_blank">古董局中局1-  武则天明堂玉佛头失窃案</a></p><p>🤍<a href="https://pan.baidu.com/s/1GhMLPfkgunWrsa34nPjThg" rel="external nofollow noopener noreferrer" target="_blank">古董局中局2-  清明上河图</a></p><p>🤍<a href="https://pan.baidu.com/s/1g3nNPeabZfLyOHX0HVgNkA" rel="external nofollow noopener noreferrer" target="_blank">古董局中局3-   掠宝清单</a></p><p>🤍<a href="https://pan.baidu.com/s/1j4Y-RU2ZIDPYishEqeG7Kw" rel="external nofollow noopener noreferrer" target="_blank">古董局中局4-  大结局</a></p><h2 id="历史"><a href="#历史" class="headerlink" title="历史"></a>历史</h2><p>❤️空王冠 玫瑰战争与都铎王朝的崛起</p><p>❤️易中天 品三国</p><p>❤️易中天 风流南宋</p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/to%20do%20list.jpg" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="书单" scheme="https://www.iamzmj.top/categories/booklist/"/>
    
    
      <category term="书单" scheme="https://www.iamzmj.top/tags/booklist/"/>
    
      <category term="计划" scheme="https://www.iamzmj.top/tags/plan/"/>
    
  </entry>
  
  <entry>
    <title>5G移动通信技术简介(二)</title>
    <link href="https://www.iamzmj.top/posts/bc8dfb1d.html"/>
    <id>https://www.iamzmj.top/posts/bc8dfb1d.html</id>
    <published>2019-10-25T10:57:15.000Z</published>
    <updated>2019-10-25T11:27:50.331Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><p>第五代移动通信技术（英语：5th generation mobile networks或5th generation wireless systems、5th-Generation，简称5G或5G技术）是最新一代蜂窝移动通信技术，也是即4G（LTE-A、WiMax）、3G（UMTS、LTE）和2G（GSM）系统之后的延伸。5G的性能目标是高数据速率、减少延迟、节省能源、降低成本、提高系统容量和大规模设备连接。Release-15中的5G规范的第一阶段是为了适应早期的商业部署。Release-16的第二阶段将于2020年4月完成。</p><p>下面简单对5G移动通信技术作基本介绍：</p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%871.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%872.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%873.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%874.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%875.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%876.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%877.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%878.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%879.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8710.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8711.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8712.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8713.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8714.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8715.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8716.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8717.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8718.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8719.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8720.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8721.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8722.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8723.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8724.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8725.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8726.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8727.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8728.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8729.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8730.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8731.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8732.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8733.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8734.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8735.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8736.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8737.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8738.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8739.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8740.JPG" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/%E5%B9%BB%E7%81%AF%E7%89%8741.JPG" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="移动通信" scheme="https://www.iamzmj.top/categories/%E7%A7%BB%E5%8A%A8%E9%80%9A%E4%BF%A1/"/>
    
    
      <category term="5G" scheme="https://www.iamzmj.top/tags/5G/"/>
    
      <category term="移动通信" scheme="https://www.iamzmj.top/tags/%E7%A7%BB%E5%8A%A8%E9%80%9A%E4%BF%A1/"/>
    
      <category term="通信技术" scheme="https://www.iamzmj.top/tags/%E9%80%9A%E4%BF%A1%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title>5G移动通信技术简介(一)</title>
    <link href="https://www.iamzmj.top/posts/57e87839.html"/>
    <id>https://www.iamzmj.top/posts/57e87839.html</id>
    <published>2019-10-24T07:12:45.000Z</published>
    <updated>2019-10-25T11:13:00.680Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><p>第五代移动通信技术（英语：5th generation mobile networks或5th generation wireless systems、5th-Generation，简称5G或5G技术）是最新一代蜂窝移动通信技术，也是即4G（LTE-A、WiMax）、3G（UMTS、LTE）和2G（GSM）系统之后的延伸。5G的性能目标是高数据速率、减少延迟、节省能源、降低成本、提高系统容量和大规模设备连接。Release-15中的5G规范的第一阶段是为了适应早期的商业部署。Release-16的第二阶段将于2020年4月完成。</p><p>下面简单对5G移动通信技术作基本介绍：</p><p><img src="https://i.loli.net/2019/10/24/HWzIyNjg8svPt4A.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0002.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0003.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/U6lKLhSnu5fOYaF.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/WB2EKqASCI94Djo.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0006.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/S4GzcL5yjFlbhTO.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/OjoBVciehTLuS3Y.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/dD8PUQXuH3EFBqy.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/Y4QAP7ICsDB1UNR.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/LId2lRgu5hqN9fD.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/qkNo2TEp7BYHdVC.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/wQCGMxRNIK8f4L7.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/jNm4Wwi2LpUgkxn.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/pXtuGK7MfekPL6c.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/dibl9hecr2PRWJu.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/27DxrmgIsjP4Zpe.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/KecCo3v6GhIuyqb.jpg" alt></p><p><img src="https://i.loli.net/2019/10/24/9eAvgknMFuVSRYa.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0020.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0021.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0022.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0023.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0024.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0025.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0026.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0027.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0028.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0029.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0030.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0031.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0032.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0033.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0034.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0035.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0036.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0037.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0038.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0039.jpg" alt></p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/0040.jpg" alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="移动通信" scheme="https://www.iamzmj.top/categories/%E7%A7%BB%E5%8A%A8%E9%80%9A%E4%BF%A1/"/>
    
    
      <category term="5G" scheme="https://www.iamzmj.top/tags/5G/"/>
    
      <category term="移动通信" scheme="https://www.iamzmj.top/tags/%E7%A7%BB%E5%8A%A8%E9%80%9A%E4%BF%A1/"/>
    
      <category term="通信技术" scheme="https://www.iamzmj.top/tags/%E9%80%9A%E4%BF%A1%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title>阿里云之对象存储OSS</title>
    <link href="https://www.iamzmj.top/posts/411cd2b5.html"/>
    <id>https://www.iamzmj.top/posts/411cd2b5.html</id>
    <published>2019-10-07T12:35:53.000Z</published>
    <updated>2019-10-11T04:29:17.337Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><h1 id="什么是OSS"><a href="#什么是OSS" class="headerlink" title="什么是OSS"></a>什么是OSS</h1><p>OSS对象存储服务，是阿里云提供的海量、安全、低成本、高可靠性的云存储服务。提供与平台无关的RESTful API接。基于盘古架构提供99.99999999999%的服务持久性。相比较物理存储它的优势在于：海量、安全、高可靠性、低成本。按量收费，无需担心存储容量。</p><h1 id="OSS主要功能"><a href="#OSS主要功能" class="headerlink" title="OSS主要功能"></a>OSS主要功能</h1><p>1、任何时间、任何地点、任何平台上对数据进行上传和下载</p><p>2、通过API或者WEB页面方式管理海量数据</p><p>3、弹性扩展，海量存储空间，随时增加，弹性增长</p><p>4、大规模，支持同一时间内高并发，大流量的读写访问。</p><p>5、图片处理，OSS上的图片，支持缩略、裁剪、水印、压缩和格式转换</p><p>6、按使用付费，按照存储、流量、请求次数付费，节省成本。</p><h1 id="OSS特点"><a href="#OSS特点" class="headerlink" title="OSS特点"></a>OSS特点</h1><p><strong>1、稳定</strong></p><p>服务设计可用性不低于99.9%</p><p>规模自动扩展，不影响对外服务</p><p>数据三重备份，持久性99.9999999999%</p><p><strong>2、低成本</strong></p><p>与传统硬件存储系统高投入相比，OSS使用成本低很多。</p><p>通过内网地址访问，免流量费，无需运维投入。</p><p><strong>3、安全</strong></p><p>结合云盾防DDoS系统</p><p>多种安全认证机制</p><p>提供访问日志有助于追查非法访问</p><p><strong>4、大规模、高性能</strong></p><p>存储容量无限扩展</p><p>处理能力弹性增长</p><p>多线BGP，各运营商访问流畅</p><h1 id="OSS应用场景"><a href="#OSS应用场景" class="headerlink" title="OSS应用场景"></a>OSS应用场景</h1><p>适合作为应用程序的持久化存储</p><p>应用场景1：<strong>数据处理</strong>（IMT）剪裁、旋转、水印、缩放/<strong>媒体转码</strong>（MT）音视频格式转换</p><p>应用场景2：<strong>海量存储</strong>   网络摄像机直存等</p><p>应用场景3:   <strong>动静态资源分离</strong>    </p><ul><li>动态资源：数据库记录</li><li>静态资源：利用BGP网络实现网页中图片、附件、音视频资源的超低延时传输。</li></ul><h1 id="OSS访问域名和数据中心"><a href="#OSS访问域名和数据中心" class="headerlink" title="OSS访问域名和数据中心"></a>OSS访问域名和数据中心</h1><p><strong>Bucket和数据中心的关系：</strong></p><p>Bucket是地域内作用的资源，可按照费用的单价，请求来源分布，网络延迟等方面的综合考虑。Bucket一旦创建完成，不可以修改所属的数据中心。</p><p>OSS支持Bucket级别的数据中心设置，不支持Object设置数据中心。Bucket所在的数据中心确定后，该Bucket下的所有Object将一直存放在该数据中心中。</p><p>访问OSS的数据请求，都是针对Bucket的三级域名[Bucket名字+.+EndPoint(根据Bucket所在地域的不同，内外网访问方式的不同会有所区别)</p><p><strong>以华北2节点位列：</strong></p><p>外网地址为：oss-cn-beijing.aliyuncs.com</p><p>内网地址为：oss-cn-beijing-internal.aliyuncs.com</p><p><strong>Bucket内网访问</strong></p><p>内网访问OSS需要满足以下两个件.</p><ul><li><p>条件1:只有ECS实例可以通过Bucket内网地址进行访问</p></li><li><p>条件2：ECS实例和Bucket在同一个地域，如不在同一个地域，需使用Bucket外网域名访问</p></li></ul><p><strong>Object访问地址构成规则</strong></p><p>1、bucket的权限为<font color="red">公共读</font>或<font color="red">公共读写</font>，Object的访问规则如下：</p><p>2、http://&lt;bucket名字&gt;.<endpoint>/&lt;object名字&gt;</endpoint></p><p>3、可以直接将URL连接写入HTML中访问Object</p><h1 id="使用Bucket"><a href="#使用Bucket" class="headerlink" title="使用Bucket"></a>使用Bucket</h1><p>1、Bucket是OSS上的命名空间，也是计费、权限控制、日志记录功能的管理实体。</p><p>2、Bucket名称在整个OSS服务中具有全局唯一性，存储OSS上的每一个Object必须都包含在Bucket中。</p><p>3、一个应用，例如图片分享网站，可以对应一个或多个Bucket中。</p><p>4、一个用户在同一地域下最多可以创建<font color="red">30</font>个Bucket,一旦创建成功，其名称、所处地域、存储类型不能修改。每个Bucket中存放的Object没有限制，存储容量没有限制。</p><p>其命名规则：</p><ul><li><p>只能包括小写字母，数字和短横线（-）</p></li><li><p>必须以小写字母或者数字开头和结尾。</p></li><li><p>长度必须3-63字节之间。</p></li></ul><h1 id="Object操作"><a href="#Object操作" class="headerlink" title="Object操作"></a>Object操作</h1><p>1、Object是OSS存储数据的基本单元，也被称为OSS文件。</p><p>2、Object由元信息，用户数据和文件名组成，对象由<font color="red">存储空间内部唯一</font>的KEY来识别。</p><p>3、根据不同的上传方式，object的大小限制是不一样的，分片上传最大支持48.8T的对象大小，其它的上传方式最大支持5GB。</p><p>4、Object在管理控制台上展现的形式为文件或文件夹，OSS服务没有文件夹的概念，所有文件都是由</p><p>Object来存储，文件夹本质上是创建一个size为“0”以“/”结尾的Object,方便在OSS控制台上管理Object。</p><p>命名规则：</p><ul><li><p>使用UTF8编码</p></li><li><p>长度必须在1-1023字节之间</p></li><li><p>不能以“/”或“\”字符开头</p></li><li><p>区分大小写</p></li></ul><p><strong>获取文件访问地址</strong></p><p>非私有：http://&lt;bucket名字&gt;.<endpoint>/&lt;object名字&gt;</endpoint></p><p>私有：http://&lt;bucket名字&gt;.<endpoint>/&lt;object名字&gt;&lt;?签名字符串&gt;</endpoint></p><p>删除文件</p><p>可单个删除/批量删除/自动删除</p><p>碎片管理</p><p>分片上传，超过一定容量的文件需要使用分片上传模式时，将Object切成若干个的Part,这些Part称为碎片。</p><h1 id="自定义域名绑定"><a href="#自定义域名绑定" class="headerlink" title="自定义域名绑定"></a>自定义域名绑定</h1><p>使用场景：网页静态内容存储在OSS Bucket中时</p><p><strong>域名绑定说明：</strong></p><p>OSS域名绑定（CNAME）功能目前只支持OSS三级域名访问方式进行绑定。既OSS配置方式为bucket_name.endpoint。</p><p>OSS未绑定域名，通过浏览器访问Object的URL，则为强制下载模式。</p><p>绑定的域名需要提供工信部备案号，域名持有者身份证等有效资料。经由阿里云审批通过后可以使用。</p><p>每一个Bucket可以绑定20个域名。</p><p><strong>绑定自定义域名前的访问方式：</strong></p><p>http://&lt;bucket名字&gt;.<endpoint>/&lt;object名字&gt;</endpoint></p><p><strong>绑定自定义域名后的访问方式：</strong></p><p>http://自定义域名/Object名字</p><h1 id="防盗链设置"><a href="#防盗链设置" class="headerlink" title="防盗链设置"></a>防盗链设置</h1><p>试用场景：为减少存储于OSS的数据被他人盗链而产生额外的费用。</p><p>OSS是按照使用量收费的服务，为减少OSS的数据被其它人盗链而产生额外的费用。OSS支持基于HTTP Header中字段referer的防盗链方法。</p><p>每个referer白名单使用换行符风格，支持通配符（*，？）</p><p><strong>白名单为空时：</strong></p><ul><li>不会检查referer字段是否为空</li></ul><p><strong>白名单不为空：</strong></p><ul><li><p>设置不允许referer字段为空的规则：只有referer属于白名单的请求被允许，其它请求（包括referer为空的请求）会被拒绝。</p></li><li><p>设置了允许referer字段为空的规则；则referer为空的请求和符合白名单的请求会被允许，其它请求都会被拒绝。如果使用浏览器直接浏览，需要设置referer字段为空。</p></li></ul><h1 id="静态网站托管"><a href="#静态网站托管" class="headerlink" title="静态网站托管"></a>静态网站托管</h1><ul><li>OSS支持静态网站托管。通过OSS控制台将自己的存储空间配置成静态网站的托管模式。支持索引和404默认页面，仅支持当前Bucket下的html格式的文件；为空则不启用静态网站托管。</li><li>静态网站托管网址：<a href="http://osstest.acper.net/" rel="external nofollow noopener noreferrer" target="_blank">http://osstest.acper.net/</a></li></ul><h1 id="OSS图片处理"><a href="#OSS图片处理" class="headerlink" title="OSS图片处理"></a>OSS图片处理</h1><p>图片服务（IMG）是阿里云OSS对外提供海量、安全、低成本、高可靠性的图片处理服务。</p><ul><li>调用简单：通过调用阿里云提供的RESTfUL接口调用，不受时间、地点、设备的限制。随OSS服务一并开通，无需单独开通。</li></ul><p><strong>1、图片服务提供如下功能：</strong></p><ul><li><p>图片缩放、剪裁、旋转</p></li><li><p>图片添加图片、文字、混合水印</p></li><li><p>图片格式转换</p></li><li><p>自定义图片处理样式</p></li><li><p>通关管道顺序调用多种图片处理能力</p></li><li><p>获取图片信息</p></li></ul><p><strong>2、图片服务规则：</strong></p><ul><li>通过URL的形式进行服务。</li></ul><p><a href="http://Bucket" rel="external nofollow noopener noreferrer" target="_blank">http://Bucket</a>.<endpoint>/object?x-oss-process=image/action.parame_value</endpoint></p><p>​    Bucket:用户的IMG频道</p><p>​    endpoint：用户的Bucket所在数据中心的访问域名。</p><p>​    object:在IMG中，用户操作图片的基本数据单元是Object。既OSS对应的Object,单个Object允许的最大大小是20MB.</p><p>​     action:用户对图片做的操作。</p><p>​      parame:用户对图片做的操作所对应的参数。</p><p><strong>3、URL方式访问</strong>：</p><p> &lt;文件URL&gt;?x-oss-process=style<stylename></stylename></p><p>例如：<a href="http://osstest.acper.net/image.jpg?x-oss-process=style/imgtest1" rel="external nofollow noopener noreferrer" target="_blank">http://osstest.acper.net/image.jpg?x-oss-process=style/imgtest1</a></p><p> <strong>4、分隔符方式访问</strong>：</p><p>&lt;文件URL&gt;&lt;分隔符&gt;<stylename></stylename></p><p>例如：<a href="http://osstest.acper.net/image.jpg@!imgtest1" rel="external nofollow noopener noreferrer" target="_blank">http://osstest.acper.net/image.jpg@!imgtest1</a></p><h1 id="OSS安全控制"><a href="#OSS安全控制" class="headerlink" title="OSS安全控制"></a>OSS安全控制</h1><h2 id="安全功能介绍"><a href="#安全功能介绍" class="headerlink" title="安全功能介绍"></a>安全功能介绍</h2><p>基于盘古分布式架构建设。</p><p><img src="https://i.loli.net/2019/10/11/GDsft9XNAvowcLg.jpg" alt></p><h2 id="安全控制"><a href="#安全控制" class="headerlink" title="安全控制"></a>安全控制</h2><p>OSS提供Bucket object级别的权限访问控制。</p><p>权限包括：</p><ul><li>公共读写——任何人可以对bucket中的Object读写、操作</li><li>公共读写、私有读写——只有创建者或被授权者可以对Bucket中的Object进行读写操作，任何人可以对Object进行读操作。</li><li>私有读写——只有创建者或被授权者可以对Bucket中的Object进行读写操作，其它人未经许可无法访问。</li><li>默认权限——Bucket是什么权限，Object就是什么权限。</li></ul><h2 id="防盗链"><a href="#防盗链" class="headerlink" title="防盗链"></a>防盗链</h2><p>OSS是按量收费的服务，OSS基于HTTP Header中的字段referer的防盗链方法。</p><h2 id="服务器端加密存储"><a href="#服务器端加密存储" class="headerlink" title="服务器端加密存储"></a>服务器端加密存储</h2><p>OSS支持在服务器端对用户上传的数据进行加密编码。数据上传时，OSS对收到的数据进行加密编码并保存。数据下载时，OSS自动对保存的加密数据进行解密并把原始数据返回给用户。并在返回的HTTP请求Header中，声明该数据进行了服务器端加密。</p><p>支持加密的操作包括：</p><p>Put Object:简单上传</p><p>Copy Object:复制Object</p><p>Initiate Multipart Upload:分片上传</p><h2 id="客户端加密SDK"><a href="#客户端加密SDK" class="headerlink" title="客户端加密SDK"></a>客户端加密SDK</h2><p>1、使用阿里云KMS托管用户主密钥，上传对象时指定KMS用户主密钥ID。</p><p>2、用户自主管理密钥，自主生成并保管加密密钥，当用户本地客户端加密时，由用户自主上传加密密钥</p><p>至本地加密客户端。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="阿里云" scheme="https://www.iamzmj.top/categories/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
    
      <category term="阿里云" scheme="https://www.iamzmj.top/tags/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
      <category term="OSS" scheme="https://www.iamzmj.top/tags/OSS/"/>
    
  </entry>
  
  <entry>
    <title>阿里云之虚拟私有云VPC</title>
    <link href="https://www.iamzmj.top/posts/fa1159eb.html"/>
    <id>https://www.iamzmj.top/posts/fa1159eb.html</id>
    <published>2019-09-30T14:07:58.000Z</published>
    <updated>2019-10-04T03:33:45.794Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><p><img src="https://i.loli.net/2019/09/14/Z2PhoYi3sHEfqJ1.png" alt></p><h1 id="VPC概念介绍"><a href="#VPC概念介绍" class="headerlink" title="VPC概念介绍"></a>VPC概念介绍</h1><h2 id="1、什么是虚拟专用网络VPC"><a href="#1、什么是虚拟专用网络VPC" class="headerlink" title="1、什么是虚拟专用网络VPC"></a>1、什么是虚拟专用网络VPC</h2><p>问题1？系统上云后，是否可以向管理传统数据中心一样进行管理？</p><p>问题2？已经有了一个数据中心，后续的扩容以及新系统的建设想建设在阿里云上，如何处理云上系统及现有系统之间的管理？</p><p>基于上述2个问题，阿里云VPC应运而生。</p><h2 id="2、虚拟专用网络VPC的特点"><a href="#2、虚拟专用网络VPC的特点" class="headerlink" title="2、虚拟专用网络VPC的特点"></a>2、虚拟专用网络VPC的特点</h2><p>1、VPC VLAN级别的隔离，彻底阻断VPC之间的网络通信。</p><p>2、实现网络地址的自定义，我的地盘我做主。</p><p>3、专线/VPN接入，实现传统架构的平滑上云。</p><h2 id="3、VPC产品介绍"><a href="#3、VPC产品介绍" class="headerlink" title="3、VPC产品介绍"></a>3、VPC产品介绍</h2><p>专有网络是自己完全掌控的网络，例如选择IP地址范围、配置路由表、网关等，可以在自定义的专有网络中使用阿里云相关产品。</p><p>专有网络支持连接到其它专有网络或本地网络，形成一个按需定制的网络环境。实现应用的平滑迁移上云和对数据中心的扩展。</p><p><font color="red">专有网络VPC是基于阿里云构建的一个隔离的网络环境，专有网络之间逻辑上彻底隔离</font>。其优势主要为：安全隔离、软件定义网络、访问控制、丰富的网络连接控制、</p><h1 id="VPC功能特点"><a href="#VPC功能特点" class="headerlink" title="VPC功能特点"></a>VPC功能特点</h1><p><strong>特点1：安全隔离</strong></p><ul><li><p>使用隧道技术实现传统VLAN相同的隔离效果。</p></li><li><p>实现了不同云服务器间的二层网络隔离。（网卡MAC信息不进入物理网络）因此也实现了不同专有网络之间的二层网络隔离。</p></li><li><p>专有网络内的ECS使用安全组防火墙进行三层网络访问控制。</p></li></ul><p><strong>解决的问题</strong></p><ul><li>专有网络之间的彻底隔离。</li><li>专有网络内，网卡级别的隔离。</li></ul><p><strong>特点2：访问控制</strong></p><ul><li>灵活的访问控制规则。</li><li>满足政务、金融的安全隔离规范。</li></ul><p><strong>特点3：软件自定义网络</strong></p><ul><li>按需配置网络，软件定义网络。</li><li>管理操作实时生效。</li></ul><p><strong>特点4：丰富的网络连接方式</strong></p><ul><li>支持专线连接</li><li>支持软件VPN</li></ul><h1 id="VPC应用场景"><a href="#VPC应用场景" class="headerlink" title="VPC应用场景"></a>VPC应用场景</h1><p><strong>应用场景一:</strong></p><p><strong>本地数据中心+云上业务  混合模式</strong></p><img src="https://i.loli.net/2019/10/03/6YT7dLVsZq5euo2.jpg" style="zoom:43%;"><ul><li><p>将内部核心系统与核心数据放置在自建的数据中心。来确保核心数据的安全性。</p></li><li><p>云上部署对外客户的应用系统，实现对业务访问的激增。</p></li></ul><p><strong>应用场景二:</strong></p><p><strong>多租户的安全隔离</strong></p><img src="https://i.loli.net/2019/10/03/XULBy4eCnfFqarb.jpg" style="zoom:51%;"><ul><li><p>希望在云上构建一个完全隔离的业务环境。传统云架构的多租户共享机制不能保证数据的安全性。</p></li><li><p>自主定义私有网络配置。</p></li></ul><p><strong>应用场景三:</strong></p><p><strong>主动访问公网的抓取类业务</strong></p><img src="https://i.loli.net/2019/10/03/huEJqojTvaxb7NZ.jpg" style="zoom:50%;"><ul><li>专有网络中的多个服务器可以主动访问互联网。</li><li>避免这些服务器的公网IP暴露在公网上。</li></ul><p><strong>应用场景四:</strong></p><p>多个应用流量波动大—共享宽带包</p><img src="https://i.loli.net/2019/10/03/huEJqojTvaxb7NZ.jpg" style="zoom:50%;"><ul><li>系统中同时存在多个面向互联网的应用</li><li>各个应用都需要对外提供服务，并且其波峰时间点不一致。</li></ul><h1 id="VPC网络基本概念"><a href="#VPC网络基本概念" class="headerlink" title="VPC网络基本概念"></a>VPC网络基本概念</h1><h2 id="OSI以太网7层协议"><a href="#OSI以太网7层协议" class="headerlink" title="OSI以太网7层协议"></a><strong>OSI以太网7层协议</strong></h2><img src="https://i.loli.net/2019/10/03/ahtr2uIl79secZS.jpg" style="zoom: 33%;"><p><strong>OSI以太网7层协议和TCP/IP协议比较</strong></p><img src="https://i.loli.net/2019/10/03/UTmsxyQLrlIj2wD.jpg" style="zoom: 25%;"><p>数据链路层：网桥、二层交换机、网卡</p><p>网络层：路由器、三层交换机</p><h2 id="路由器和二层交换机的区别"><a href="#路由器和二层交换机的区别" class="headerlink" title="路由器和二层交换机的区别"></a>路由器和二层交换机的区别</h2><p><strong>路由器：</strong></p><ul><li><p>工作在网络层（三层）</p></li><li><p>以IP地址作为为寻址方式，支持TCP/IP协议</p></li><li><p>支持划分子网</p></li><li><p>可以连接不同的网段（跨网段）</p></li></ul><p><strong>二层交换机：</strong></p><ul><li>工作在数据链路层（二层），以MAC地址作为寻址方式</li><li>不能划分子网</li><li>用于同一网段内的数据交换</li></ul><h2 id="路由器和网关"><a href="#路由器和网关" class="headerlink" title="路由器和网关"></a>路由器和网关</h2><p>网关是一个网络连接另一个网络的“关卡”，它是一个<font color="red">逻辑概念</font>。</p><p>路由器是物理设备</p><ul><li>路由器可以实现网关的功能。</li><li>网关也可以由局域网中的一台双网卡机器来实现。</li></ul><h2 id="VLAN（虚拟局域网）"><a href="#VLAN（虚拟局域网）" class="headerlink" title="VLAN（虚拟局域网）"></a>VLAN（虚拟局域网）</h2><p>是一组逻辑上的设备和用户，不受物理位置限制，可以根据部门、应用、功能等因素讲他们组织起来，相互之间的通信就好像在同一个网段中一样。</p><ul><li>VLAN之间默认是二层联通。三层通过对数据包封装VLAN_ID隔离。</li><li>VLAN之间需要通过网关来实现数据交换。</li></ul><p>其优点：</p><ul><li>端口隔离，通过一台交换机进行多个VLAN划分，实现交换机的利用最大化。</li><li>提高安全，含有敏感数据的用户组可与网络的其它部分隔离。</li><li>管理灵活，将不同地点、不同网络，不同用户组组合在一起，形成一个虚拟的网络环境。</li></ul><h1 id="VPC云产品综述"><a href="#VPC云产品综述" class="headerlink" title="VPC云产品综述"></a>VPC云产品综述</h1><p>VPC是用户独有的、完全掌控的的云上私有网络。可以根据需求对IP地址、路由表和网关等网络基础要素进行统一规划并使用阿里云提供的其它产品。（如ECS、RDS、SLB）</p><ul><li>VPC由虚拟路由器和虚拟交换机共同组成。</li><li>为实现和本地数据中心的平滑互通，可通过使用高速通道（专线）或VPN方式，将VPC与原有的本地物理网络连接，组成混合网络。</li></ul><img src="https://i.loli.net/2019/10/04/WwCEom6MxSr9yb5.jpg" style="zoom: 40%;"><h2 id="VPC的安全隔离"><a href="#VPC的安全隔离" class="headerlink" title="VPC的安全隔离"></a><strong>VPC的安全隔离</strong></h2><p>1、不同账号的云服务器在不同的VPC里。</p><p>2、VPC基于目前主流的隧道技术，每个VPC都有一个独立的<font color="red">隧道ID</font>。一个隧道ID对应一个VPC。一个VPC内的云实例之间的传输数据包都会加上隧道ID封装，带有唯一隧道ID标识，然后送到物理网络上进行传输，不同VPC内的ECS实例因为所在隧道ID不同，本身处于两个不同的路由平面。所以不同VPC内的云产品实例无法进行通信，天然被隔离。</p><p>3、不同专有网络之间内部网络<font color="red">完全隔离</font>,只能通过对外映射IP（弹性公网IP和NAT IP）互联。</p><h2 id="VPC名词解释"><a href="#VPC名词解释" class="headerlink" title="VPC名词解释"></a>VPC名词解释</h2><img src="https://i.loli.net/2019/10/04/cXoskuJeDRhwlHz.jpg" style="zoom: 25%;"><h2 id="VPC与其它云产品之间的关系"><a href="#VPC与其它云产品之间的关系" class="headerlink" title="VPC与其它云产品之间的关系"></a>VPC与其它云产品之间的关系</h2><p>VPC阿里主推网络类型，支持VPC的阿里云产品有：ECS、SLB、RDS。</p><p>VPC创建成功并创建虚拟交换机后，具备了在相应地域下可用区中创建处于这个交换机下的ECS、RDS和SLB实例。</p><h2 id="VPC收费模式"><a href="#VPC收费模式" class="headerlink" title="VPC收费模式"></a>VPC收费模式</h2><ul><li><p>VPC：免费（VPC内的  路由器、交换机、路由表、路由条目、私网高可用虚拟IP）</p></li><li><p>弹性公网IP：收费（预付费和后付费两种模式 ）</p></li></ul><img src="https://i.loli.net/2019/10/04/Dr5E6NGcneSyZst.jpg" style="zoom:43%;"><h1 id="VPC创建"><a href="#VPC创建" class="headerlink" title="VPC创建"></a>VPC创建</h1><h2 id="创建VPC"><a href="#创建VPC" class="headerlink" title="创建VPC"></a>创建VPC</h2><p>1、创建VPC时，需以<font color="red">CIDR Block</font> 方式指定VPC 内私网网段。-<font color="red">指定的网段无法修改</font>。</p><p>2、VPC创建成功后，任需创建虚拟交换机，之后才可以创建云产品实例（ECS、SLB、RDS）。</p><p>3、删除指定的VPC前，必须先删除VPC内的<font color="red">所有</font>云产品实例（安全组、交换机、产品实例、路由条目）。</p><h2 id="如何使用交换机"><a href="#如何使用交换机" class="headerlink" title="如何使用交换机"></a>如何使用交换机</h2><p>1、VPC状态为<strong>可用</strong>时，才能创建交换机。</p><p>2、交换机不支持并行创建，只支持one by one方式创建。</p><p>3、交换机创建后，不能再修改网段。</p><p>4、删除交换机之前，必须先删除交换机下的所有云产品实例。</p><h2 id="弹性公网IP的使用"><a href="#弹性公网IP的使用" class="headerlink" title="弹性公网IP的使用"></a>弹性公网IP的使用</h2><p>申请弹性公网IP</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="阿里云" scheme="https://www.iamzmj.top/categories/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
    
      <category term="阿里云" scheme="https://www.iamzmj.top/tags/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
      <category term="VPC" scheme="https://www.iamzmj.top/tags/VPC/"/>
    
  </entry>
  
  <entry>
    <title>阿里云之弹性伸缩服务ESS</title>
    <link href="https://www.iamzmj.top/posts/5a90a5b6.html"/>
    <id>https://www.iamzmj.top/posts/5a90a5b6.html</id>
    <published>2019-09-23T14:30:04.000Z</published>
    <updated>2019-10-04T03:40:55.682Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><h1 id="什么是弹性伸缩服务ESS"><a href="#什么是弹性伸缩服务ESS" class="headerlink" title="什么是弹性伸缩服务ESS"></a>什么是弹性伸缩服务ESS</h1><p><strong>ESS介绍</strong></p><p>ESS(弹性伸缩)自动调整弹性计算资源大小，来满足业务需求的变化。可根据设置的伸缩策略，在业务需求增长时自动增加ECS实例来保证计算能力。在业务需求降低时，自动减少ECS实例来节约成本。</p><p><img src="https://i.loli.net/2019/09/28/LEvGXzWietFjsdN.png" alt></p><p><strong>ESS伸缩性服务的特点</strong></p><p>弹性扩展、弹性收缩、弹性自愈</p><p><img src="https://i.loli.net/2019/09/24/xGseRT5tCSj3hcl.png" alt></p><h1 id="ESS名词解释"><a href="#ESS名词解释" class="headerlink" title="ESS名词解释"></a>ESS名词解释</h1><ul><li><p><strong>弹性伸缩</strong>（Auto Scalling）</p><p>弹性伸缩是根据用户的业务和策略，自动调节其弹性计算资源的管理服务。其能够在业务增长的时自动增加ECS实例，并在业务下降时自动减少ECS实例。</p></li><li><p><strong>伸缩组</strong> </p><p>伸缩组是具有相同应用场景的ECS实例集合，伸缩组定义了组内ECS实例数的最大值，最小值及相关的负载均实例和RDS实例等属性。</p></li><li><p><strong>伸缩配置</strong></p><p>伸缩配置定义了用于弹性伸缩的ECS实例的配置信息。</p></li><li><p><strong>伸缩规则</strong></p><p>伸缩规则定义了具体的扩展和收缩操作，例如加入或移出N个ECS实例。</p></li><li><p><strong>伸缩活动</strong></p><p>伸缩规则成功触发后，就会产生一条伸缩活动，伸缩活动主要用来描述伸缩组内ECS实例变化情况。</p></li><li><p><strong>冷却时间</strong></p><p>冷却时间指，在同一伸缩组内，一个伸缩活动执行完成后的一段锁定时间。在这段锁定时间内，该伸缩组不执行其他的伸缩活动。</p></li></ul><h1 id="ESS概念之间的关系"><a href="#ESS概念之间的关系" class="headerlink" title="ESS概念之间的关系"></a>ESS概念之间的关系</h1><ul><li><p>伸缩配置</p></li><li><p>伸缩规则        包含在伸缩组中（管理生命周期）</p></li><li><p>伸缩活动</p></li></ul><p>​     伸缩触发任务有<font color="red">定时服务</font>,<font color="red">云监控报警任务</font>等类型。</p><p>​    <font color="red">定时任务</font>，不依赖伸缩组的生命周期管理，删除伸缩组不会删除定时任务。</p><h1 id="ESS使用规则"><a href="#ESS使用规则" class="headerlink" title="ESS使用规则"></a>ESS使用规则</h1><h2 id="ESS使用规则一"><a href="#ESS使用规则一" class="headerlink" title="ESS使用规则一"></a>ESS使用规则一</h2><p><strong>伸缩规则</strong></p><ul><li><p>定义了具体扩展或伸缩操作，例如加入或移出N个实例</p></li><li><p>伸缩规则对ECS实例数量是执行增加或是减少的操作。是根据伸缩组中定义的MinSize和MaxSize判断的。</p></li></ul><p>​         例如某个伸缩组：MaxSize=3   当前实例数2，伸缩规则定义为增加3台ECS实例。实际执行过程中只会增加1台ECS实例（伸缩规则中的值不会调整）</p><p>​         例如某个伸缩组：MinSize=2   当前实例数3，伸缩规则定义为减少5台ECS实例。实际执行过程中只会较少1台ECS实例（伸缩规则中的值不会调整）</p><h2 id="ESS使用规则二"><a href="#ESS使用规则二" class="headerlink" title="ESS使用规则二"></a>ESS使用规则二</h2><p><strong>伸缩活动</strong></p><ul><li><p>同一伸缩组内，同一时刻只能有一个伸缩活动在执行。</p></li><li><p>伸缩活动不可以中断，某个创建20台ECS实例的伸缩活动在执行时，当创建到第6台ECS实例时，无法强制终止该伸缩活动。</p></li><li><p>伸缩活动有ECS实例加入伸缩组失败时，需要保持ECS实例级事务的完整性。而非伸缩活动级事务的完整性。既进行ECS实例回滚，而非伸缩级回滚。例如，当伸缩组创建了20台ECS实例，只有19台成功加入SLB负载均衡，则只对1台不成功的ECS实例进行释放操作。</p></li></ul><h2 id="ESS使用规则三"><a href="#ESS使用规则三" class="headerlink" title="ESS使用规则三"></a>ESS使用规则三</h2><p><strong>冷却时间</strong></p><ul><li><p>伸缩组在冷却时间内，只会拒绝云监控报警任务类型的伸缩活动请求，其它类型的触发任务可以绕过冷却时间立即执行伸缩活动。</p></li><li><p>伸缩规则冷却时间和伸缩组默认冷却时间同时存在时，以伸缩规则的冷却时间为伸缩活动的执行标准。</p></li><li><p>当伸缩组加入或移除多个ECS实例时，只有最后一个ECS实例加入或移出完成后，整个伸缩组的冷却时间才开始计算。</p></li><li><p>停用伸缩组后再开启伸缩组，冷却时间效果会消失。</p></li></ul><h1 id="ESS收费介绍"><a href="#ESS收费介绍" class="headerlink" title="ESS收费介绍"></a>ESS收费介绍</h1><p>弹性伸缩免费。</p><p>通过弹性伸缩自动创建的或手工添加的ECS实例按ECS相关实例类型进行付费。</p><p>按量付费ECS关机后，任收取实例费用。只有释放后才不再收取。</p><p>弹性伸缩尽力保证弹性伸缩服务足额正常弹出，也存在由于地域云服务器库存不足，启动时间长等问题导致弹性伸缩的实例无法全额弹出的情况。</p><h1 id="ESS的定时模式"><a href="#ESS的定时模式" class="headerlink" title="ESS的定时模式"></a>ESS的定时模式</h1><ul><li>定时模式</li></ul><p>自定义自动伸缩发生的时间和频率，例如每天13:00添加ECS实例。</p><ul><li>动态模式</li></ul><p>基于云动态监控指标(如CPU性能指标)自动增加或减少ECS实例。</p><ul><li>固定数量模式</li></ul><p>通过设置最小实例数（MinSize）,既健康运行ECS实例最小数量，以保证可用性。</p><ul><li>自定义模式</li></ul><p>通过API调用自有监控系统，执行手动操作。</p><ul><li>健康模式</li></ul><p>ECS实例为非RUNNING状态时，弹性伸缩将自动移出或释放不健康ECS。</p><ul><li>多模式并行</li></ul><p>以上所有模式都可以组合配置，例如设置每天13:00~14:00创建20个ECS实例来应对业务高峰，但实际情况可能需要</p><p>多于20个的实例，则可以选择其它模式与定时模式配合一起使用。</p><h1 id="ESS限制"><a href="#ESS限制" class="headerlink" title="ESS限制"></a>ESS限制</h1><p>伸缩组内部署在ECS实例的应用必须<font color="red">无状态</font>，并且可<font color="red">横向扩展</font> 。</p><p>弹性伸缩无法自动添加ECS实例到<font color="red">开放缓存</font>，实例白名单需要<font color="red">自行添加</font>。</p><p>弹性伸缩无法纵向扩展，既无法自动升降ECS实例的vCPU,内存，带宽等。</p><p><strong>数量限制</strong></p><ul><li>伸缩组：20个，每一个伸缩组内可创建10个伸缩配置及50个伸缩规则。</li><li>支持ESS实例：1000台（含自动添加，不包含手动添加）。</li><li>定时任务：20个。</li></ul><h1 id="伸缩组创建"><a href="#伸缩组创建" class="headerlink" title="伸缩组创建"></a>伸缩组创建</h1><h2 id="创建伸缩组"><a href="#创建伸缩组" class="headerlink" title="创建伸缩组"></a>创建伸缩组</h2><p>注意事项</p><p>RDS：</p><p>1、指定的RDS实例必须是运行中状态。</p><p>2、指定的RDS实例访问白名单的IP个数不能达到上限</p><p>3、伸缩组创建成功后，不会立即生效，只有启用才能接受伸缩组规则触发和执行相关伸缩活动。</p><h2 id="修改伸缩组"><a href="#修改伸缩组" class="headerlink" title="修改伸缩组"></a>修改伸缩组</h2><p>注意事项</p><p>1、地域、负载均衡、RDS数据库实例不可以修改。</p><p>2、伸缩组有 生效、失效、删除 三种状态。只有生效和失效状态才可以修改伸缩组属性。</p><p>3、当伸缩组的ECS实例数不满足修改后的MaxSize和MinSize时，弹性伸缩服务会自动加入或移出ECS实例。使得伸缩组的ECS实例数量匹配MaxSize和MinSize。</p><h2 id="启用伸缩组"><a href="#启用伸缩组" class="headerlink" title="启用伸缩组"></a>启用伸缩组</h2><p>注意事项</p><p>1、当伸缩组为失效状态时，才可以启用伸缩组。</p><p>2、当伸缩组有生效的伸缩配置时，才可以启用伸缩组。</p><p>3、一个伸缩组在同一时刻只能有一个生效的伸缩配置。</p><h2 id="停用伸缩组"><a href="#停用伸缩组" class="headerlink" title="停用伸缩组"></a>停用伸缩组</h2><p>注意事项</p><p>1、只有在当前伸缩组没有任何伸缩活动进行时，才能停用伸缩组。</p><p>2、当前伸缩组为生效状态时，才能停用伸缩组。</p><h2 id="删除伸缩组"><a href="#删除伸缩组" class="headerlink" title="删除伸缩组"></a>删除伸缩组</h2><p>1、控制台删除一个伸缩组时，默认使用强制删除模式。</p><p>2、删除伸缩组，包含删除相关的伸缩配置、伸缩规则、伸缩活动、伸缩信息等。但不会删除定时任务，云监控报警任务，负载均衡实例，RDS实例。</p><p>3、通过Open AI 删除伸缩组时，可以看到强制删除属性。表示伸缩组存在ECS实例或正在进行伸缩活动。是否强制删除伸缩组并移出和释放ECS实例。</p><h2 id="创建伸缩配置"><a href="#创建伸缩配置" class="headerlink" title="创建伸缩配置"></a>创建伸缩配置</h2><p>1、伸缩配置一旦创建成功，不可以编辑更改，只能创建一个新的伸缩配置来替换不需要的伸缩配置。</p><p>2、依据被替换的伸缩配置，而添加进组的ECS实例任可正常运行。</p><p>3、一个伸缩组内最多创建10个伸缩配置，但只能有1个伸缩配置处于激活状态。</p><h2 id="删除伸缩配置"><a href="#删除伸缩配置" class="headerlink" title="删除伸缩配置"></a>删除伸缩配置</h2><p>注意事项</p><p>1、伸缩配置在伸缩组中属于<font color="red">生效状态</font>,则伸缩配置不允许删除。</p><h1 id="生命周期挂钩"><a href="#生命周期挂钩" class="headerlink" title="生命周期挂钩"></a>生命周期挂钩</h1><h2 id="什么是生命周期挂钩"><a href="#什么是生命周期挂钩" class="headerlink" title="什么是生命周期挂钩"></a>什么是生命周期挂钩</h2><p>当伸缩组发生伸缩活动时，生命周期挂钩会暂停伸缩活动一段时间，伸缩活动进入等待状态。</p><h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><p>扩张活动时：可以在等待期间初始化ECS实例配置。</p><p>收缩活动时：获取ECS实例数据</p><h2 id="作用时机"><a href="#作用时机" class="headerlink" title="作用时机"></a>作用时机</h2><p>扩张活动时：加入RDS、SLB实例白名单前</p><p>收缩活动时：移除RDS、SLB实例白名单前</p><h1 id="创建管理定时任务"><a href="#创建管理定时任务" class="headerlink" title="创建管理定时任务"></a>创建管理定时任务</h1><p>1、每个账户最多能创建20个定时任务</p><p>2、由于伸缩组正发生伸缩活动或者伸缩组停用等原因，导致定时任务触发执行伸缩规则失败，在重试过期时间内，定时任务会自动重试触发，否则放弃本次定时触发。</p><p>3、若多个定时任务在相近的时间内触发同一个伸缩组的伸缩规则，则最早触发的定时任务会先执行伸缩活动。由于同一个伸缩组在同一时刻只能有一个伸缩活动。排在后面的定时任务会在重试过期时间内自动重试实时触发。如上一个伸缩活动完成之后，排在后面的定时任务还在重试过期时间内重试，则执行该定时任务的伸缩规则并触发相应的伸缩活动。</p><p><strong>报警任务</strong></p><p>1、基于  云监控服务（CMS）运行的。</p><p>2、如果该报警任务名称已经存在，则用新的值进行替换。</p><p>3、在使用报警任务之前，需要在ECS镜像里安装新版本的云监控插件。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="阿里云" scheme="https://www.iamzmj.top/categories/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
    
      <category term="阿里云" scheme="https://www.iamzmj.top/tags/%E9%98%BF%E9%87%8C%E4%BA%91/"/>
    
      <category term="ESS" scheme="https://www.iamzmj.top/tags/ESS/"/>
    
  </entry>
  
  <entry>
    <title>windows10命令行调用openssl</title>
    <link href="https://www.iamzmj.top/posts/ac409ae6.html"/>
    <id>https://www.iamzmj.top/posts/ac409ae6.html</id>
    <published>2019-09-16T15:29:55.000Z</published>
    <updated>2019-10-01T03:45:43.606Z</updated>
    
    <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><script type="text/javascript" src="/js/src/bai.js"></script><p>在计算机网络上，OpenSSL是一个开放源代码的软件库包，应用程序可以使用这个包来进行安全通信，避免窃听，同时确认另一端连接者的身份。这个包广泛被应用在互联网的网页服务器上。</p><p>下载安装windows平台<a href="http://slproweb.com/products/Win32OpenSSL.html" rel="external nofollow noopener noreferrer" target="_blank">openssl</a>密钥生成工具</p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/e61190ef76c6a7efb5f492a5fffaaf51f2de6666.gif" alt></p><p>执行安装目录bin下的”openssl.exe”，执行后弹出命令窗口如下</p><p><img src="https://raw.githubusercontent.com/zhanminjie/mybigimage/master/blogimage/Snipaste_2019-09-18_20-54-44.jpg" alt></p><p>生成私钥，命令行输入</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">genrsa -out rsa_private_key<span class="selector-class">.pem</span> <span class="number">1024</span></span><br></pre></td></tr></table></figure><p>在bin目录下多了一个rsa_private_key.pem文件，将这个文件通过文本编辑器打开，将看到你所需要的<strong>私钥</strong>，使用时记得把—BEGIN PRIVATE KEY—，—END PRIVATE KEY—字样删掉。</p><p>生成公钥，命令行输入</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsa -<span class="keyword">in</span> rsa_private_key<span class="selector-class">.pem</span> -pubout -out rsa_public_key.pem</span><br></pre></td></tr></table></figure><p>在bin目录下多了一个rsa_public_key.pem文件，将这个文件通过文本编辑器打开，将看到你所需要的<strong>公钥</strong>，使用时记得把—BEGIN PRIVATE KEY—，—END PRIVATE KEY—字样删掉。</p><p>RSA私钥转换成 PKCS8 格式，命令行输入</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkcs8 -topk8 -inform PEM -<span class="keyword">in</span> rsa_private_key<span class="selector-class">.pem</span> -outform PEM -nocrypt</span><br></pre></td></tr></table></figure><p>回车，key直接显示在窗口中</p><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBALaGPKpNJmgH6oV3</span><br><span class="line">tO19bPty3U52ELXQilxRvcXuIQbqWkteK86FUi4W7eM+eK+ldVuuJt3YVsBeSPh7</span><br><span class="line"><span class="number">2</span>HIFatdzxqbE5oXq7vyuWUj9fi3ldD3i0obN0v52qKBL6gNQqRThQjbRqaf2uix4</span><br><span class="line">BORP5DCALVanQKU4QUaL6Tnsy9MPAgMBAAECgYEApFlc2K+dTIEMP9+Y71tHvWYh</span><br><span class="line">NZwD0eKUIyqLKWURIgv0<span class="comment">//YslcngRJXq3/qJawceFE5MuucovhBnvi6tp4WPPCk0</span></span><br><span class="line">UA1gsEPYN9CC4M7DFy2NV+thY+PLZ5pv/mcNiO/eNMIVoibQK1luNIyH3bKbCQHo</span><br><span class="line">fkAyk5Ji8/TEfyVphmkCQQDj8HPXEtSe9RtbCkXyrx0Piq+<span class="number">4</span>kF79+ALQJwREisgJ</span><br><span class="line">LTtABgrOeWkse03gQHp64LgTJG0BgaBQZwsm++hwttONAkEAzP6GhuelN4zElPSJ</span><br><span class="line">skWApRjQOCTBKUf/<span class="number">5e6</span>g5WH284SO9tjjL4Kb8OetN4XmOijEcsWk7p6cEugVEnBj</span><br><span class="line">T4asCwJAa8fOLrujuEo0FjdkXd25wxiUAJSbpkF4qw5X8UUiU1yE8MAqqfk05yii</span><br><span class="line"><span class="number">6</span>U/z2liaEcselCDEOmCPIG7rOSjqHQJBALuz/<span class="number">6</span>h9aYog6kveUksbWv1RaC9QcFKF</span><br><span class="line">a+q1gzwmZMJ8SY/<span class="number">77</span>qKtPG7tJG2nvLTaaW8STMB2GUEyo0DcCgNitBsCQCbNHgqw</span><br><span class="line">/cE<span class="comment">//p/qLEuZgLZRBM6xOrsuLYU7ODXc3xL9H48l2iGt3mSnjLkEuW+OjaLMNKRL</span></span><br><span class="line">Iujc/<span class="number">0</span>AMhDYfL3w=</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure><p>–后续持续更新–</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;link rel=&quot;stylesheet&quot; class=&quot;aplayer-secondary-style-marker&quot; href=&quot;\assets\css\APlayer.min.css&quot;&gt;&lt;script src=&quot;\assets\js\APlayer.min.js&quot; cla
      
    
    </summary>
    
      <category term="openssl" scheme="https://www.iamzmj.top/categories/openssl/"/>
    
    
      <category term="openssl" scheme="https://www.iamzmj.top/tags/openssl/"/>
    
  </entry>
  
</feed>
